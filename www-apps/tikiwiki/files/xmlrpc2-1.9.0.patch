--- commxmlrpc.php.old	2005-08-21 15:01:21.000000000 -0400
+++ commxmlrpc.php	2005-08-21 15:01:57.000000000 -0400
@@ -10,8 +10,7 @@
 
 include_once ('lib/tikilib.php');
 include_once ('lib/userslib.php');
-include_once ("lib/xmlrpc.inc");
-include_once ("lib/xmlrpcs.inc");
+include_once ("XML/Server.php");
 include_once ('lib/commcenter/commlib.php');
 
 $tikilib = new Tikilib($dbTiki);
@@ -26,7 +25,7 @@
 	"sendArticle" => array("function" => "sendArticle")
 );
 
-$s = new xmlrpc_server($map);
+$s = new XML_RPC_Server($map);
 
 /* Validates the user and returns user information */
 function sendPage($params) {
@@ -49,18 +48,18 @@
 	$description = $pp->scalarval();
 	// 
 	if (!$userlib->validate_user($username, $password, '', '')) {
-		return new xmlrpcresp(0, 101, "Invalid username or password");
+		return new XML_RPC_Response(0, 101, "Invalid username or password");
 	}
 
 	// Verify if the user has tiki_p_sendme_pages
 	if (!$userlib->user_has_permission($username, 'tiki_p_sendme_pages')) {
-		return new xmlrpcresp(0, 101, "Permissions denied user $username cannot send pages to this site");
+		return new XML_RPC_Response(0, 101, "Permissions denied user $username cannot send pages to this site");
 	}
 
 	// Store the page in the tiki_received_pages_table
 	$data = base64_decode($data);
 	$commlib->receive_page($pageName, $data, $comment, $site, $username, $description);
-	return new xmlrpcresp(new xmlrpcval(1, "boolean"));
+	return new XML_RPC_Response(new XML_RPC_Value(1, "boolean"));
 }
 
 function sendArticle($params) {
@@ -114,12 +113,12 @@
 
 	// 
 	if (!$userlib->validate_user($username, $password, '', '')) {
-		return new xmlrpcresp(0, 101, "Invalid username or password");
+		return new XML_RPC_Response(0, 101, "Invalid username or password");
 	}
 
 	// Verify if the user has tiki_p_sendme_pages
 	if (!$userlib->user_has_permission($username, 'tiki_p_sendme_articles')) {
-		return new xmlrpcresp(0, 101, "Permissions denied user $username cannot send articles to this site");
+		return new XML_RPC_Response(0, 101, "Permissions denied user $username cannot send articles to this site");
 	}
 
 	// Store the page in the tiki_received_pages_table
@@ -132,7 +131,7 @@
 	$commlib->receive_article($site, $username, $title, $authorName, $size, $use_image, $image_name, $image_type, $image_size,
 		$image_x, $image_y, $image_data, $publishDate, $expireDate, $created, $heading, $body, $hash, $author, $type, $rating);
 
-	return new xmlrpcresp(new xmlrpcval(1, "boolean"));
+	return new XML_RPC_Response(new XML_RPC_Value(1, "boolean"));
 }
 
 ?>
