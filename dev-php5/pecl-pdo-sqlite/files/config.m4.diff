--- config.m4	2005-08-06 21:00:16.000000000 +0200
+++ config.m4	2005-08-06 21:04:03.000000000 +0200
@@ -1,4 +1,4 @@
-dnl $Id: config.m4,v 1.23 2005/07/27 04:07:11 wez Exp $
+dnl $Id: config.m4,v 1.26 2005/07/29 20:41:52 iliaa Exp $
 dnl config.m4 for extension pdo_sqlite
 dnl vim:et:sw=2:ts=2:
 
@@ -90,20 +90,9 @@
       AC_DEFINE(SQLITE_PTR_SZ, SIZEOF_CHAR_P, [Size of a pointer])
       PDO_SQLITE_VERSION=`cat $ext_srcdir/sqlite/VERSION`
       PDO_SQLITE_VERSION_NUMBER=`echo $PDO_SQLITE_VERSION | $AWK -F. '{printf("%d%03d%03d", $1, $2, $3)}'`
-      sed -e s/--VERS--/$PDO_SQLITE_VERSION/ -e s/--VERSION-NUMBER--/$PDO_SQLITE_VERSION_NUMBER/ $abs_srcdir/sqlite/src/sqlite.h.in > $abs_srcdir/sqlite/src/sqlite3.h
-      if ! test -f $abs_srcdir/sqlite/src/parse.h ; then
-        dnl maintainer can comment this line out when upgrading the bundled library
-        dnl and reinstate it when done
-        AC_MSG_ERROR([this package is broken])
-        $CC -o $abs_srcdir/sqlite/tool/lemon $abs_srcdir/sqlite/tool/lemon.c
-        $abs_srcdir/sqlite/tool/lemon $abs_srcdir/sqlite/src/parse.y
-        cat $abs_srcdir/sqlite/src/parse.h $abs_srcdir/sqlite/src/vdbe.c | $AWK -f $abs_srcdir/sqlite/mkopcodeh.awk > $abs_srcdir/sqlite/src/opcodes.h
-        sort -n +2 $abs_srcdir/sqlite/src/opcodes.h | $AWK -f $abs_srcdir/sqlite/mkopcodec.awk > $abs_srcdir/sqlite/src/opcodes.c
-        $CC -o $abs_srcdir/sqlite/tool/mkkeywordhash $abs_srcdir/sqlite/tool/mkkeywordhash.c
-        $abs_srcdir/sqlite/tool/mkkeywordhash > $abs_srcdir/sqlite/src/keywordhash.h
-      else
-        touch $abs_srcdir/sqlite/src/parse.c $abs_srcdir/sqlite/src/parse.h
-      fi
+      sed -e s/--VERS--/$PDO_SQLITE_VERSION/ -e s/--VERSION-NUMBER--/$PDO_SQLITE_VERSION_NUMBER/ $ext_srcdir/sqlite/src/sqlite.h.in > $ext_builddir/sqlite3.h
+
+      touch $ext_srcdir/sqlite/src/parse.c $ext_srcdir/sqlite/src/parse.h
 
       if test "$ext_shared" = "no" -o "$ext_srcdir" != "$abs_srcdir"; then
         echo '#include <php_config.h>' > $ext_srcdir/sqlite/src/config.h
