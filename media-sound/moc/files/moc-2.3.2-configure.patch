--- configure.in.old	2005-08-02 05:30:23.000000000 +0900
+++ configure.in	2005-10-03 23:54:27.000000000 +0900
@@ -76,19 +76,26 @@
 		     [EXTRA_LIBS="$EXTRA_LIBS -lossaudio"])
 fi
 
-PKG_CHECK_MODULES(ALSA, [alsa >= 0.9],
-	     [COMPILE_ALSA="yes"
-	      EXTRA_OBJS="$EXTRA_OBJS alsa.o"
-	      AC_DEFINE([HAVE_ALSA], 1, [Define if you have ALSA.])
-	      EXTRA_LIBS="$EXTRA_LIBS $ALSA_LIBS"
-	      CFLAGS="$CFLAGS $ALSA_CFLAGS"],
-	     [COMPILE_ALSA="no"])
+AC_ARG_WITH(jack, AS_HELP_STRING(--without-jack, Compile without JACK support.))
+
+if test "$with_jack" != "xno"
+then
+	PKG_CHECK_MODULES([ALSA], [alsa >= 0.9],
+		     [COMPILE_ALSA="yes"
+		     EXTRA_OBJS="$EXTRA_OBJS alsa.o"
+	             AC_DEFINE([HAVE_ALSA], 1, [Define if you have ALSA.])
+	             EXTRA_LIBS="$EXTRA_LIBS $ALSA_LIBS"
+	             CFLAGS="$CFLAGS $ALSA_CFLAGS"],
+	             [COMPILE_ALSA="no"])
+else
+	COMPILE_ALSA="no"
+fi
 
 AC_ARG_WITH(jack, AS_HELP_STRING(--without-jack, Compile without JACK support.))
 
 if test "x$with_jack" != "xno"
 then
-	PKG_CHECK_MODULES(JACK, [jack >= 0.4],
+	PKG_CHECK_MODULES([JACK], [jack >= 0.4],
 			  [COMPILE_JACK="yes"
 			   EXTRA_OBJS="$EXTRA_OBJS jack.o"
 			   AC_DEFINE([HAVE_JACK], 1, [Define if you have JACK.])
@@ -214,9 +221,8 @@
 			taglib_ver_minor=`echo "$taglib_ver" | awk -F. '{print $2}'`
 			taglib_ver_extra=`echo "$taglib_ver" | awk -F. '{print $3}'`
 
-			if test \( "$taglib_ver_major" = "1" -a "$taglib_ver_minor" -ge 4 \) \
-				-o \( "$taglib_ver_major" = "1" -a "$taglib_ver_minor" = "3" \
-				-a "$taglib_ver_extra" -ge 1 \)
+			if test \( "$taglib_ver_major" = "1" -a \
+			"$taglib_ver_minor" -ge 4 \) 
 			then
 				AC_MSG_RESULT([$taglib_ver, OK])
 
@@ -248,7 +254,7 @@
 AC_ARG_WITH(ogg, AS_HELP_STRING(--without-ogg,Compile without OGG support.))
 if test "x$with_ogg" != "xno"
 then
-	PKG_CHECK_MODULES(OGG_VORBIS, [ogg >= 1.0 vorbis >= 1.0 vorbisfile >= 1.0],
+	PKG_CHECK_MODULES([OGG_VORBIS], [ogg >= 1.0 vorbis >= 1.0 vorbisfile >= 1.0],
 			  [AC_SUBST(OGG_VORBIS_LIBS)
 			  AC_SUBST(OGG_VORBIS_CFLAGS)
 			  DECODER_PLUGINS="$DECODER_PLUGINS ogg"],
@@ -269,7 +275,7 @@
 	    Compile without libsndfile))
 if test "x$with_sndfile" != "xno"
 then
-	PKG_CHECK_MODULES(sndfile, sndfile >= 1.0.0,
+	PKG_CHECK_MODULES([sndfile], [sndfile >= 1.0.0],
 			   [AC_SUBST(sndfile_LIBS)
 			   AC_SUBST(sndfile_CFLAGS)
 			   DECODER_PLUGINS="$DECODER_PLUGINS sndfile"],
@@ -281,7 +287,7 @@
 	    Compile without speex support))
 if test "x$with_speex" != "xno"
 then
-	PKG_CHECK_MODULES(speex, speex >= 1.0.0,
+	PKG_CHECK_MODULES([speex], [speex >= 1.0.0],
 			  [AC_SUBST(speex_LIBS)
 			  AC_SUBST(speex_CFLAGS)
 			  DECODER_PLUGINS="$DECODER_PLUGINS speex"],
@@ -294,7 +300,7 @@
 COMPILE_SAMPLERATE="no"
 if test "x$with_samplerate" != "xno"
 then
-	PKG_CHECK_MODULES(samplerate, samplerate >= 0.1.0,
+	PKG_CHECK_MODULES([samplerate], [samplerate >= 0.1.0],
 			  [EXTRA_LIBS="$EXTRA_LIBS $samplerate_LIBS"
 			   CFLAGS="$CFLAGS $samplerate_CFLAGS"
 			   AC_DEFINE([HAVE_SAMPLERATE], 1,
