--- src/mp4file.c.orig	2004-01-17 10:37:49.000000000 +0100
+++ src/mp4file.c	2004-02-27 12:30:05.469188568 +0100
@@ -107,6 +107,10 @@
 /* define metadata bug is present (see note at file_write_mp4_info()) */
 #define MP4V2_HAS_METADATA_BUG TRUE
 
+#include <sys/types.h>
+#include <stdint.h>
+#include <stdlib.h>
+#include <string.h>
 #include "mp4.h"
 
 Track *file_get_mp4_info (gchar *mp4FileName)
@@ -126,9 +130,9 @@
 	    gchar *value;
 	    uint16_t numvalue, numvalue2;
 	    MP4Duration trackDuration = MP4GetTrackDuration(mp4File, trackId);
-	    double msDuration = UINT64_TO_DOUBLE(
-		MP4ConvertFromTrackDuration(mp4File, trackId, 
-					    trackDuration, MP4_MSECS_TIME_SCALE));
+	    double msDuration = (double) MP4ConvertFromTrackDuration(mp4File, 
+								     trackId, 
+					  trackDuration, MP4_MSECS_TIME_SCALE);
 	    u_int32_t avgBitRate = MP4GetTrackBitRate(mp4File, trackId);
 
 	    track = g_malloc0 (sizeof (Track));
