http://bugs.gentoo.org/show_bug.cgi?id=290660
http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2009-3765
http://dev.mutt.org/trac/changeset/6016:dc09812e63a3/mutt_ssl.c

Index: mutt_ssl.c
===================================================================
--- mutt_ssl.c (revision 5870:dc9ec900c657)
+++ mutt_ssl.c (revision 6016:dc09812e63a3)
@@ -682,5 +682,6 @@
       if (subj_alt_name->type == GEN_DNS)
       {
-	if ((match_found = hostname_match(hostname_ascii,
+	if (mutt_strlen(subj_alt_name) == subj_alt_name->d.ia5->length  &&
+	    (match_found = hostname_match(hostname_ascii,
 					  (char *)(subj_alt_name->d.ia5->data))))
 	{
@@ -712,5 +713,7 @@
       goto out;
     }
-    match_found = hostname_match(hostname_ascii, buf);
+    if (mutt_strlen(buf) == bufsize - 1) {
+      match_found = hostname_match(hostname_ascii, buf);
+    }
   }
 
