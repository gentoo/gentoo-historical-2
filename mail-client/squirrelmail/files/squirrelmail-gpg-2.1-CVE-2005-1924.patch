diff -Naurp squirrelmail-1.4.10a.orig/plugins/gpg/gpg_key_functions.php squirrelmail-1.4.10a/plugins/gpg/gpg_key_functions.php
--- squirrelmail-1.4.10a.orig/plugins/gpg/gpg_key_functions.php	2007-07-07 13:03:42.000000000 -0700
+++ squirrelmail-1.4.10a/plugins/gpg/gpg_key_functions.php	2007-07-15 18:22:35.000000000 -0700
@@ -695,6 +695,9 @@ function gpg_recv_key($searchkeyid,$debu
   if (!$keyserver) {
       $keyserver = getPref($data_dir,$username,'keyserver');
   }
+
+  $keyserver = escapeshellarg($keyserver);
+
   // import
   // the following line redirects the output to stderr: 2>&1
   // use --import
@@ -1172,4 +1175,4 @@ function gpg_generate_keypair($debug, $r
  * added $Log directive to broken out functions file.
  *
  */
-?>
\ No newline at end of file
+?>
diff -Naurp squirrelmail-1.4.10a.orig/plugins/gpg/gpg_keyring.php squirrelmail-1.4.10a/plugins/gpg/gpg_keyring.php
--- squirrelmail-1.4.10a.orig/plugins/gpg/gpg_keyring.php	2007-07-07 13:03:42.000000000 -0700
+++ squirrelmail-1.4.10a/plugins/gpg/gpg_keyring.php	2007-07-15 18:18:28.000000000 -0700
@@ -454,6 +454,7 @@ class gpg_keyring {
         }
 
         //Make and execute the delete command
+	$fpr = escapeshellarg($fpr);
 	$params = "--yes --homedir $gpg_key_dir $flag $fpr";
 	$return=gpg_execute($debug,$params);
 	$returnval=$return['returnval'];
@@ -872,4 +873,4 @@ class gpg_keyring {
  *  Initial Revision
  *  new file for up-and-coming keyring class
  */
-?>
\ No newline at end of file
+?>
