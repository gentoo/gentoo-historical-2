Index: avahi-core/wide-area.c
===================================================================
--- avahi-core/wide-area.c	(revision 1370)
+++ avahi-core/wide-area.c	(revision 1371)
@@ -579,8 +579,8 @@
     e->cleanup_dead = 0;
 
     /* Create sockets */
-    e->fd_ipv4 = avahi_open_unicast_socket_ipv4();
-    e->fd_ipv6 = avahi_open_unicast_socket_ipv6();
+    e->fd_ipv4 = s->config.use_ipv4 ? avahi_open_unicast_socket_ipv4() : -1;
+    e->fd_ipv6 = s->config.use_ipv6 ? avahi_open_unicast_socket_ipv6() : -1;
 
     if (e->fd_ipv4 < 0 && e->fd_ipv6 < 0) {
         avahi_log_error(__FILE__": Failed to create wide area sockets: %s", strerror(errno));
