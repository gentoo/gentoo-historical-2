diff -NurB gnopernicus-0.8.1-orig/braille/libbrl/ttybrl.c gnopernicus-0.8.1/braille/libbrl/ttybrl.c
--- gnopernicus-0.8.1-orig/braille/libbrl/ttybrl.c	2004-03-24 22:58:23.000000000 -0500
+++ gnopernicus-0.8.1/braille/libbrl/ttybrl.c	2004-03-24 22:58:43.000000000 -0500
@@ -127,7 +127,11 @@
     while (brlapi_readCommand (0, &keypress) == 1) 
     {
 	/* TODO: Find a better way to map brltty commands to gnopernicus keys. */
-	switch (keypress & ~VAL_TOGGLE_MASK) 
+#ifdef VAL_TOGGLE_MASK
+	switch (keypress & ~VAL_TOGGLE_MASK)
+#else
+	switch (keypress & ~VAL_SWITCHMASK)
+#endif
 	{
 	    case CMD_LNUP:
     		sprintf(&dd.key_codes[0], "DK00");
