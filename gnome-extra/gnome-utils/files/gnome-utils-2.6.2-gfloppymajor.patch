--- gnome-utils-2.6.2/gfloppy/src/gfloppy.c	2004-04-28 18:22:36.000000000 -0500
+++ gnome-utils-2.6.2-fixed/gfloppy/src/gfloppy.c	2004-05-02 21:09:06.000000000 -0500
@@ -35,8 +35,8 @@
 #include <string.h>
 
 #ifdef HAVE_LINUX_FD_H
-#include <linux/fd.h>
-#include <linux/fs.h>
+ #include <linux/fd.h>
+ #include <sys/sysmacros.h>
 #endif
 
 #include "gfloppy.h"
@@ -579,7 +579,7 @@
 
 	if (stat (device, &s) < 0)
 		return GFLOPPY_NO_DEVICE;
-	if (!S_ISBLK(s.st_mode) || MAJOR(s.st_rdev) != FLOPPY_MAJOR)
+	if (!S_ISBLK(s.st_mode) || major(s.st_rdev) != FLOPPY_MAJOR)
 		return GFLOPPY_NO_DEVICE;
 
 	if (access (device, R_OK|W_OK) != 0)
--- gnome-utils-2.6.2/gfloppy/src/badblocks.c	2004-01-04 17:21:32.000000000 -0600
+++ gnome-utils-2.6.2-fixed/gfloppy/src/badblocks.c	2004-05-02 20:59:55.000000000 -0500
@@ -42,7 +42,6 @@
 
 #ifdef HAVE_LINUX_FD_H
 #include <linux/fd.h>
-#include <linux/fs.h>
 #endif
 
 #include <et/com_err.h>
