--- src/Makefile.am.orig	2005-09-04 08:49:40.000000000 +1000
+++ src/Makefile.am	2005-09-04 08:50:51.000000000 +1000
@@ -13,6 +13,7 @@
 if PTPCAM
 bin_PROGRAMS = ptpcam
 ptpcam_SOURCES = ptpcam.c ptpcam.h
-ptpcam_LDADD = -lptp2 @PTPCAM_LDFLAGS@
+ptpcam_LDADD = libptp2.la @PTPCAM_LDFLAGS@
+ptpcam_DEPENDANCIES = libptp2.la
 ptpcam_CFLAGS = @PTPCAM_CFLAGS@
 endif
--- src/Makefile.in.orig	2005-09-04 08:51:05.000000000 +1000
+++ src/Makefile.in	2005-09-04 08:52:24.000000000 +1000
@@ -1,4 +1,4 @@
-# Makefile.in generated by automake 1.8.4 from Makefile.am.
+# Makefile.in generated by automake 1.8.5 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
@@ -44,8 +44,7 @@
 DIST_COMMON = $(libptp2include_HEADERS) $(srcdir)/Makefile.am \
 	$(srcdir)/Makefile.in
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
-am__aclocal_m4_deps = $(top_srcdir)/./m4/byteorder.m4 \
-	$(top_srcdir)/./m4/stdint.m4 $(top_srcdir)/configure.in
+am__aclocal_m4_deps = $(top_srcdir)/configure.in
 am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \
 	$(ACLOCAL_M4)
 mkinstalldirs = $(mkdir_p)
@@ -62,7 +61,7 @@
 am__ptpcam_SOURCES_DIST = ptpcam.c ptpcam.h
 @PTPCAM_TRUE@am_ptpcam_OBJECTS = ptpcam-ptpcam.$(OBJEXT)
 ptpcam_OBJECTS = $(am_ptpcam_OBJECTS)
-ptpcam_DEPENDENCIES =
+@PTPCAM_TRUE@ptpcam_DEPENDENCIES = libptp2.la
 DEFAULT_INCLUDES = -I. -I$(srcdir) -I$(top_builddir)
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
@@ -162,7 +161,6 @@
 build_os = @build_os@
 build_vendor = @build_vendor@
 datadir = @datadir@
-effective_target = @effective_target@
 exec_prefix = @exec_prefix@
 host = @host@
 host_alias = @host_alias@
@@ -192,7 +190,8 @@
 libptp2include_HEADERS = ptp.h libptp-endian.h libptp-stdint.h
 DISTCLEANFILES = libptp-stdint.h libptp-endian.h
 @PTPCAM_TRUE@ptpcam_SOURCES = ptpcam.c ptpcam.h
-@PTPCAM_TRUE@ptpcam_LDADD = -lptp2 @PTPCAM_LDFLAGS@
+@PTPCAM_TRUE@ptpcam_LDADD = libptp2.la @PTPCAM_LDFLAGS@
+@PTPCAM_TRUE@ptpcam_DEPENDANCIES = libptp2.la
 @PTPCAM_TRUE@ptpcam_CFLAGS = @PTPCAM_CFLAGS@
 all: all-am
 
@@ -250,7 +249,7 @@
 	-test -z "$(lib_LTLIBRARIES)" || rm -f $(lib_LTLIBRARIES)
 	@list='$(lib_LTLIBRARIES)'; for p in $$list; do \
 	  dir="`echo $$p | sed -e 's|/[^/]*$$||'`"; \
-	  test "$$dir" = "$$p" && dir=.; \
+	  test "$$dir" != "$$p" || dir=.; \
 	  echo "rm -f \"$${dir}/so_locations\""; \
 	  rm -f "$${dir}/so_locations"; \
 	done
@@ -393,7 +392,7 @@
 	  $(AWK) '    { files[$$0] = 1; } \
 	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
-	  test -z "$$unique" && unique=$$empty_fix; \
+	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
 	    $$tags $$unique; \
 	fi
