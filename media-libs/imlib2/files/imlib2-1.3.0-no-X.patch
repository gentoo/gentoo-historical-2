http://bugs.gentoo.org/154304

Index: configure.in
===================================================================
RCS file: /cvs/e/e17/libs/imlib2/configure.in,v
retrieving revision 1.134
retrieving revision 1.135
diff -u -p -r1.134 -r1.135
--- configure.in	7 Nov 2006 04:37:34 -0000	1.134
+++ configure.in	8 Nov 2006 06:46:58 -0000	1.135
@@ -183,10 +183,13 @@ AC_ARG_WITH(freetype-config, [  --with-f
 freetype_cflags=`$FREETYPE_CONFIG --cflags`
 freetype_libs=`$FREETYPE_CONFIG --libs`
 
-AC_CHECK_HEADER(X11/X.h,
-  [ have_x="yes" ],
-  [ have_x="no" ])
-  
+AC_PATH_X
+if test "x$have_x" != "xdisabled"; then
+  AC_CHECK_HEADER(X11/X.h,
+    [ have_x="yes" ],
+    [ have_x="no" ])
+fi
+
 if test "x$have_x" = "xno"; then
    # If --without-x was passed, this will be "disabled" instead of "no" --
    # so always treat "no" as an error
