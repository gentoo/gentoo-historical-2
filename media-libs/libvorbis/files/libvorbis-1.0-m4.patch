diff -u -r libvorbis-1.0/vorbis.m4 libvorbis-cvs/vorbis.m4
--- libvorbis-1.0/vorbis.m4	2002-07-09 23:08:57.000000000 +1000
+++ libvorbis-cvs/vorbis.m4	2002-08-07 02:01:40.000000000 +1000
@@ -54,6 +54,7 @@
 #include <stdlib.h>
 #include <string.h>
 #include <vorbis/codec.h>
+#include <vorbis/vorbisenc.h>
 
 int main ()
 {
@@ -62,7 +63,7 @@
     vorbis_info		vi;
 
     vorbis_info_init (&vi);
-    vorbis_encode_init (&vi, 2, 44100, -1, 128, -1);
+    vorbis_encode_init (&vi, 2, 44100, -1, 128000, -1);
     vorbis_analysis_init (&vd, &vi);
     vorbis_block_init (&vd, &vb);
     /* this function was added in 1.0rc3, so this is what we're testing for */
@@ -86,8 +87,8 @@
        :
      else
        echo "*** Could not run Vorbis test program, checking why..."
-       CFLAGS="$CFLAGS $VORBIS_CFLAGS"
-       LIBS="$LIBS $VORBIS_LIBS $OGG_LIBS"
+       CFLAGS="$CFLAGS $VORBIS_CFLAGS $OGG_CFLAGS"
+       LIBS="$LIBS $VORBIS_LIBS $VORBISENC_LIBS $OGG_LIBS"
        AC_TRY_LINK([
 #include <stdio.h>
 #include <vorbis/codec.h>
