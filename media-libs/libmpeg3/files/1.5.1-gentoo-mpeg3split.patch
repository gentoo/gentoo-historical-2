--- Makefile	2003-07-26 17:53:04.000000000 -0400
+++ Makefile.blah	2003-07-26 17:50:44.000000000 -0400
@@ -63,10 +63,9 @@
 UTILOBJS = \
 	$(OBJDIR)/mpeg3cat.o \
 	$(OBJDIR)/mpeg3dump.o \
+	$(OBJDIR)/mpeg3split.o \
 	$(OBJDIR)/mpeg3toc.o
 
-#	$(OBJDIR)/mpeg3split.o \
-
 
 
 
@@ -152,9 +151,8 @@
 
 
 OUTPUT = $(OBJDIR)/libmpeg3.a
-UTILS = $(OBJDIR)/mpeg3dump $(OBJDIR)/mpeg3cat $(OBJDIR)/mpeg3toc 
-
-#$(OBJDIR)/mpeg3split
+SHAREDOUTPUT = $(OBJDIR)/libmpeg3.so
+UTILS = $(OBJDIR)/mpeg3dump $(OBJDIR)/mpeg3cat $(OBJDIR)/mpeg3toc $(OBJDIR)/mpeg3split
 
 
 LIBS = -lm -lpthread
@@ -165,7 +163,7 @@
 $(shell echo $(A52CFLAGS) > $(OBJDIR)/a52_flags)
 $(shell echo $(OBJS) $(ASMOBJS) $(A52OBJS) $(NASMOBJS) > $(OBJDIR)/objs)
 
-all: $(DIRS) $(OUTPUT) util
+all: $(DIRS) $(OUTPUT) $(SHAREDOUTPUT) util
 
 $(DIRS):
 	if ! test -d $@ ; then mkdir -p $@ ; fi
@@ -173,6 +171,9 @@
 $(OUTPUT): $(OBJS) $(ASMOBJS) $(NASMOBJS) $(A52OBJS) $(UTILOBJS)
 	ar rcs $(OUTPUT) `cat $(OBJDIR)/objs`
 
+$(SHAREDOUTPUT): $(OBJS) $(ASMOBJS) $(NASMOBJS)
+	gcc -shared -o $(SHAREDOUTPUT) $(OBJS) $(ASMOBJS) $(NASMOBJS)
+
 $(OBJDIR)/mpeg3dump: $(OUTPUT)
 	$(CC) `cat $(OBJDIR)/c_flags` -o $(OBJDIR)/mpeg3dump mpeg3dump.c $(OUTPUT) $(LIBS)
 
@@ -182,8 +183,8 @@
 $(OBJDIR)/mpeg3toc: $(OUTPUT)
 	$(CC) `cat $(OBJDIR)/c_flags` -o $(OBJDIR)/mpeg3toc mpeg3toc.c $(OUTPUT) $(LIBS)
 
-#$(OBJDIR)/mpeg3split: $(OUTPUT)
-#	$(CC) `cat $(OBJDIR)/c_flags` -o $(OBJDIR)/mpeg3split mpeg3split.c $(OUTPUT) $(LIBS)
+$(OBJDIR)/mpeg3split: $(OUTPUT)
+	$(CC) `cat $(OBJDIR)/c_flags` -o $(OBJDIR)/mpeg3split mpeg3split.c $(OUTPUT) $(LIBS)
 
 $(OBJDIR)/mpeg2qt: $(OUTPUT)
 	$(CC) `cat $(OBJDIR)/c_flags` -o $(OBJDIR)/mpeg2qt mpeg2qt.c \
@@ -239,7 +239,7 @@
 $(OBJDIR)/mpeg3demux.o: 			    mpeg3demux.c
 $(OBJDIR)/mpeg3ifo.o: 				    mpeg3ifo.c
 $(OBJDIR)/mpeg3io.o: 				    mpeg3io.c
-#$(OBJDIR)/mpeg3split.o: 			    mpeg3split.c
+$(OBJDIR)/mpeg3split.o: 			    mpeg3split.c
 $(OBJDIR)/mpeg3title.o: 			    mpeg3title.c
 $(OBJDIR)/mpeg3toc.o: 				    mpeg3toc.c
 $(OBJDIR)/mpeg3toc3.o:  			    mpeg3toc3.c
--- mpeg3split.c.orig	2003-07-26 17:55:26.000000000 -0400
+++ mpeg3split.c	2003-07-26 17:51:28.000000000 -0400
@@ -3,6 +3,7 @@
 #include <string.h>
 
 #include "mpeg3private.inc"
+#include "mpeg3private.h"
 
 void copy_data(FILE *out, FILE *in, long bytes)
 {
