--- src/demuxers/demux_aiff.old	2004-12-23 14:53:15.442028184 +0900
+++ src/demuxers/demux_aiff.c	2004-12-23 14:54:00.007253240 +0900
@@ -121,6 +121,12 @@
     chunk_type = BE_32(&preamble[0]);
     chunk_size = BE_32(&preamble[4]);
 
+    if (chunk_size > sizeof(buffer) / sizeof(buffer[0])) {
+    /* the chunk is too large to fit in the buffer -> this cannot be an aiff chunk */
+	this->status = DEMUX_FINISHED;
+	return 0;
+    }
+
     if (chunk_type == COMM_TAG) {
       if (this->input->read(this->input, buffer, chunk_size) !=
         chunk_size) {
