diff -ur xine-lib-1.0/src/input/librtsp/rtsp.c xine-lib-1.0-r1/src/input/librtsp/rtsp.c
--- xine-lib-1.0/src/input/librtsp/rtsp.c	2005-04-22 00:32:40.067919280 +0200
+++ xine-lib-1.0-r1/src/input/librtsp/rtsp.c	2005-04-22 00:32:16.066568040 +0200
@@ -218,6 +218,7 @@
   unsigned int answer_seq;
   char **answer_ptr=s->answers;
   int code;
+  int ans_count = 0;
   
   answer=rtsp_get(s);
   if (!answer)
@@ -268,7 +269,7 @@
     }
     *answer_ptr=answer;
     answer_ptr++;
-  } while (strlen(answer)!=0);
+  } while ((strlen(answer)!=0) && (++ans_count < MAX_FIELDS));
   
   s->cseq++;
   
diff -ur xine-lib-1.0/src/input/mms.c xine-lib-1.0-r1/src/input/mms.c
--- xine-lib-1.0/src/input/mms.c	2004-12-15 00:13:09.000000000 +0100
+++ xine-lib-1.0-r1/src/input/mms.c	2005-04-21 23:32:04.742572736 +0200
@@ -579,9 +579,13 @@
           lprintf ("stream object, stream id: %d, type: %d, encrypted: %d\n",
                    stream_id, type, encrypted);
           
-          this->stream_types[stream_id] = type;
-          this->stream_ids[this->num_stream_ids] = stream_id;
-          this->num_stream_ids++;
+          if (this->num_stream_ids < ASF_MAX_NUM_STREAMS && stream_id < ASF_MAX_NUM_STREAMS) {
+            this->stream_types[stream_id] = type;
+            this->stream_ids[this->num_stream_ids] = stream_id;
+            this->num_stream_ids++;
+          } else {
+            lprintf ("too many streams, skipping\n");
+          }
       
         }
         break;
Only in xine-lib-1.0-r1/src/input: mms.c.orig
