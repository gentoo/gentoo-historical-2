diff -ur xine-lib-1.0/src/input/librtsp/rtsp.c xine-lib-1.0-r1/src/input/librtsp/rtsp.c
--- xine-lib-1.0/src/input/librtsp/rtsp.c	2004-07-25 19:13:54.000000000 +0200
+++ xine-lib-1.0-r1/src/input/librtsp/rtsp.c	2005-04-21 23:31:28.167133048 +0200
@@ -17,7 +17,7 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA
  *
- * $Id: xine-lib-XSA-2004-8.patch,v 1.1 2005/04/21 22:05:51 flameeyes Exp $
+ * $Id: xine-lib-XSA-2004-8.patch,v 1.1 2005/04/21 22:05:51 flameeyes Exp $
  *
  * a minimalistic implementation of rtsp protocol,
  * *not* RFC 2326 compilant yet.
@@ -218,6 +218,7 @@
   unsigned int answer_seq;
   char **answer_ptr=s->answers;
   int code;
+  int ans_count = 0;
   
   answer=rtsp_get(s);
   if (!answer)
@@ -268,7 +269,7 @@
     }
     *answer_ptr=answer;
     answer_ptr++;
-  } while (strlen(answer)!=0);
+  } while ((strlen(answer)!=0) && (++ans_count < MAX_FIELDS));
   
   s->cseq++;
   
diff -ur xine-lib-1.0/src/input/mms.c xine-lib-1.0-r1/src/input/mms.c
--- xine-lib-1.0/src/input/mms.c	2004-12-15 00:13:09.000000000 +0100
+++ xine-lib-1.0-r1/src/input/mms.c	2005-04-21 23:32:04.742572736 +0200
@@ -579,9 +579,13 @@
           lprintf ("stream object, stream id: %d, type: %d, encrypted: %d\n",
                    stream_id, type, encrypted);
           
-          this->stream_types[stream_id] = type;
-          this->stream_ids[this->num_stream_ids] = stream_id;
-          this->num_stream_ids++;
+          if (this->num_stream_ids < ASF_MAX_NUM_STREAMS && stream_id < ASF_MAX_NUM_STREAMS) {
+            this->stream_types[stream_id] = type;
+            this->stream_ids[this->num_stream_ids] = stream_id;
+            this->num_stream_ids++;
+          } else {
+            lprintf ("too many streams, skipping\n");
+          }
       
         }
         break;
Only in xine-lib-1.0-r1/src/input: mms.c.orig
