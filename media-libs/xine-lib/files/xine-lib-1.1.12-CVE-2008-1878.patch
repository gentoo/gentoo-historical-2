
# HG changeset patch
# User Diego 'Flameeyes' PettenÃ² <flameeyes@gmail.com>
# Date 1181745932 -7200
# Node ID d0ced21e0cf2080e2d4c05e6009b76c7f42211f5
# Parent dcabf02a88e6e20712e9367db9a7070b0f5ef02c
Use strndup rather than just strdup to avoid overflows.
(transplanted from 47f7f33b32805da6e8f58513c38e01dc6a595fb8)

--- a/src/demuxers/demux_nsf.c	Tue Apr 15 01:05:22 2008 +0100
+++ b/src/demuxers/demux_nsf.c	Wed Jun 13 16:45:32 2007 +0200
@@ -106,9 +106,9 @@ static int open_nsf_file(demux_nsf_t *th
 
   this->total_songs = header[6];
   this->current_song = header[7];
-  this->title = strdup(&header[0x0E]);
-  this->artist = strdup(&header[0x2E]);
-  this->copyright = strdup(&header[0x4E]);
+  this->title = strndup((char*)&header[0x0E], 0x20);
+  this->artist = strndup((char*)&header[0x2E], 0x20);
+  this->copyright = strndup((char*)&header[0x4E], 0x20);
 
   this->filesize = this->input->get_length(this->input);
 

