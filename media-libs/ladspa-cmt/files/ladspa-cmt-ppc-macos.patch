diff -uNr cmt-org/src/analogue.cpp cmt/src/analogue.cpp
--- cmt-org/src/analogue.cpp	Sat Feb 17 05:50:07 2001
+++ cmt/src/analogue.cpp	Tue Sep 14 22:56:20 2004
@@ -24,7 +24,7 @@
 
 /*****************************************************************************/
 
-#include <malloc.h>
+#include <unistd.h>
 #include <math.h>
 #include <stdlib.h>
 #include "cmt.h"
diff -uNr cmt-org/src/canyondelay.cpp cmt/src/canyondelay.cpp
--- cmt-org/src/canyondelay.cpp	Sat Nov  4 05:39:53 2000
+++ cmt/src/canyondelay.cpp	Tue Sep 14 22:56:51 2004
@@ -25,7 +25,7 @@
 /*****************************************************************************/
 
 
-#include <malloc.h>
+#include <unistd.h>
 #include <math.h>
 #include "cmt.h"
 
diff -uNr cmt-org/src/lofi.cpp cmt/src/lofi.cpp
--- cmt-org/src/lofi.cpp	Mon Sep 17 17:15:46 2001
+++ cmt/src/lofi.cpp	Tue Sep 14 22:58:01 2004
@@ -24,7 +24,7 @@
 
 /*****************************************************************************/
 
-#include <malloc.h>
+#include <unistd.h>
 #include <math.h>
 #include <stdlib.h>
 #include "cmt.h"
diff -uNr cmt-org/src/makefile cmt/src/makefile
--- cmt-org/src/makefile	Tue Sep 14 22:50:10 2004
+++ cmt/src/makefile	Tue Sep 14 23:07:20 2004
@@ -5,15 +5,15 @@
 # Change this if you want to install somewhere else. In particularly
 # you may wish to remove the middle "local/" part.
 
-INSTALL_PLUGINS_DIR	=	/ladspa/
+INSTALL_PLUGINS_DIR	=	/usr/local/lib/ladspa/
 
 ###############################################################################
 #
 # GENERAL
 #
 
-INCLUDES	=	-I/
-CFLAGS		=	$(INCLUDES) -Wall -Werror  -fPIC
+INCLUDES	=	-I/usr/local/include/
+CFLAGS		=	$(INCLUDES) -Wall -Werror -O3 -fPIC
 CXXFLAGS	=	$(CFLAGS)
 PLUGIN_LIB	=	../plugins/cmt.so
 
@@ -68,7 +68,7 @@
 targets:	$(PLUGIN_LIB)
 
 $(PLUGIN_LIB):	$(PLUGIN_OBJECTS)
-	$(CXX)	-shared							\
+	$(CXX)	-dynamiclib -ldl							\
 		-o $(PLUGIN_LIB)					\
 		$(PLUGIN_OBJECTS)					
 
@@ -77,6 +77,7 @@
 	cp $(PLUGIN_LIB) $(INSTALL_PLUGINS_DIR)
 
 test:	/tmp/test.wav ../../ladspa_sdk/snd/noise.wav always
+ifeq ($(shell which play), /usr/bin/play)
 	@echo ---------------------------------------------
 	@echo First listen to the white noise input signal:
 	@echo ---------------------------------------------
@@ -86,7 +87,7 @@
 	@echo -------------------------
 	@echo Should be a noise band around 6000Hz, repeated quietly after 1s.
 	play /tmp/test.wav
-
+endif
 /tmp/test.wav:	$(PLUGIN_LIB) ../../ladspa_sdk/snd/noise.wav
 	analyseplugin $(PLUGIN_LIB)
 	echo;analyseplugin -l $(PLUGIN_LIB);echo
diff -uNr cmt-org/src/phasemod.cpp cmt/src/phasemod.cpp
--- cmt-org/src/phasemod.cpp	Mon Sep 17 17:15:46 2001
+++ cmt/src/phasemod.cpp	Tue Sep 14 23:08:34 2004
@@ -24,7 +24,7 @@
 
 /*****************************************************************************/
 
-#include <malloc.h>
+#include <unistd.h>
 #include <math.h>
 #include <stdlib.h>
 #include "cmt.h"
diff -uNr cmt-org/src/syndrum.cpp cmt/src/syndrum.cpp
--- cmt-org/src/syndrum.cpp	Thu Dec 19 14:54:36 2002
+++ cmt/src/syndrum.cpp	Tue Sep 14 23:08:52 2004
@@ -24,7 +24,7 @@
 
 /*****************************************************************************/
 
-#include <malloc.h>
+#include <unistd.h>
 #include <math.h>
 #include "cmt.h"
 
diff -uNr cmt-org/src/vcf303.cpp cmt/src/vcf303.cpp
--- cmt-org/src/vcf303.cpp	Sat Nov  4 05:39:53 2000
+++ cmt/src/vcf303.cpp	Tue Sep 14 23:09:16 2004
@@ -26,7 +26,7 @@
 /*****************************************************************************/
 
 
-#include <malloc.h>
+#include <unistd.h>
 #include <math.h>
 #include "cmt.h"
 
