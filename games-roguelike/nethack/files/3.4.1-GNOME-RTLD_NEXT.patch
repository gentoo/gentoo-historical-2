diff -ur base.1/sys/unix/unixres.c work/sys/unix/unixres.c
--- base.1/sys/unix/unixres.c	2003-02-23 09:43:39.000000000 -0500
+++ work/sys/unix/unixres.c	2003-03-05 16:56:12.000000000 -0500
@@ -14,14 +14,19 @@
  * hide them.
  */
 
+/* _GNU_SOURCE has to be set before including config.h, as otherwise
+ * features.h will be included and it will be too late.
+ */
+
+#if defined(linux) && defined(__GNUC__)
+# define _GNU_SOURCE
+#endif
+
 #include "config.h"
 
 #ifdef GETRES_SUPPORT
 
 # if defined(LINUX)
-#ifdef __GNUC__
-#define _GNU_SOURCE
-#endif
 
 /* requires dynamic linking with libc */
 #include <dlfcn.h>
