From 33a9ee9ba0ab44548afafa965bbd0a715cb1509c Mon Sep 17 00:00:00 2001
From: Adam Jackson <ajax@redhat.com>
Date: Mon, 24 Mar 2008 12:22:19 -0400
Subject: [PATCH] Bug #13962: Re-arm the DPMS timer when re-enabling DPMS.
 (cherry picked from commit 536f2ff5382aaaace3b55481e15366bb15d87801)

---
 Xext/dpms.c |    7 +++++--
 1 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/Xext/dpms.c b/Xext/dpms.c
index aced406..0557523 100644
--- a/Xext/dpms.c
+++ b/Xext/dpms.c
@@ -200,12 +200,15 @@ static int
 ProcDPMSEnable(client)
     register ClientPtr client;
 {
-    /* REQUEST(xDPMSEnableReq); */
+    Bool was_enabled = DPMSEnabled;
 
     REQUEST_SIZE_MATCH(xDPMSEnableReq);
 
-    if (DPMSCapableFlag)
+    if (DPMSCapableFlag) {
 	DPMSEnabled = TRUE;
+	if (!was_enabled)
+	    SetScreenSaverTimer();
+    }
 
     return(client->noClientException);
 }
-- 
1.5.5.1

