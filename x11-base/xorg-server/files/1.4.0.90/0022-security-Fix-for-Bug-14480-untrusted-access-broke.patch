From 74b40bba327a2e97780e8e3f995f784add2d6231 Mon Sep 17 00:00:00 2001
From: Eamon Walsh <ewalsh@tycho.nsa.gov>
Date: Thu, 14 Feb 2008 19:47:44 -0500
Subject: [PATCH] security: Fix for Bug #14480: untrusted access broken in 7.3.

---
 Xext/security.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/Xext/security.c b/Xext/security.c
index e9d48c9..14ad354 100644
--- a/Xext/security.c
+++ b/Xext/security.c
@@ -1014,7 +1014,7 @@ CALLBACK(SecurityCheckResourceIDAccess)
     }
     else /* server-owned resource - probably a default colormap or root window */
     {
-	if (RT_WINDOW == rtype || RC_DRAWABLE == rtype)
+	if (RC_DRAWABLE & rtype)
 	{
 	    switch (reqtype)
 	    {   /* the following operations are allowed on root windows */
-- 
1.5.5.1

