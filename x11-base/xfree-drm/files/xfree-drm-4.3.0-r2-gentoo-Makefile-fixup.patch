--- Makefile.linux.orig	2003-04-21 21:25:07.000000000 +0100
+++ Makefile.linux	2003-04-21 21:32:23.000000000 +0100
@@ -155,20 +155,23 @@
 ifeq ($(AGP),1)
 MODCFLAGS += -DCONFIG_AGP -DCONFIG_AGP_MODULE
 DRMTEMPLATES += drm_agpsupport.h
-MODS += mga.o
 ifeq ($(MACHINE),i386)
+MODS += mga.o
+MODS += sis.o
 MODS += i810.o
 MODS += i830.o
 endif
 ifeq ($(MACHINE),i686)
+MODS += mga.o
+MODS += sis.o
 MODS += i810.o
 MODS += i830.o
 endif
 
 MGAOBJS =	mga_drv.o mga_dma.o mga_state.o mga_warp.o mga_irq.o
-MGAHEADERS =	mga.h mga_drv.h mga_drm.h $(DRMHEADERS) $(DRMTEMPLATES)
+MGAHEADERS =	mga.h mga_drv.h mga_drm.h mga_ucode.h $(DRMHEADERS) $(DRMTEMPLATES)
 MGASHARED =	mga.h mga_dma.c mga_drm.h mga_drv.h mga_state.c \
-		mga_ucode.h mga_warp.c
+		mga_ucode.h mga_warp.c mga_irq.c
 
 I810OBJS =	i810_drv.o i810_dma.o
 I810HEADERS =	i810.h i810_drv.h i810_drm.h $(DRMHEADERS) $(DRMTEMPLATES)
@@ -186,7 +189,6 @@
 endif
 
 
-MODS += sis.o
 
 SISOBJS=	sis_drv.o sis_mm.o sis_ds.o 
 SISHEADERS=	sis_drv.h sis_drm.h $(DRMHEADERS)
@@ -300,6 +302,12 @@
 $(I830OBJS): $(I830HEADERS)
 endif
 
+install: $(MODS)
+	install -d -m 0755 $(DESTDIR)/lib/modules/$(KV)/kernel/drivers/char/drm
+	@for i in $(MODS); do \
+		install -m 0755 $$i $(DESTDIR)/lib/modules/$(KV)/kernel/drivers/char/drm; \
+	done
+
 clean cleandir::
 	rm -f *.o *.a *~ core
 	@for i in $(SHAREDSRC); do \
