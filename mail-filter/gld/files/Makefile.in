prefix = @prefix@
bindir = @bindir@
DESTDIR = @destdir@

INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@ $(AM_INSTALL_PROGRAM_FLAGS)
INSTALL_DATA = @INSTALL_DATA@
INSTALL_SCRIPT = @INSTALL_SCRIPT@

CC = @CC@
MYSQL_CFLAGS = @MYSQL_CFLAGS@
MYSQL_LIBS = @MYSQL_LIBS@
MYSQL_PREFIX = @MYSQL_PREFIX@
CFLAGS = @CFLAGS@ -Wall
DEFS= @DEFS@

DIST_COMMON =  README Makefile.am Makefile.in configure configure.in

DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)

all: gld

gld: cnf.o server.o sql.o sockets.o greylist.o gld.h
	$(CC) $(CFLAGS) $(DEFS)  server.o sql.o sockets.o cnf.o greylist.o $(MYSQL_LIBS) -o gld

sockets.o: sockets.c sockets.h
	$(CC) $(CFLAGS) $(DEFS) -c sockets.c

cnf.o: cnf.c gld.h
	$(CC) $(DEFS) -c cnf.c

greylist.o: greylist.c gld.h
	$(CC) $(CFLAGS) $(DEFS) -c greylist.c

sql.o: sql.c
	$(CC) $(CFLAGS) $(DEFS) $(MYSQL_CFLAGS) -c sql.c

clean:
	$(RM) gld *.o

distclean: clean
	$(RM) Makefile config.status config.log config.cache
