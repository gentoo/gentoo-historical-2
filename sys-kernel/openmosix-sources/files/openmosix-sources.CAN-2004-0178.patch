--- linux-2.4.26-pre2/drivers/sound/sb_audio.c	2002-02-25 11:38:06.000000000 -0800
+++ linux-2.4.26-pre3/drivers/sound/sb_audio.c	2004-03-13 07:43:23.000000000 -0800
@@ -879,7 +879,7 @@
 			c -= locallen; p += locallen;
 		}
 		/* used = ( samples * 16 bits size ) */
-		*used = len << 1;
+		*used =  max_in  > ( max_out << 1) ? (max_out << 1) : max_in;
 		/* returned = ( samples * 8 bits size ) */
 		*returned = len;
 	}
