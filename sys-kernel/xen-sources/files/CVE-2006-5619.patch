--- net/ipv6/ip6_flowlabel.c-original	2007-01-27 15:31:44.000000000 +1100
+++ net/ipv6/ip6_flowlabel.c	2007-01-27 15:32:16.000000000 +1100
@@ -589,6 +589,8 @@
 	while (!fl) {
 		if (++state->bucket <= FL_HASH_MASK)
 			fl = fl_ht[state->bucket];
+		else
+			break;
 	}
 	return fl;
 }
