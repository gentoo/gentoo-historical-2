--- linux-2.4.26-sparc-r3/mm/memory.c.orig	2004-08-11 23:02:49.000000000 +0200
+++ linux-2.4.26-sparc-r3/mm/memory.c	2004-08-11 23:05:05.000000000 +0200
@@ -1594,11 +1594,14 @@
 	if (pmd_none(*pmd)) {
 		pte_t *new;
 
-		spin_unlock(&mm->page_table_lock);
-		new = pte_alloc_one(mm, address);
-		spin_lock(&mm->page_table_lock);
-		if (!new)
-			return NULL;
+		new = pte_alloc_one_fast(mm, address);
+		if (!new) {
+			spin_unlock(&mm->page_table_lock);
+			new = pte_alloc_one(mm, address);
+			spin_lock(&mm->page_table_lock);
+			if (!new)
+				return NULL;
+		}
 
 		/*
 		 * Because we dropped the lock, we should re-check the
