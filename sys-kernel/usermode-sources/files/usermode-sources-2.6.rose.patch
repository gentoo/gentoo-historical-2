diff -Naru a/net/rose/rose_route.c b/net/rose/rose_route.c
--- a/net/rose/rose_route.c	2005-04-29 17:09:49 -07:00
+++ b/net/rose/rose_route.c	2005-04-29 17:09:49 -07:00
@@ -727,7 +727,8 @@
 		}
 		if (rose_route.mask > 10) /* Mask can't be more than 10 digits */
 			return -EINVAL;
-
+		if (rose_route.ndigis > 8) /* No more than 8 digipeats */
+			return -EINVAL;
 		err = rose_add_node(&rose_route, dev);
 		dev_put(dev);
 		return err;
# This is a BitKeeper generated diff -Nru style patch.
#
# ChangeSet
#   2005/03/10 19:47:08-08:00 ralf@linux-mips.org 
#   [ROSE]: Fix minor security hole
#   
#   ROSE wasn't verifying the ndigis argument of a new route resulting in a
#   minor security hole.
#   
#   Signed-off-by: David S. Miller <davem@davemloft.net>
# 
# net/rose/rose_route.c
#   2005/03/10 19:46:52-08:00 ralf@linux-mips.org +2 -1
#   [ROSE]: Fix minor security hole
#   
#   ROSE wasn't verifying the ndigis argument of a new route resulting in a
#   minor security hole.
#   
#   Signed-off-by: David S. Miller <davem@davemloft.net>
# 
