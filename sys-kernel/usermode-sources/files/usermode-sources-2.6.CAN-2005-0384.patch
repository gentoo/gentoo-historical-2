diff -Naru a/drivers/net/ppp_async.c b/drivers/net/ppp_async.c
--- a/drivers/net/ppp_async.c	2005-04-29 17:05:10 -07:00
+++ b/drivers/net/ppp_async.c	2005-04-29 17:05:10 -07:00
@@ -1000,7 +1000,7 @@
 	data += 4;
 	dlen -= 4;
 	/* data[0] is code, data[1] is length */
-	while (dlen >= 2 && dlen >= data[1]) {
+	while (dlen >= 2 && dlen >= data[1] && data[1] >= 2) {
 		switch (data[0]) {
 		case LCP_MRU:
 			val = (data[2] << 8) + data[3];
# This is a BitKeeper generated diff -Nru style patch.
#
# ChangeSet
#   2005/03/15 15:38:47-08:00 paulus@au1.ibm.com 
#   [PATCH] CAN-2005-0384: Remote Linux DoS on ppp servers
#   
#   Martin Schulze writes:
#   
#   > Ben Martel and Stephen Blackheath have discovered a denial-of-service attack
#   > that a client of pppd can make that can hang the server machine.  The bug is
#   > in the Linux kernel 2.6 (tested on 2.6.9), but it looks like it also exists
#   > in the 2.4 series.
#   
#   Yes, this is my bug. :(
#   
#   I would just do this instead:
#   
#   Signed-off-by: Chris Wright <chrisw@osdl.org>
#   Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
# 
# drivers/net/ppp_async.c
#   2005/02/24 15:38:05-08:00 paulus@au1.ibm.com +1 -1
#   CAN-2005-0384: Remote Linux DoS on ppp servers
# 
