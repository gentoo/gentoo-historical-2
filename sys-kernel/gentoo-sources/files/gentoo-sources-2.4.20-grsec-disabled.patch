--- grsecurity/grsec_disabled.c~	2003-09-14 12:50:59.000000000 +0100
+++ grsecurity/grsec_disabled.c	2003-09-14 12:53:11.000000000 +0100
@@ -13,11 +13,18 @@
 #include <linux/skbuff.h>
 #include <linux/ip.h>
 #include <linux/sysctl.h>
+#include <linux/grdefs.h>
 
 #ifdef CONFIG_SYSCTL
 __u32
-gr_handle_sysctl(const struct ctl_table * table, __u32 mode)
+gr_handle_sysctl(const struct ctl_table * table, const void *oldval, const void *newval)
 {
+	__u32 mode = 0;
+	if (oldval)
+		mode |= GR_READ;
+	if (newval)
+		mode |= GR_WRITE
+
 	return mode;
 }
 #endif
