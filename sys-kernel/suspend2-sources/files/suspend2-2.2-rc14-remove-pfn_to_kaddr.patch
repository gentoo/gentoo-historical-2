diff -ruNp 9110-remove-pfn_to_kaddr.patch-old/kernel/power/atomic_copy.c 9110-remove-pfn_to_kaddr.patch-new/kernel/power/atomic_copy.c
--- 9110-remove-pfn_to_kaddr.patch-old/kernel/power/atomic_copy.c	2005-12-03 18:44:01.000000000 +1000
+++ 9110-remove-pfn_to_kaddr.patch-new/kernel/power/atomic_copy.c	2005-12-03 17:58:45.000000000 +1000
@@ -254,8 +254,8 @@ static inline void copyback_low(void)
 	
 	while (origoffset < max_pfn) {
 		if (!is_highmem(o_zone)) {
-			origpage = (unsigned long *) pfn_to_kaddr(origoffset);
-			copypage = (unsigned long *) pfn_to_kaddr(copyoffset);
+			origpage = (unsigned long *) __va(origoffset << PAGE_SHIFT);
+			copypage = (unsigned long *) __va(copyoffset << PAGE_SHIFT);
 		
 			loop = (PAGE_SIZE / sizeof(unsigned long)) - 1;
 		
@@ -291,7 +291,7 @@ void copyback_high(void)
 	while (origoffset < max_pfn) {
 		if (PageHighMem(pfn_to_page(origoffset))) {
 			origpage = (unsigned long *) kmap_atomic(pfn_to_page(origoffset), KM_USER1);
-			copypage = (unsigned long *) pfn_to_kaddr(copyoffset);
+			copypage = (unsigned long *) __va(copyoffset << PAGE_SHIFT);
 
 			memcpy(origpage, copypage, PAGE_SIZE);
 

