--- boinc-6.6.40/client/pers_file_xfer.cpp.orig	2009-10-02 20:55:03.419212277 -0400
+++ boinc-6.6.40/client/pers_file_xfer.cpp	2009-10-02 20:55:43.626712540 -0400
@@ -270,7 +270,7 @@
         // so that we'll query file size on next retry.
         // Otherwise leave it as is, avoiding unnecessary size query.
         //
-        if (fxp->bytes_xferred || (fip->urls.size() > 1)) {
+        if (last_bytes_xferred || (fip->urls.size() > 1)) {
             fip->upload_offset = -1;
         }
 
