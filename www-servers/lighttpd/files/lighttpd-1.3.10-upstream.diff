diff --exclude='*~' -urN lighttpd-1.3.10.orig/src/base.h lighttpd-1.3.10/src/base.h
--- lighttpd-1.3.10.orig/src/base.h	2005-02-14 08:59:15.496738424 -0500
+++ lighttpd-1.3.10/src/base.h	2005-02-14 09:02:47.454746494 -0500
@@ -45,6 +45,13 @@
 # define SSIZE_MAX ((size_t)~0 >> 1)
 #endif
 
+/* for MacOS X */
+#ifdef __APPLE__
+# include <crt_externs.h>
+# define environ (* _NSGetEnviron())
+#else
+ extern char **environ;
+#endif
 
 /* for solaris 2.5 and NetBSD 1.3.x */
 #ifndef HAVE_SOCKLEN_T
diff --exclude='*~' -urN lighttpd-1.3.10.orig/src/cgi.c lighttpd-1.3.10/src/cgi.c
--- lighttpd-1.3.10.orig/src/cgi.c	2005-02-14 08:59:15.462744036 -0500
+++ lighttpd-1.3.10/src/cgi.c	2005-02-14 09:00:45.386898712 -0500
@@ -686,16 +686,17 @@
 	
 	int to_cgi_fds[2];
 	int from_cgi_fds[2];
-	struct stat st;
-	
+
 #ifndef __WIN32	
-	
-	/* stat the exec file */
-	if (-1 == (stat(cgi_handler->ptr, &st))) {
-		log_error_write(srv, __FILE__, __LINE__, "sbss", 
-				"stat for cgi-handler", cgi_handler,
-				"failed:", strerror(errno));
-		return -1;
+	struct stat st;
+	if (cgi_handler->used > 1) {
+		/* stat the exec file */
+		if (-1 == (stat(cgi_handler->ptr, &st))) {
+			log_error_write(srv, __FILE__, __LINE__, "sbss", 
+					"stat for cgi-handler", cgi_handler,
+					"failed:", strerror(errno));
+			return -1;
+		}
 	}
 	
 	if (pipe(to_cgi_fds)) {
diff --exclude='*~' -urN lighttpd-1.3.10.orig/src/response.c lighttpd-1.3.10/src/response.c
--- lighttpd-1.3.10.orig/src/response.c	2005-02-14 08:59:15.462744036 -0500
+++ lighttpd-1.3.10/src/response.c	2005-02-14 09:04:16.505044865 -0500
@@ -1245,13 +1245,6 @@
 						default:
 							break;
 						}
-						
-						if (HANDLER_GO_ON == file_cache_get_entry(srv, con, srv->tmp_buf, &(con->fce))) {
-							/* rewrite uri.path to the real path (/ -> /index.php) */
-							buffer_append_string_buffer(con->uri.path, ds->value);
-							
-							break;
-						}
 					}
 					
 					if (k == con->conf.indexfiles->used) {
