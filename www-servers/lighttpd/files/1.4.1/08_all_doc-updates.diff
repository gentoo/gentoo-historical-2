--- branches/lighttpd-merge-1.4.x/doc/redirect.txt	(revision 619)
+++ branches/lighttpd-merge-1.4.x/doc/redirect.txt	(revision 620)
@@ -34,3 +34,6 @@
     url.redirect = ( "^/show/([0-9]+)/([0-9]+)$" => "http://www.example.org/show.php?isdn=$1&page$2",
                      "^/get/([0-9]+)/([0-9]+)$"  => "http://www.example.org/get.php?isdn=$1&page$2" )
 
+    $HTTP["host"] =~ "^www\.(.*)" {
+      url.redirect = ( "^/(.*)" => "http://%1/$1" )
+    }
--- branches/lighttpd-merge-1.4.x/doc/rewrite.txt	(revision 619)
+++ branches/lighttpd-merge-1.4.x/doc/rewrite.txt	(revision 620)
@@ -51,3 +51,7 @@
 
   url.rewrite-once = ( "^/id/([0-9]+)$" => "/index.php?id=$1",
                        "^/link/([a-zA-Z]+)" => "/index.php?link=$1" )
+
+  $HTTP["host"] =~ "^([^.]+)\.(this-is-mass-vhost\.com)" {
+    url.rewrite-once = ( "^/(.*)" => "/%2/%1/$1" )
+  }
--- branches/lighttpd-merge-1.4.x/doc/lighttpd.conf	(revision 619)
+++ branches/lighttpd-merge-1.4.x/doc/lighttpd.conf	(revision 620)
@@ -254,6 +254,10 @@
 #### url handling modules (rewrite, redirect, access)
 #url.rewrite                = ( "^/$"             => "/server-status" )
 #url.redirect               = ( "^/wishlist/(.+)" => "http://www.123.org/$1" )
+#### both rewrite/redirect support back reference to regex conditional using %n
+#$HTTP["host"] =~ "^www\.(.*)" {
+#  url.redirect            = ( "^/(.*)" => "http://%1/$1" )
+#}
 
 #
 # define a pattern for the host url finding
