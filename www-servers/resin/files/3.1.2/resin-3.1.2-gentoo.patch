diff -Nru resin-3.1.2.vanilla/Makefile.in resin-3.1.2/Makefile.in
--- resin-3.1.2.vanilla/Makefile.in	2007-08-17 09:44:18.000000000 +0200
+++ resin-3.1.2/Makefile.in	2007-08-17 09:45:48.000000000 +0200
@@ -9,20 +9,20 @@
 
 install	:
 	(cd modules/c/src; $(MAKE) install)
-	if test $(PREFIX) != `pwd`; then \
-	  mkdir -p $(PREFIX)/lib; \
-	  mkdir -p $(PREFIX)/$(LIBEXEC); \
-	  cp -r libexec/* $(PREFIX)/$(LIBEXEC); \
-	  cp lib/*.jar $(PREFIX)/lib; \
-	  mkdir -p $(PREFIX)/bin; \
-	  cp bin/* $(PREFIX)/bin; \
-	  mkdir -p $(PREFIX)/webapps; \
-	  cp -r webapps/* $(PREFIX)/webapps; \
-	  mkdir -p $(PREFIX)/conf; \
-	  cp conf/resin.conf $(PREFIX)/conf/resin.conf.orig; \
-	  cp conf/app-default.xml $(PREFIX)/conf/app-default.xml.orig; \
-	  if test ! -r $(PREFIX)/conf/resin.conf; then \
-	    cp conf/resin.conf $(PREFIX)/conf/resin.conf; \
-	    cp conf/app-default.xml $(PREFIX)/conf/app-default.xml; \
+	if test $(DESTDIR)/$(PREFIX) != `pwd`; then \
+	  mkdir -p $(DESTDIR)/$(PREFIX)/lib; \
+	  mkdir -p $(DESTDIR)/$(PREFIX)/$(LIBEXEC); \
+	  cp -r libexec/* $(DESTDIR)/$(PREFIX)/$(LIBEXEC); \
+	  cp lib/*.jar $(DESTDIR)/$(PREFIX)/lib; \
+	  mkdir -p $(DESTDIR)/$(PREFIX)/bin; \
+	  cp bin/* $(DESTDIR)/$(PREFIX)/bin; \
+	  mkdir -p $(DESTDIR)/$(PREFIX)/webapps; \
+	  cp -r webapps/* $(DESTDIR)/$(PREFIX)/webapps; \
+	  mkdir -p $(DESTDIR)/$(PREFIX)/conf; \
+	  cp conf/resin.conf $(DESTDIR)/$(PREFIX)/conf/resin.conf.orig; \
+	  cp conf/app-default.xml $(DESTDIR)/$(PREFIX)/conf/app-default.xml.orig; \
+	  if test ! -r $(DESTDIR)/$(PREFIX)/conf/resin.conf; then \
+	    cp conf/resin.conf $(DESTDIR)/$(PREFIX)/conf/resin.conf; \
+	    cp conf/app-default.xml $(DESTDIR)/$(PREFIX)/conf/app-default.xml; \
 	  fi; \
 	fi
diff -Nru resin-3.1.2.vanilla/build.xml resin-3.1.2/build.xml
--- resin-3.1.2.vanilla/build.xml	2007-08-17 09:44:18.000000000 +0200
+++ resin-3.1.2/build.xml	2007-08-17 09:47:12.000000000 +0200
@@ -7,7 +7,6 @@
 
   <property name="modules" location="${basedir}/modules"/>
   <property name="src" location="${basedir}/src"/>
-  <property name="ext" location="${basedir}/modules/ext"/>
   <property name="doc" location="${basedir}/doc"/>
 
   <property name="build" location="${install}/build"/>
@@ -17,14 +16,12 @@
 
 
   <property name="javac.verbose" value="off"/>
-  <property name="javac.debug" value="on"/>
+  <property name="javac.debug" value="off"/>
   <property name="javac.optimize" value="off"/>
   <property name="javac.deprecation" value="off"/>
   <property name="javac.nowarn" value="on"/>
   <property name="javac.memoryMaximumSize" value="256m"/>
 
-  <property name="javac.source" value="1.5"/>
-
   <property name="jar.compress" value="false"/>
   <!--
   <property name="jar.index" value="true"/>
@@ -66,14 +63,13 @@
   </target>
 
   <target name="compile" 
-          depends="init, jaxrpc, ejb, jpa, j2ee-deploy, j2ee-management, jca, jms, jsdk, jstl, jsf, jta, portlet, script, resin-util, quercus, resin, ecmascript, webutil, deploy, conf, ext">
+          depends="init, jaxrpc, ejb, jpa, j2ee-deploy, j2ee-management, jca, jms, jstl, jsf, jta, portlet, script, resin-util, quercus, resin, ecmascript, webutil, deploy, conf">
   </target>
 
   <target name="ant" depends="init">
     <antcall target="module" inheritRefs="true">
       <param name="module.name" value="ant"/>
       <param name="module.jar" value="resin-ant.jar"/>
-      <param name="javac.source" value="1.5"/>
     </antcall>
   </target>
 
@@ -81,7 +77,6 @@
     <antcall target="module" inheritRefs="true">
       <param name="module.name" value="ejb"/>
       <param name="module.jar" value="ejb-15.jar"/>
-      <param name="javac.source" value="1.5"/>
     </antcall>
   </target>
 
@@ -89,7 +84,6 @@
     <antcall target="module" inheritRefs="true">
       <param name="module.name" value="jpa"/>
       <param name="module.jar" value="jpa-15.jar"/>
-      <param name="javac.source" value="1.5"/>
     </antcall>
   </target>
 
@@ -107,11 +101,10 @@
     </antcall>
   </target>
 
-  <target name="jaxrpc" depends="init,saaj,jsdk">
+  <target name="jaxrpc" depends="init,saaj">
     <antcall target="module" inheritRefs="true">
       <param name="module.name" value="jaxrpc"/>
       <param name="module.jar" value="jaxrpc-15.jar"/>
-      <param name="javac.source" value="1.5"/>
     </antcall>
   </target>
 
@@ -150,7 +143,7 @@
     </antcall>
   </target>
 
-  <target name="jstl" depends="init, jsdk">
+  <target name="jstl" depends="init">
     <antcall target="module" inheritRefs="true">
       <param name="module.name" value="jstl"/>
       <param name="module.jar" value="jstl-11.jar"/>
@@ -196,7 +189,7 @@
     </antcall>
   </target>
 
-  <target name="resin-dev" depends="init, ejb, jca, jcr, jms, jsdk, jstl, jsf, jta, j2ee-deploy, j2ee-management, saaj, jaxrpc, portlet, script, resin-util">
+  <target name="resin-dev" depends="init, ejb, jca, jcr, jms, jstl, jsf, jta, j2ee-deploy, j2ee-management, saaj, jaxrpc, portlet, script, resin-util">
 
     <!-- filter to insert version -->
 
@@ -226,7 +219,6 @@
 
     <antcall target="module" inheritRefs="true">
       <param name="module.name" value="resin"/>
-      <param name="javac.source" value="1.5"/>
     </antcall>
   </target>
   
@@ -251,14 +243,12 @@
   <target name="webutil" depends="init, resin">
     <antcall target="module" inheritRefs="true">
       <param name="module.name" value="webutil"/>
-      <param name="javac.source" value="1.5"/>
     </antcall>
   </target>
 
   <target name="quercus-dev" depends="init">
     <antcall target="module" inheritRefs="true">
       <param name="module.name" value="quercus"/>
-      <param name="javac.source" value="1.5"/>
     </antcall>
   </target>
 
@@ -267,7 +257,6 @@
   <target name="ecmascript" depends="init">
     <antcall target="module" inheritRefs="true">
       <param name="module.name" value="ecmascript"/>
-      <param name="javac.source" value="1.5"/>
     </antcall>
   </target>
 
@@ -299,16 +288,15 @@
            verbose="${javac.verbose}" 
            debug="${javac.debug}" optimize="${javac.optimize}"
            deprecation="${javac.deprecation}" nowarn="${javac.nowarn}"
-           source="${javac.source}"
            excludes="**/.svn/**"
            memoryMaximumSize="${javac.memoryMaximumSize}">
       <classpath>
         <dirset dir="${modules}">
           <include name="*/classes"/>
        </dirset>
-        <fileset dir="${ext}">
-          <include name="**/*.jar"/>
-        </fileset>
+       <fileset dir="lib/">
+           <include name="*.jar"/>
+       </fileset>
       </classpath>
     </javac>
 
@@ -378,13 +366,6 @@
     </copy>
   </target>
 
-  <target name="ext" depends="init, resin">
-    <copy todir="${install}/lib" preservelastmodified="true">
-      <fileset dir="${ext}">
-      </fileset>
-    </copy>
-  </target>
-
   <target name="webapps" depends="init, doc, quercus">
   </target>
 
@@ -520,9 +501,6 @@
           <dirset dir="${modules}">
             <include name="*/classes"/>
           </dirset>
-          <fileset dir="${modules}/ext">
-            <include name="**/*.jar"/>
-          </fileset>
         </classpath>
       </java>
 
@@ -651,7 +629,6 @@
         <include name="lib/j2ee-management-10.jar"/>
         <include name="lib/jca-15.jar"/>
         <include name="lib/jms-11.jar"/>
-        <include name="lib/jsdk-15.jar"/>
         <!--
         <include name="lib/jsf-12.jar"/>
         -->
