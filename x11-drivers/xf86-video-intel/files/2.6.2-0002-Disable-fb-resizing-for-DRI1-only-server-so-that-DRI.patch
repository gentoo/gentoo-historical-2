From 70e0261208654c6c875ad462da2734c6aa9eeb96 Mon Sep 17 00:00:00 2001
From: Eric Anholt <eric@anholt.net>
Date: Tue, 24 Feb 2009 20:54:05 -0800
Subject: [PATCH] Disable fb resizing for DRI1-only server so that DRI1 can initialize.

---
 src/i830_driver.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/src/i830_driver.c b/src/i830_driver.c
index 2461e8a..1506ea7 100644
--- a/src/i830_driver.c
+++ b/src/i830_driver.c
@@ -1684,6 +1684,10 @@ I830AccelMethodInit(ScrnInfoPtr pScrn)
     pI830->can_resize = FALSE;
     if (pI830->accel == ACCEL_UXA && pI830->directRenderingType != DRI_XF86DRI)
 	pI830->can_resize = TRUE;
+#if !defined(DRI2) && defined(XF86DRI)
+    /* Disable resizing so that DRI1 can initialize and give us GEM support. */
+    pI830->can_resize = FALSE;
+#endif
 
     xf86DrvMsg(pScrn->scrnIndex, X_INFO,
 	       "Resizable framebuffer: %s (%d %d)\n",
-- 
1.6.1.3

