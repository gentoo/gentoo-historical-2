diff --git a/lib/gnutls_pk.c b/lib/gnutls_pk.c
index 1015c3a..a08349b 100644
--- a/lib/gnutls_pk.c
+++ b/lib/gnutls_pk.c
@@ -529,7 +529,7 @@ _generate_params (int algo, bigint_t * resarr, unsigned int *resarr_len,
   int ret;
   unsigned int i;
 
-  ret = _gnutls_pk_ops.generate (GNUTLS_PK_RSA, bits, &params);
+  ret = _gnutls_pk_ops.generate (algo, bits, &params);
 
   if (ret < 0)
     {
