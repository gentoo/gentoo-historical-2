diff -urN cyrus-sasl-2.1.12/cmulocal/sasl2.m4 cyrus-sasl-2.1.12-modified/cmulocal/sasl2.m4
--- cyrus-sasl-2.1.12/cmulocal/sasl2.m4	2003-02-03 11:09:08.000000000 -0600
+++ cyrus-sasl-2.1.12-modified/cmulocal/sasl2.m4	2003-02-06 03:27:59.000000000 -0600
@@ -44,14 +44,15 @@
 
   # Check a full link against the heimdal libraries.  If this fails, assume
   # MIT.
-  AC_CHECK_LIB(gssapi,gss_unwrap,gss_impl="heimdal",,$GSSAPIBASE_LIBS -lgssapi -lkrb5 -lasn1 -lroken ${LIB_CRYPT} -lcom_err)
-
+  if krb5-config --libs gssapi | grep -q -e -lroken ; then
+  AC_CHECK_LIB(gssapi,gss_unwrap,gss_impl="heimdal",,$GSSAPIBASE_LIBS `krb5-config --libs gssapi`)
+  fi
   if test "$gss_impl" = "mit"; then
-     GSSAPIBASE_LIBS="$GSSAPIBASE_LIBS -lgssapi_krb5 -lkrb5 -lk5crypto -lcom_err"
+     GSSAPIBASE_LIBS="$GSSAPIBASE_LIBS $(krb5-config --libs gssapi)"
      GSSAPIBASE_STATIC_LIBS="$GSSAPIBASE_LIBS $gssapi_dir/libgssapi_krb5.a $gssapi_dir/libkrb5.a $gssapi_dir/libk5crypto.a $gssapi_dir/libcom_err.a"
   elif test "$gss_impl" = "heimdal"; then
-     GSSAPIBASE_LIBS="$GSSAPIBASE_LIBS -lgssapi -lkrb5 -lasn1 -lroken ${LIB_CRYPT} -lcom_err"
-     GSSAPIBASE_STATIC_LIBS="$GSSAPIBASE_STATIC_LIBS $gssapi_dir/libgssapi.a $gssapi_dir/libkrb5.a $gssapi_dir/libasn1.a $gssapi_dir/libroken.a $gssapi_dir/libcom_err.a ${LIB_CRYPT}"
+     GSSAPIBASE_LIBS="$GSSAPIBASE_LIBS $(krb5-config --libs gssapi)"
+     GSSAPIBASE_STATIC_LIBS="$GSSAPIBASE_STATIC_LIBS $(krb5-config --libs gssapi)"
   else
      gssapi="no"
      AC_WARN(Disabling GSSAPI)
