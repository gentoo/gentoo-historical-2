--- configure.ac.orig	2010-09-20 23:15:36.692289201 +0200
+++ configure.ac	2010-09-20 23:17:50.380918143 +0200
@@ -66,12 +66,20 @@
 
 GDK_PIXBUF_REQUIRED_VERSION=2.12
 
+AC_ARG_ENABLE([gtk],
+	AC_HELP_STRING([--disable-gtk], [Disable libindicate-gtk library]),
+	[enable_gtk=$enableval], enable_gtk=auto)
+AM_CONDITIONAL([WANT_LIBINDICATEGTK], [test "x$enable_gtk" != "xno"])
+
+if test "x$enable_gtk" != "xno" ; then
 PKG_CHECK_MODULES(LIBINDICATEGTK, glib-2.0 >= $GLIB_REQUIRED_VERSION
                                   gio-2.0 >= $GIO_REQUIRED_VERSION
                                   gdk-pixbuf-2.0 >= $GDK_PIXBUF_REQUIRED_VERSION
                                   gtk+-2.0 >= $GTK_REQUIRED_VERSION
                                   dbusmenu-glib >= $DBUSMENU_REQUIRED_VERSION
                                   dbus-glib-1 >= $DBUS_REQUIRED_VERSION)
+fi
+
 AC_SUBST(LIBINDICATEGTK_CFLAGS)
 AC_SUBST(LIBINDICATEGTK_LIBS)
 
--- Makefile.am.orig	2010-09-20 23:12:10.442903362 +0200
+++ Makefile.am	2010-09-20 23:17:35.141406450 +0200
@@ -1,12 +1,15 @@
 
 SUBDIRS = \
 	libindicate \
-	libindicate-gtk \
 	bindings \
 	examples \
 	tests \
 	docs
 
+if WANT_LIBINDICATEGTK
+SUBDIRS += libindicate-gtk
+endif
+
 EXTRA_DIST = \
 	COPYING.LGPL.2.1 \
 	gtk-doc.make \
