--- lsh-1.4.3/src/sftp/sftp_c.c.orig	2004-07-11 16:33:04.488647128 -0400
+++ lsh-1.4.3/src/sftp/sftp_c.c	2004-07-11 16:33:29.583832080 -0400
@@ -1096,9 +1096,10 @@
   int ret;
   int write_needed = 0;
   UINT32 i;
+  struct sftp_callback *pos = state;
 
   /* FIXME: state is const */
-  state->mem.used = 0;
+  pos->mem.used = 0;
 
   sftp_get_mem_main(next, msg, id, in, out, state );
 
