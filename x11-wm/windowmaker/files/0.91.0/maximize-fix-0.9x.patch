--- WindowMaker-0.91.0/src/actions.c_old	2005-06-12 15:37:16.000000000 +0200
+++ WindowMaker-0.91.0/src/actions.c	2005-06-12 15:38:44.000000000 +0200
@@ -474,7 +474,7 @@
 void
 wUnmaximizeWindow(WWindow *wwin)
 {
-    int restore_x, restore_y;
+    int x, y, w, h;
 
     if (!wwin->flags.maximized)
         return;
@@ -483,13 +483,17 @@
         wwin->flags.skip_next_animation = 1;
         wUnshadeWindow(wwin);
     }
-    restore_x = (wwin->flags.maximized & MAX_HORIZONTAL) ?
+    x = ((wwin->flags.maximized & MAX_HORIZONTAL) && wwin->old_geometry.x) ?
         wwin->old_geometry.x : wwin->frame_x;
-    restore_y = (wwin->flags.maximized & MAX_VERTICAL) ?
+    y = ((wwin->flags.maximized & MAX_VERTICAL) && wwin->old_geometry.y) ?
         wwin->old_geometry.y : wwin->frame_y;
+    w = wwin->old_geometry.width ?
+        wwin->old_geometry.width : wwin->client.width;
+    h = wwin->old_geometry.height ?
+        wwin->old_geometry.height : wwin->client.height;
+
     wwin->flags.maximized = 0;
-    wWindowConfigure(wwin, restore_x, restore_y,
-                     wwin->old_geometry.width, wwin->old_geometry.height);
+    wWindowConfigure(wwin, x, y, w, h);
 
     WMPostNotificationName(WMNChangedState, wwin, "maximize");
 
