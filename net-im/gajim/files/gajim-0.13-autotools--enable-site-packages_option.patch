autotools: add --enable-site-packages option

This option allows the installation of pyfiles in PYTHON/site-packages/gajim
instead of DATADIR/gajim/src.

partial backport of upstream version (http://trac.gajim.org/ticket/5460).

diff --git a/configure.ac b/configure.ac
--- a/configure.ac
+++ b/configure.ac
@@ -65,6 +65,20 @@
 AM_CHECK_PYTHON_HEADERS(,[AC_MSG_ERROR(could not find Python headers)])
 AC_SUBST([PYTHON_INCLUDES])
 
+dnl ****
+dnl enable installation in python-2.x/site-packages/gajim
+dnl ****
+AC_ARG_ENABLE(site-packages,
+  [AS_HELP_STRING([--enable-site-packages],
+	[install gajim sources in PYTHONDIR/site-packages/gajim
+instead of DATADIR/gajim/src.])]
+,
+AC_SUBST([gajim_srcdir], [\${pkgpythondir}])
+,
+AC_SUBST([gajim_srcdir], [\${datadir}/\${PACKAGE}/src])
+)
+
+AS_AC_EXPAND(GAJIM_SRCDIR, "${gajim_srcdir}")
 AS_AC_EXPAND(DATADIR, "${datadir}")
 AS_AC_EXPAND(LIBDIR, "${libdir}")
 AS_AC_EXPAND(DOCDIR, "${docdir}")
@@ -95,4 +109,11 @@
 ***************************** 
   Build features:
     trayicon ......... ${have_trayicon}
+
+  Installation:
+    Prefix ........... ${prefix}
+    Python modules ... ${GAJIM_SRCDIR}
+    C modules ........ ${LIBDIR}/gajim
+    Documentation .... ${DOCDIR}
+    Others............ ${DATADIR}/gajim
 *****************************"
diff --git a/data/Makefile.am b/data/Makefile.am
--- a/data/Makefile.am
+++ b/data/Makefile.am
@@ -5,7 +5,7 @@
 desktop_in_files = gajim.desktop.in.in 
 desktop_DATA = $(desktop_in_files:.desktop.in.in=.desktop)
 
-installdefsdir = $(pkgdatadir)/src/common
+installdefsdir = $(gajim_srcdir)/common
 installdefs_DATA = defs.py
 
 soundsdir = $(pkgdatadir)/data/sounds
diff --git a/scripts/gajim.in b/scripts/gajim.in
--- a/scripts/gajim.in
+++ b/scripts/gajim.in
@@ -32,6 +32,6 @@
 export datadir=@DATADIR@/gajim
 PYTHON_EXEC=@PYTHON@
 
-cd ${datadir}/src
+cd "@GAJIM_SRCDIR@"
 export PYTHONPATH="$PYTHONPATH:@LIBDIR@/gajim"
 exec ${PYTHON_EXEC} -OO $APP.py "$@"
diff --git a/src/Makefile.am b/src/Makefile.am
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -26,37 +26,16 @@
 		    --override $(srcdir)/trayicon.override \
 		    $(srcdir)/trayicon.defs > $@
 endif
-gajimsrcdir = $(pkgdatadir)/src
-gajimsrc_PYTHON = $(srcdir)/*.py
+gajimsrcdir = $(gajim_srcdir)
+nobase_dist_gajimsrc_PYTHON = \
+	$(srcdir)/*.py \
+	$(srcdir)/common/*.py \
+	$(srcdir)/common/xmpp/*.py \
+	$(srcdir)/common/zeroconf/*.py \
+	$(srcdir)/command_system/*.py \
+	$(srcdir)/command_system/implementation/*.py
 
-gajimsrc1dir = $(pkgdatadir)/src/common
-gajimsrc1_PYTHON = \
-				$(srcdir)/common/*.py
-
-gajimsrc2dir = $(pkgdatadir)/src/common/xmpp
-gajimsrc2_PYTHON = \
-				$(srcdir)/common/xmpp/*.py
-
-gajimsrc3dir = $(pkgdatadir)/src/common/zeroconf
-gajimsrc3_PYTHON = \
-				$(srcdir)/common/zeroconf/*.py
-
-gajimsrc4dir = $(pkgdatadir)/src/command_system
-gajimsrc4_PYTHON = \
-				   $(srcdir)/command_system/*.py
-
-gajimsrc5dir = $(pkgdatadir)/src/command_system/implementation
-gajimsrc5_PYTHON = \
-				   $(srcdir)/command_system/implementation/*.py
-
-DISTCLEANFILES =
-
-EXTRA_DIST = $(gajimsrc_PYTHON) \
-			$(gajimsrc1_PYTHON) \
-			$(gajimsrc2_PYTHON) \
-			$(gajimsrc3_PYTHON) \
-			$(gajimsrc4_PYTHON) \
-			$(gajimsrc5_PYTHON) \
+EXTRA_DIST = \
 			eggtrayicon.c \
 			trayiconmodule.c \
 			eggtrayicon.h \
