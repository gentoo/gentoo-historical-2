--- splash	2005-07-08 20:14:29.000000000 +0100
+++ splash	2005-07-08 20:14:29.000000000 +0100
@@ -15,9 +15,9 @@
 [[ -z ${SPLASH_SHUTDOWN_MESSAGE} ]] && SPLASH_SHUTDOWN_MESSAGE="Shutting down the system (\$progress%)... Press F2 for verbose mode"
 [[ -z ${SPLASH_REBOOT_MESSAGE} ]] 	&& SPLASH_REBOOT_MESSAGE="Rebooting the system (\$progress%)... Press F2 for verbose mode"
 
-[[ RC_GOT_FUNCTIONS != "yes" ]] && . /sbin/functions.sh
-[[ -f /etc/conf.d/splash ]] 	&& . /etc/conf.d/splash
-[[ -f /etc/conf.d/rc ]] 		&& . /etc/conf.d/rc
+[[ ${RC_GOT_FUNCTIONS} != "yes" ]] && source /sbin/functions.sh
+[[ -f $(add_suffix /etc/conf.d/splash) ]] \
+	&& source "$(add_suffix /etc/conf.d/splash)"
 [[ ${RUNLEVEL} == "6" || ${RUNLEVEL} == "0" ]] && SHUTDOWN="yes"
 
 SPLUTIL="/sbin/splash_util.static"
--- splash-functions.sh	2005-07-18 13:48:05.000000000 +0100
+++ splash-functions.sh	2005-07-18 13:48:05.000000000 +0100
@@ -26,23 +26,6 @@
 spl_fifo="${spl_cachedir}/.splash"
 spl_pidfile="${spl_cachedir}/daemon.pid"
 
-# This is a little tricky. We need depscan.sh to create an updated cache for
-# us, and we need it in our place ($spl_cachedir), and not in $svcdir, since the
-# latter might not be writable at this moment. In order to get what we need, 
-# we trick depscan.sh into thinking $svcdir is $spl_cachedir. 
-#
-# Here is how it works:
-# - $svcdir is defined in /sbin/functions.sh
-# - /sbin/splash-functions.sh is sourced from /sbin/function.sh, after $svcdir
-#   is defined
-# - /sbin/functions.sh is sourced from /sbin/depscan.sh
-#
-# $spl_cache_depscan is used to prevent breaking things when /sbin/depscan.sh
-# is not run by us.
-if [[ "$0" == "/sbin/depscan.sh" && "${spl_cache_depscan}" == "yes" ]]; then
-	svcdir="${spl_cachedir}"
-fi 
-	
 # This is the main function that handles all events.
 # Accepted parameters:
 #  svc_start <name>
@@ -203,7 +193,7 @@
 	h=$(stat -c '%y' ${spl_cachedir}/deptree 2>/dev/null)
 
 	# Point depscan.sh to our cachedir
-	spl_cache_depscan="yes" /sbin/depscan.sh -u
+	spl_cache_depscan="yes" /sbin/depscan.sh --svcdir "${spl_cachedir}"
 
 	if [[ "$1" == "start" ]]; then
 		# Check whether the list of services that will be started during boot
