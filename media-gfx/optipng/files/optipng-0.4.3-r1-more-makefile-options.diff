diff -ruN optipng-0.4.3.orig/src/scripts/Makefile.gcc optipng-0.4.3/src/scripts/Makefile.gcc
--- optipng-0.4.3.orig/src/scripts/Makefile.gcc	2003-05-12 22:11:56.000000000 +0100
+++ optipng-0.4.3/src/scripts/Makefile.gcc	2004-03-13 15:38:59.000000000 +0000
@@ -3,19 +3,26 @@
 
 all: optipng
 
-optipng: optipng.o opngio.o opngreduc.o cbitset.o \
-  wildargs.o libpng.a libz.a
-	gcc -s -o optipng optipng.o opngio.o opngreduc.o cbitset.o \
-	  wildargs.o libpng.a libz.a
+optipng: CFLAGS += -I../lib-cos/zlib -I../lib-cos/libpng
+optipng: optipng.o opngio.o opngreduc.o cbitset.o libpng.a libz.a
+	${CC} ${LDFLAGS} -o optipng optipng.o opngio.o opngreduc.o cbitset.o libpng.a libz.a
+
+optipng-extpng: CFLAGS += -I../lib-cos/zlib
+optipng-extpng: optipng.o opngio.o opngreduc.o cbitset.o libz.a
+	${CC} ${LDFLAGS} -lpng -o optipng optipng.o opngio.o opngreduc.o cbitset.o libz.a
+
+optipng-extzlib: CFLAGS += -I../lib-cos/libpng
+optipng-extzlib: optipng.o opngio.o opngreduc.o cbitset.o libpng.a
+	${CC} ${LDFLAGS} -lz -o optipng optipng.o opngio.o opngreduc.o cbitset.o libpng.a
+
+optipng-allext: optipng.o opngio.o opngreduc.o cbitset.o
+	${CC} ${LDFLAGS} -lpng -lz -o optipng optipng.o opngio.o opngreduc.o cbitset.o
 
 .c.o: #png.h opng.h
-	gcc -c -O2 -I../lib-cos/zlib -I../lib-cos/libpng -Wall $*.c
+	gcc ${CFLAGS} -c $*.c
 
 cbitset.o: cbitset.c cbitset.h
-	gcc -c -O2 -Wall $*.c
-
-wildargs.o: xtra/wildargs.c
-	gcc -c -O2 xtra/wildargs.c
+	gcc ${CFLAGS} -c $*.c
 
 libpng.a: ../lib-cos/libpng/libpng.a
 	cp ../lib-cos/libpng/libpng.a libpng.a
