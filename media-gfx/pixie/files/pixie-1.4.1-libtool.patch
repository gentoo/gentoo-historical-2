diff -Naurp Pixie.orig/Makefile.am Pixie/Makefile.am
--- Pixie.orig/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/Makefile.am	2005-04-08 20:20:17.000000000 -0700
@@ -1,9 +1,5 @@
 SUBDIRS = src
 
-topdir = $(prefix)
-
-top_DATA = README AUTHORS LICENSE COPYING
-
 EXTRA_DIST = Pixie.dsw Pixie.ncb Pixie.opt DEVNOTES LICENSE makeclean.bat makeinst.bat tutorials win32inst
 
 dist-hook:
@@ -11,12 +8,6 @@ dist-hook:
 	cp -rf $(srcdir)/shaders $(distdir)
 
 install-data-local:
-	cp -rf $(srcdir)/doc $(DESTDIR)$(prefix)
-	cp -rf $(srcdir)/shaders $(DESTDIR)$(prefix)
-
-
-
-
-
-
-
+	mkdir -p $(DESTDIR)@datadir@/pixie
+	cp -rf $(srcdir)/doc $(DESTDIR)@datadir@/pixie
+	cp -rf $(srcdir)/shaders $(DESTDIR)@datadir@/pixie
diff -Naurp Pixie.orig/src/common/Makefile.am Pixie/src/common/Makefile.am
--- Pixie.orig/src/common/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/common/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -1,9 +1,11 @@
-noinst_LIBRARIES = libcommon.a 
+lib_LTLIBRARIES = libpixiecommon.la
 
-libcommon_a_SOURCES = algebra.cpp os.cpp memoryman.cpp
-libcommon_a_CFLAGS = -fPIC -DPIC
-libcommon_a_CXXFLAGS = -fPIC -DPIC
+LIBPIXIECOMMON_CURRENT_VERSION=0
+LIBPIXIECOMMON_REVISION_VERSION=0
+LIBPIXIECOMMON_AGE_VERSION=0
 
+libpixiecommon_la_LDFLAGS = -export-dynamic -version-info $(LIBPIXIECOMMON_CURRENT_VERSION):$(LIBPIXIECOMMON_REVISION_VERSION):$(LIBPIXIECOMMON_AGE_VERSION)
 
-EXTRA_DIST = *.h *.cpp *.dsp
+libpixiecommon_la_SOURCES = algebra.cpp os.cpp memoryman.cpp
 
+EXTRA_DIST = *.h *.cpp *.dsp
diff -Naurp Pixie.orig/src/file/Makefile.am Pixie/src/file/Makefile.am
--- Pixie.orig/src/file/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/file/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -1,11 +1,11 @@
-lib_LTLIBRARIES = file.la 
+lib_LTLIBRARIES = file.la
 
-LIBS = @TIFF_LIBS@
 file_la_SOURCES = file.cpp
-file_la_LIBADD = ../common/libcommon.a
+file_la_LIBADD = ../common/libpixiecommon.la @TIFF_LIBS@
 file_la_LDFLAGS = -module
 
 INCLUDES = -I..
 
 EXTRA_DIST = *cpp *.dsp
 
+libdir=@libdir@/pixie/displays
diff -Naurp Pixie.orig/src/framebuffer/Makefile.am Pixie/src/framebuffer/Makefile.am
--- Pixie.orig/src/framebuffer/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/framebuffer/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -1,11 +1,12 @@
 lib_LTLIBRARIES = framebuffer.la 
 
-CFLAGS = @CFLAGS@ @X_CFLAGS@
 framebuffer_la_SOURCES = framebuffer.cpp fbx.cpp
-framebuffer_la_LIBADD = ../common/libcommon.a @X_LIBS@
+framebuffer_la_LIBADD = ../common/libpixiecommon.la @X_LIBS@
 framebuffer_la_LDFLAGS = -module @X_LDFLAGS@
+framebuffer_la_CXXFLAGS = @X_CFLAGS@
 
 INCLUDES = -I..
 
 EXTRA_DIST = *.h *.cpp *.dsp
 
+libdir=@libdir@/pixie/displays
diff -Naurp Pixie.orig/src/precomp/Makefile.am Pixie/src/precomp/Makefile.am
--- Pixie.orig/src/precomp/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/precomp/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -2,7 +2,7 @@ bin_PROGRAMS = precomp 
 
 precomp_SOURCES = precomp.cpp
 
-precomp_LDADD = ../common/libcommon.a
+precomp_LDADD = ../common/libpixiecommon.la
 
 INCLUDES = -I..
 
diff -Naurp Pixie.orig/src/rgbe/Makefile.am Pixie/src/rgbe/Makefile.am
--- Pixie.orig/src/rgbe/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/rgbe/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -1,10 +1,12 @@
 lib_LTLIBRARIES = rgbe.la 
 
 rgbe_la_SOURCES = file.cpp rgbe.cpp
-rgbe_la_LIBADD = ../common/libcommon.a
+rgbe_la_LIBADD = ../common/libpixiecommon.la
 rgbe_la_LDFLAGS = -module
 
 INCLUDES = -I..
 
 EXTRA_DIST = *.h *.cpp *.dsp
 
+libdir=@libdir@/pixie/displays
+
diff -Naurp Pixie.orig/src/ri/Makefile.am Pixie/src/ri/Makefile.am
--- Pixie.orig/src/ri/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/ri/Makefile.am	2005-04-08 20:20:03.000000000 -0700
@@ -1,6 +1,11 @@
 lib_LTLIBRARIES = libri.la 
 
-LIBS = @TIFF_LIBS@
+LIBRI_CURRENT_VERSION=0
+LIBRI_REVISION_VERSION=0
+LIBRI_AGE_VERSION=0
+
+libri_la_CPPFLAGS = -DPIXIE_PROCEDURALS=\"@libdir@/pixie/procedurals\" -DPIXIE_DISPLAY=\"@libdir@/pixie/displays\" -DPIXIE_SHAREDIR=\"@datadir@/pixie\"
+libri_la_LDFLAGS = -export-dynamic -version-info $(LIBRI_CURRENT_VERSION):$(LIBRI_REVISION_VERSION):$(LIBRI_AGE_VERSION)
 libri_la_SOURCES = 		attributes.cpp \
 				bundles.cpp \
 				cache.cpp \
@@ -61,12 +66,10 @@ libri_la_SOURCES = 		attributes.cpp \
 				xform.cpp	\
 				zbuffer.cpp
 
-libri_la_LIBADD = ../common/libcommon.a
+libri_la_LIBADD = ../common/libpixiecommon.la @TIFF_LIBS@
 
 INCLUDES = -I..
 
-includedir = $(prefix)/include
-
 include_HEADERS = ri.h dsply.h shadeop.h implicit.h dlo.h
 
 EXTRA_DIST = *.h *.h *.cpp *.dsp *.l *.y readme.txt
diff -Naurp Pixie.orig/src/ri/options.cpp Pixie/src/ri/options.cpp
--- Pixie.orig/src/ri/options.cpp	2005-02-08 15:36:23.000000000 -0800
+++ Pixie/src/ri/options.cpp	2005-04-08 20:22:04.000000000 -0700
@@ -256,18 +256,30 @@ COptions::COptions() {
 
 	hider					=	strdup("stochastic");
 
-	archivePath				=	optionsGetSearchPath(".:%PIXIEHOME%/models:%RIBS%",NULL);
+#ifndef PIXIE_SHAREDIR
+#define PIXIE_SHAREDIR "%PIXIEHOME%"
+#endif
+
+#ifndef PIXIE_PROCEDURALS
+#define PIXIE_PROCEDURALS "%PIXIE_PROCEDURALS%"
+#endif
+
+#ifndef PIXIE_DISPLAY
+#define PIXIE_DISPLAY "%PIXIE_DISPLAY%"
+#endif
+
+	archivePath				=	optionsGetSearchPath(".:%PIXIEHOME%/models:%RIBS%:"PIXIE_SHAREDIR"/models",NULL);
 #ifdef _DEBUG
-	proceduralPath			=	optionsGetSearchPath(".:%PIXIEHOME%/procedurals:%PIXIEHOME%/bind:%PROCEDURALS%",NULL);
+	proceduralPath			=	optionsGetSearchPath(".:%PIXIEHOME%/procedurals:%PIXIEHOME%/bind:%PIXIE_PROCEDURALS%:%PROCEDURALS%",NULL);
 #else
-	proceduralPath			=	optionsGetSearchPath(".:%PIXIEHOME%/procedurals:%PIXIEHOME%/lib:%PROCEDURALS%",NULL);
+	proceduralPath			=	optionsGetSearchPath(".:%PIXIEHOME%/procedurals:%PIXIEHOME%/lib/procedurals:%PIXIE_PROCEDURALS%:%PROCEDURALS%:"PIXIE_PROCEDURALS,NULL);
 #endif
-	texturePath				=	optionsGetSearchPath(".:%PIXIEHOME%/textures:%TEXTURES%",NULL);
-	shaderPath				=	optionsGetSearchPath(".:%PIXIEHOME%/shaders:%SHADERS%",NULL);
+	texturePath				=	optionsGetSearchPath(".:%PIXIEHOME%/textures:%TEXTURES%:"PIXIE_SHAREDIR"/textures",NULL);
+	shaderPath				=	optionsGetSearchPath(".:%PIXIEHOME%/shaders:%SHADERS%:"PIXIE_SHAREDIR"/shaders",NULL);
 #ifdef _DEBUG
-	displayPath				=	optionsGetSearchPath(".:%PIXIEHOME%/bind:%DISPLAY%",NULL);
+	displayPath				=	optionsGetSearchPath(".:%PIXIEHOME%/bind:%PIXIE_DISPLAY%:%DISPLAY%",NULL);
 #else
-	displayPath				=	optionsGetSearchPath(".:%PIXIEHOME%/lib:%DISPLAY%",NULL);
+	displayPath				=	optionsGetSearchPath(".:%PIXIE_DISPLAY%:%DISPLAY%:"PIXIE_DISPLAY,NULL);
 #endif
 	temporaryPath			=	strdup("temp");
 
diff -Naurp Pixie.orig/src/rndr/Makefile.am Pixie/src/rndr/Makefile.am
--- Pixie.orig/src/rndr/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/rndr/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -1,7 +1,7 @@
 bin_PROGRAMS = rndr 
 
 rndr_SOURCES = rndr.cpp
-rndr_LDADD = ../ri/libri.la ../common/libcommon.a
+rndr_LDADD = ../ri/libri.la ../common/libpixiecommon.la
 
 INCLUDES = -I..
 
diff -Naurp Pixie.orig/src/sdr/Makefile.am Pixie/src/sdr/Makefile.am
--- Pixie.orig/src/sdr/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/sdr/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -1,13 +1,17 @@
 lib_LTLIBRARIES = libsdr.la 
 
+LIBSDR_CURRENT_VERSION=0
+LIBSDR_REVISION_VERSION=0
+LIBSDR_AGE_VERSION=0
+
+libsdr_la_LDFLAGS = -export-dynamic -version-info $(LIBSDR_CURRENT_VERSION):$(LIBSDR_REVISION_VERSION):$(LIBSDR_AGE_VERSION)
+
 libsdr_la_SOURCES = sdr.cpp
 
-libsdr_la_LIBADD = ../common/libcommon.a
+libsdr_la_LIBADD = ../common/libpixiecommon.la
 
 INCLUDES = -I..
 
-includedir = $(prefix)/include
-
 include_HEADERS = sdr.h
 
 EXTRA_DIST = *.h *.cpp *.l *.y *.dsp
diff -Naurp Pixie.orig/src/sdrc/Makefile.am Pixie/src/sdrc/Makefile.am
--- Pixie.orig/src/sdrc/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/sdrc/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -1,7 +1,7 @@
 bin_PROGRAMS = sdrc 
 
 sdrc_SOURCES = sdrc.cpp dso.cpp expression.cpp opcodes.cpp sdr.cpp sl.cpp pp1.c pp2.c pp3.c pp4.c pp5.c pp6.c pp7.c pp8.c
-sdrc_LDADD = ../common/libcommon.a
+sdrc_LDADD = ../common/libpixiecommon.la
 
 INCLUDES = -I..
 
diff -Naurp Pixie.orig/src/sdrinfo/Makefile.am Pixie/src/sdrinfo/Makefile.am
--- Pixie.orig/src/sdrinfo/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/sdrinfo/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -1,9 +1,8 @@
 bin_PROGRAMS = sdrinfo 
 
 sdrinfo_SOURCES = sdrinfo.cpp
-sdrinfo_LDADD = ../sdr/libsdr.la ../common/libcommon.a
+sdrinfo_LDADD = ../sdr/libsdr.la ../common/libpixiecommon.la
 
 INCLUDES = -I..
 
 EXTRA_DIST = *.cpp *.dsp
-
diff -Naurp Pixie.orig/src/show/Makefile.am Pixie/src/show/Makefile.am
--- Pixie.orig/src/show/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/show/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -4,8 +4,6 @@ endif
 
 EXTRA_DIST = *.h show.dsp
 
-CFLAGS = @CFLAGS@ @X_CFLAGS@
-
 show_SOURCES = cacheView.cpp \
 				radView.cpp \
 				interface.cpp \
@@ -13,12 +11,7 @@ show_SOURCES = cacheView.cpp \
 				photonView.cpp \
 				show.cpp
 
-show_LDADD = @X_LIBS@ @LIBFLTK@ @LIBFLTKGL@ @X_LDFLAGS@ ../common/libcommon.a
+show_LDADD = @X_LIBS@ @LIBFLTK@ @LIBFLTKGL@ @X_LDFLAGS@ ../common/libpixiecommon.la
+show_CXXFLAGS = @X_CFLAGS@
 
 INCLUDES = -I..
-
-
-
-
-
-
diff -Naurp Pixie.orig/src/texmake/Makefile.am Pixie/src/texmake/Makefile.am
--- Pixie.orig/src/texmake/Makefile.am	2005-02-08 15:36:29.000000000 -0800
+++ Pixie/src/texmake/Makefile.am	2005-04-08 20:19:22.000000000 -0700
@@ -1,9 +1,8 @@
 bin_PROGRAMS = texmake 
 
 texmake_SOURCES = texmake.cpp
-texmake_LDADD = ../ri/libri.la ../common/libcommon.a
+texmake_LDADD = ../ri/libri.la ../common/libpixiecommon.la
 
 INCLUDES = -I..
 
 EXTRA_DIST = *.cpp *.dsp
-
