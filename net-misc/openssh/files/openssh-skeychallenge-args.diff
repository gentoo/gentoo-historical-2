diff -ruN openssh-3.7.1p2.orig/auth-skey.c openssh-3.7.1p2/auth-skey.c
--- openssh-3.7.1p2.orig/auth-skey.c	2002-07-04 01:14:18.000000000 +0100
+++ openssh-3.7.1p2/auth-skey.c	2003-11-05 12:35:23.000000000 +0000
@@ -47,7 +47,7 @@
 	int len;
 	struct skey skey;
 
-	if (skeychallenge(&skey, authctxt->user, challenge) == -1)
+	if (skeychallenge(&skey, authctxt->user, challenge, sizeof challenge) == -1)
 		return -1;
 
 	*name  = xstrdup("");
diff -ruN openssh-3.7.1p2.orig/monitor.c openssh-3.7.1p2/monitor.c
--- openssh-3.7.1p2.orig/monitor.c	2003-09-02 22:32:46.000000000 +0100
+++ openssh-3.7.1p2/monitor.c	2003-11-05 12:36:03.000000000 +0000
@@ -736,7 +736,7 @@
 	char challenge[1024];
 	u_int success;
 
-	success = skeychallenge(&skey, authctxt->user, challenge) < 0 ? 0 : 1;
+	success = skeychallenge(&skey, authctxt->user, challenge, sizeof challenge) < 0 ? 0 : 1;
 
 	buffer_clear(m);
 	buffer_put_int(m, success);
