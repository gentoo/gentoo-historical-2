Index: channel.c
===================================================================
RCS file: /usr/cvsroot/asterisk/channel.c,v
retrieving revision 1.139.2.11
diff -u -r1.139.2.11 channel.c
--- channel.c	5 Aug 2005 00:02:09 -0000	1.139.2.11
+++ channel.c	11 Oct 2005 04:20:20 -0000
@@ -381,6 +381,12 @@
 	}
 	ast_mutex_lock(&chan->lock);
 	prev = NULL;
+
+	if (!chan->pvt ) {
+		ast_log(LOG_WARNING, "chan->pvt == NULL!!");
+		ast_mutex_unlock(&chan->lock);
+		return -1;
+	}
 	cur = chan->pvt->readq;
 	while(cur) {
 		if ((cur->frametype == AST_FRAME_CONTROL) && (cur->subclass == AST_CONTROL_HANGUP)) {
