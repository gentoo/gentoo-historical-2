Index: formats/format_jpeg.c
===================================================================
--- formats/format_jpeg.c	(.../1.2.6)	(revision 19610)
+++ formats/format_jpeg.c	(.../1.2.7)	(revision 19610)
@@ -55,7 +55,7 @@
 	struct ast_frame fr;
 	int res;
 	char buf[65536];
-	if (len > sizeof(buf)) {
+	if (len > sizeof(buf) || len < 0) {
 		ast_log(LOG_WARNING, "JPEG image too large to read\n");
 		return NULL;
 	}
