--- chkrootkit-0.37/chkrootkit	2002-09-16 18:03:11.000000000 -0500
+++ chkrootkit	2002-11-24 15:08:33.000000000 -0500
@@ -10,6 +10,15 @@
 # (C)1997-2002 Nelson Murilo, Pangeia Informatica, AMS Foundation and others.
 # All rights reserved
 
+# Gentoo specific : Could use `type <command> | cut -f 3 -d " "`
+IFPROMISC="/usr/sbin/ifpromisc"
+CHKLASTLOG="/usr/sbin/chklastlog"
+CHKPROC="/usr/sbin/chkproc"
+CHKWTMP="/usr/sbin/chkwtmp"
+CHECK_WTMPX="/usr/sbin/check_wtmpx"
+# ebuild doesn't install chkrootkit's strings; use gnus.
+STRINGS="/usr/bin/strings"
+
 ### workaround for some Bourne shell implementations
 unalias login > /dev/null 2>&1
 unalias ls > /dev/null 2>&1
@@ -125,22 +134,22 @@
        return ${NOT_TESTED}
     fi
 
-    if [ ! -x ./ifpromisc ]; then
-      echo "not tested: can't exec ./ifpromisc"
+    if [ ! -x $IFPROMISC ]; then
+      echo "not tested: can't exec $IFPROMISC"
       return ${NOT_TESTED}
     fi
 
     if [ "${EXPERT}" = "t" ]; then
-        expertmode_output "./ifpromisc"
+        expertmode_output "$IFPROMISC"
         return 5
     fi
     echo
-    ./ifpromisc
+    $IFPROMISC
 }
 
 z2 () {
-    if [ ! -x ./chklastlog ]; then
-      echo "not tested: can't exec ./chklastlog"
+    if [ ! -x $CHKLASTLOG ]; then
+      echo "not tested: can't exec $CHKLASTLOG"
       return ${NOT_TESTED}
     fi
 
@@ -148,31 +157,31 @@
     LASTLOG=`loc lastlog lastlog "${ROOTDIR}var/log ${ROOTDIR}var/adm"`
 
     if [ "${EXPERT}" = "t" ]; then
-        expertmode_output "./chklastlog -f ${WTMP} -l ${LASTLOG}"
+        expertmode_output "$CHKLASTLOG -f ${WTMP} -l ${LASTLOG}"
         return 5
     fi
 
-    if ./chklastlog -f ${WTMP} -l ${LASTLOG}
+    if $CHKLASTLOG -f ${WTMP} -l ${LASTLOG}
     then
       if [ "${QUIET}" != "t" ]; then echo "nothing deleted"; fi
     fi
 }
 
 wted () {
-    if [ ! -x ./chkwtmp ]; then
-      echo "not tested: can't exec ./chkwtmp"
+    if [ ! -x $CHKWTMP ]; then
+      echo "not tested: can't exec $CHKWTMP"
       return ${NOT_TESTED}
     fi
 
     if [ "$SYSTEM" = "SunOS" ]; then
-       if [ ! -x ./check_wtmpx ]; then
-          echo "not tested: can't exec ./check_wtmpx"
+       if [ ! -x $CHECK_WTMPX ]; then
+          echo "not tested: can't exec $CHECK_WTMPX"
        else
           if [ "${EXPERT}" = "t" ]; then
-             expertmode_output "./check_wtmpx"
+             expertmode_output "$CHECK_WTMPX"
               return 5
           fi
-          if ./check_wtmpx
+          if $CHECK_WTMPX
              then
              if [ "${QUIET}" != "t" ]; then \
                 echo "nothing deleted in /var/adm/wtmpx"; fi
@@ -183,11 +192,11 @@
     WTMP=`loc wtmp wtmp "${ROOTDIR}var/log ${ROOTDIR}var/adm"`
 
     if [ "${EXPERT}" = "t" ]; then
-        expertmode_output "./chkwtmp -f ${WTMP}"
+        expertmode_output "$CHKWTMP -f ${WTMP}"
         return 5
     fi
 
-    if ./chkwtmp -f ${WTMP}
+    if $CHKWTMP -f ${WTMP}
     then
       if [ "${QUIET}" != "t" ]; then echo "nothing deleted"; fi
     fi
@@ -225,15 +234,15 @@
 {
     if [ \( "${SYSTEM}" = "Linux"  -o \( "${SYSTEM}" = "FreeBSD" -a \
        ${V} -gt 43 \) \) -a "${ROOTDIR}" = "/" ]; then
-      if [ ! -x ./chkproc ]; then
-        echo "not tested: can't exec ./chkproc"
+      if [ ! -x $CHKPROC ]; then
+        echo "not tested: can't exec $CHKPROC"
         return ${NOT_TESTED}
       fi
 
       if [ "${EXPERT}" = "t" ]; then
          [ -r /proc/ksyms ] &&  ${egrep} -i adore < /proc/ksyms 2>/dev/null
          [ -d /proc/knark ] &&  ${ls} -la /proc/knark 2> /dev/null
-          expertmode_output "./chkproc -v"
+          expertmode_output "$CHKPROC -v"
           return 5
       fi
 
@@ -248,7 +257,7 @@
          echo "Warning: Knark LKM installed"
       fi
 
-      if ./chkproc
+      if $CHKPROC
       then
            if [ "${QUIET}" != "t" ]; then echo "nothing detected"; fi
       else
@@ -1293,18 +1302,18 @@
 
    if [ "${SYSTEM}" = "Linux" ]
    then
-      if [ ! -x ./strings ]; then
-        printn "can't exec ./strings-static, "
+      if [ ! -x $STRINGS ]; then
+        print "can't exec $STRINGS, "
         return ${NOT_TESTED}
       fi
 
       if [ "${EXPERT}" = "t" ]; then
-          expertmode_output "./strings -a ${CMD}"
+          expertmode_output "$STRINGS -a ${CMD}"
           return 5
       fi
 
       ### strings must be a statically linked binary.
-      if ./strings-static -a ${CMD} > /dev/null 2>&1
+      if $STRINGS -a ${CMD} > /dev/null 2>&1
       then
          STATUS=${INFECTED}
       fi
