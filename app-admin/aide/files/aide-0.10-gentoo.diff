diff -Naur aide-0.10/src/commandconf.c aide-0.10.fixed/src/commandconf.c
--- aide-0.10/src/commandconf.c	2003-11-04 09:39:48.000000000 -0600
+++ aide-0.10.fixed/src/commandconf.c	2004-09-11 09:37:44.143790160 -0500
@@ -29,7 +29,7 @@
 #include "aide.h"
 #include "conf_lex.h"
 #include "conf_yacc.h"
-#include "db.h"
+#include "../include/db.h"
 #include "db_config.h"
 #include "gen_list.h"
 #include "symboltable.h"
@@ -224,7 +224,7 @@
     }
     /* FIXME This does not handle the case that @@end_config is on 
        buffer boundary. */
-    if((tmp=strnstr(buf,"@@end_config",retval))!=NULL){
+    if((conf->confmd != MHASH_FAILED) && ((tmp=strnstr(buf,"@@end_config",retval))!=NULL)){
       /* We have end of config don't feed the last line to mhash */
       mhash(conf->confmd,(void*)buf,tmp-buf);
     } else {
diff -Naur aide-0.10/src/compare_db.c aide-0.10.fixed/src/compare_db.c
--- aide-0.10/src/compare_db.c	2003-11-04 09:39:48.000000000 -0600
+++ aide-0.10.fixed/src/compare_db.c	2004-09-11 09:31:44.222506512 -0500
@@ -30,7 +30,7 @@
 #include "gnu_regex.h"
 #include "gen_list.h"
 #include "list.h"
-#include "db.h"
+#include "../include/db.h"
 #include "util.h"
 #include "commandconf.h"
 #include "gen_list.h"
diff -Naur aide-0.10/src/conf_yacc.y aide-0.10.fixed/src/conf_yacc.y
--- aide-0.10/src/conf_yacc.y	2003-08-18 08:03:22.000000000 -0500
+++ aide-0.10.fixed/src/conf_yacc.y	2004-09-11 09:31:44.223506360 -0500
@@ -25,7 +25,7 @@
 #include <string.h>
 #include "list.h"
 #include "gen_list.h"
-#include "db.h"
+#include "../include/db.h"
 #include "db_config.h"
 #include "symboltable.h"
 #include "commandconf.h"
diff -Naur aide-0.10/src/db.c aide-0.10.fixed/src/db.c
--- aide-0.10/src/db.c	2003-11-04 09:13:06.000000000 -0600
+++ aide-0.10.fixed/src/db.c	2004-09-11 09:31:44.224506208 -0500
@@ -22,7 +22,7 @@
 #include <stdio.h>
 #include <stdlib.h>
 #include <errno.h>
-#include "db.h"
+#include "../include/db.h"
 #include "db_file.h"
 #include "db_disk.h"
 
diff -Naur aide-0.10/src/db_sql.c aide-0.10.fixed/src/db_sql.c
--- aide-0.10/src/db_sql.c	2003-01-16 04:37:34.000000000 -0600
+++ aide-0.10.fixed/src/db_sql.c	2004-09-11 09:31:44.225506056 -0500
@@ -31,7 +31,7 @@
 #include <string.h>
 #include <gcrypt.h>
 #include "base64.h"
-#include "db.h"
+#include "../include/db.h"
 
 #include "db_sql.h"
 #include "db_config.h"
diff -Naur aide-0.10/src/gen_list.c aide-0.10.fixed/src/gen_list.c
--- aide-0.10/src/gen_list.c	2003-11-04 09:39:48.000000000 -0600
+++ aide-0.10.fixed/src/gen_list.c	2004-09-11 09:31:44.226505904 -0500
@@ -38,7 +38,7 @@
 #include "list.h"
 #include "gen_list.h"
 #include "seltree.h"
-#include "db.h"
+#include "../include/db.h"
 #include "db_config.h"
 #include "compare_db.h"
 #include "commandconf.h"
