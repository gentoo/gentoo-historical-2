commit fd648907e46017d46c367f59c62d0b0395830903
Author: Simon McVittie <http://smcv.pseudorandom.co.uk/>
Date:   2009-01-04 19:35:51 +0000

    Allow root to send messages to all the system tools backends, so they work even when CVE-2008-4311 has been fixed.
    
    Also disallow normal user access by destination, not by interface (fd.o #18961).

diff --git a/system-tools-backends.conf b/system-tools-backends.conf
index 00d6d58..537ef73 100644
--- a/system-tools-backends.conf
+++ b/system-tools-backends.conf
@@ -23,8 +23,8 @@
     -->
 
     <!-- configuration modules can't be accessed directly... -->
-    <deny send_interface="org.freedesktop.SystemToolsBackends"/>
-    <deny send_interface="org.freedesktop.SystemToolsBackends.Platform"/>
+    <deny send_destination="org.freedesktop.SystemToolsBackends"/>
+    <deny send_destination="org.freedesktop.SystemToolsBackends.Platform"/>
     <deny send_destination="org.freedesktop.SystemToolsBackends"/>
   </policy>
 
@@ -47,9 +47,18 @@
 
     <!-- be able to speak to configuration modules,
          so any message to them has to go through the dispatcher -->
-    <allow send_interface="org.freedesktop.SystemToolsBackends"/>
-    <allow send_interface="org.freedesktop.SystemToolsBackends.Platform"/>
     <allow send_destination="org.freedesktop.SystemToolsBackends"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.Platform"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.GroupsConfig"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.HostsConfig"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.IfacesConfig"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.NFSConfig"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.NTPConfig"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.ServicesConfig"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.SMBConfig"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.TimeConfig"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.UserConfig"/>
+    <allow send_destination="org.freedesktop.SystemToolsBackends.UsersConfig"/>
   </policy>
   <policy group="stb-admin">
     <!-- be able to speak to the dispatcher -->
