--- groff-1.17.2.orig/src/preproc/pic/pic.y
+++ groff-1.17.2/src/preproc/pic/pic.y
@@ -1769,8 +1769,7 @@
       return strsave(form);
     }
   }
-  sprintf(sprintf_buf, form, n);
-  return strsave(sprintf_buf);
+  return do_sprintf(form, &n, 1);
 }

 char *do_sprintf(const char *form, const double *v, int nv)
@@ -1792,18 +1791,19 @@
       if (*form == '%') {
 	one_format += *form++;
 	one_format += '\0';
-	sprintf(sprintf_buf, one_format.contents());
+	snprintf(sprintf_buf, sizeof(sprintf_buf), "%s", one_format.contents());
       }
       else {
 	if (i >= nv) {
-	  lex_error("too few arguments to sprintf");
+	  lex_error("too few arguments to snprintf");
 	  result += one_format;
 	  result += form;
 	  break;
 	}
 	one_format += *form++;
 	one_format += '\0';
-	sprintf(sprintf_buf, one_format.contents(), v[i++]);
+	snprintf(sprintf_buf, sizeof(sprintf_buf),
+	         one_format.contents(), v[i++]);
       }
       one_format.clear();
       result += sprintf_buf;
