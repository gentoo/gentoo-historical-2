--- lib/posix/regex.h
+++ lib/posix/regex.h
@@ -533,7 +533,12 @@ extern int re_exec _RE_ARGS ((const char
 /* For now unconditionally define __restrict_arr to expand to nothing.
    Ideally we would have a test for the compiler which allows defining
    it to restrict.  */
+#if !defined(sun)
+# include <features.h>
+#endif
+#if !defined(__UCLIBC__) || !defined(__restrict_arr)
 #define __restrict_arr
+#endif
 
 /* POSIX compatibility.  */
 extern int regcomp _RE_ARGS ((regex_t *__restrict __preg,
