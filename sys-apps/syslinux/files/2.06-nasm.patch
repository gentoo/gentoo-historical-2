diff -urN syslinux-2.04.orig/memdisk/Makefile syslinux-2.04/memdisk/Makefile
--- syslinux-2.04.orig/memdisk/Makefile	2003-04-15 00:28:04.000000000 +0200
+++ syslinux-2.04/memdisk/Makefile	2003-09-01 00:29:23.000000000 +0200
@@ -60,10 +60,10 @@
 	echo '.code16gcc' | cat - $< > $@
 
 %.s: %.S
-	$(CC) -x c $(INCLUDE) $(CFLAGS) -traditional -E -o $@ $<
+	$(CC) -x assembler-with-cpp $(INCLUDE) $(CFLAGS) -traditional -E -o $@ $<
 
 %.s16: %.S16
-	$(CC) -x c $(INCLUDE) $(CFLAGS) -traditional -E -o $@ $<
+	$(CC) -x assembler-with-cpp $(INCLUDE) $(CFLAGS) -traditional -E -o $@ $<
 
 %.s: %.c
 	$(CC) $(INCLUDE) $(CFLAGS) -S -o $@ $<
@@ -98,7 +98,7 @@
 .depend:
 	rm -f .depend
 	for csrc in *.c ; do $(CC) $(INCLUDE) -MM $$csrc | sed -e 's/\.o/\.s/' >> .depend ; done
-	for ssrc in $(SSRC) ; do $(CC) $(INCLUDE) -x c -traditional -MM $$ssrc | sed -e 's/\.S16\.o/\.o16/' >> .depend ; done
+	for ssrc in $(SSRC) ; do $(CC) $(INCLUDE) -x assembler-with-cpp -traditional -MM $$ssrc | sed -e 's/\.o/\.o16/' >> .depend ; done
 	for nsrc in $(NASMSRC) ; do $(NASM) -DDEPEND $(NINCLUDE) -o `echo $$nsrc | sed -e 's/\.asm/\.bin/'` -M $$nsrc >> .depend ; done
 
 depend:
