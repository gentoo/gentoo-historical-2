#!/bin/sh
#RCUPDATE:1 2 3 4 5:50:This line is required for script management

[ -c /dev/urandom ] || exit 0

. /etc/rc.d/config/functions

SERVICE=urandom
opts="start stop restart"

start() {
	ebegin "Initializing random number generator"
        if [ -f /var/run/random-seed ]
        then
            cat /var/run/random-seed >/dev/urandom
        fi
        rm -f /var/run/random-seed
        umask 077
        dd if=/dev/urandom of=/var/run/random-seed count=1 1>&2 
	eend $? "Error initializing random number generator"
	umask 022
}

stop() {
	ebegin "Saving random seed"
        # Carry a random seed from shut-down to start-up;
        # see documentation in linux/drivers/char/random.c
        umask 077
        dd if=/dev/urandom of=/var/run/random-seed count=1 1>&2 
	eend $? "Could not save random seed."
}

restart() {
	
	stop
	start
}

doservice ${@}

