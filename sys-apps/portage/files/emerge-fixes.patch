--- bin/emerge	17 Apr 2005 09:01:55 -0000	1.345.2.24
+++ bin/emerge	24 Apr 2005 08:20:57 -0000
@@ -119,10 +119,24 @@
 def sorted_versions(verlist):
 	ret = []
 	for ver in verlist:
+		verparts = ver.split("-")
+		if len(verparts) == 2:
+			verrev = int(verparts[1][1:])
+		else:
+			verrev = 0
 		x = 0
 		while x < len(ret):
-			if portage.vercmp(ret[x], ver) >= 0:
+			retparts = ret[x].split("-")
+			verdiff = portage.vercmp(retparts[0], verparts[0])
+			if verdiff > 0:
 				break
+			elif verdiff == 0:
+				if len(retparts) == 2:
+					retrev = int(retparts[1][1:])
+				else:
+					retrev = 0
+				if retrev >= verrev:
+					break
 			x += 1
 		ret.insert(x, ver)
 	return ret
