Index: bin/repoman
===================================================================
--- bin/repoman	(revision 3970)
+++ bin/repoman	(revision 3972)
@@ -843,7 +843,8 @@
 
 	if mymode == "commit":
 		repoman_settings["O"] = checkdir
-		portage.digestgen([], repoman_settings, manifestonly=1, myportdb=portage.portdb)
+		portage.digestgen(
+			[], repoman_settings, manifestonly=1, myportdb=portdb)
 
 	mf = Manifest(checkdir, repoman_settings["DISTDIR"])
 	mydigests=mf.getTypeDigests("DIST")
Index: bin/etc-update
===================================================================
--- bin/etc-update	(revision 3970)
+++ bin/etc-update	(revision 3972)
@@ -272,9 +272,9 @@
 	local -i my_input=0
 	
 	until (( ${my_input} == -1 )) || [ ! -f ${file} ]; do
-		if [[ "${OVERWRITE_ALL}" == "yes" && ! user_special ${ofile} ]]; then
+		if [[ "${OVERWRITE_ALL}" == "yes" ]] && ! user_special "${ofile}"; then
 			my_input=1
-		elif [[ "${DELETE_ALL}" == "yes" && ! user_special ${ofile} ]]; then
+		elif [[ "${DELETE_ALL}" == "yes" ]] && ! user_special "${ofile}"; then
 			my_input=2
 		else
 		  showdiffcmd=$(echo "${diff_command}" |
