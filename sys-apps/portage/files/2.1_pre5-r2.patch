diff -Nur portage-2.1_pre5/bin/dobin portage-2.1_pre5-r2/bin/dobin
--- portage-2.1_pre5/bin/dobin	2006-02-03 22:56:26.000000000 -0800
+++ portage-2.1_pre5-r2/bin/dobin	2006-03-01 16:12:52.000000000 -0800
@@ -12,16 +12,11 @@
 	install -d "${D}${DESTTREE}/bin" || exit 2
 fi
 
-case ${CHOST} in
-	*-freebsd*) group=wheel ;;
-	*)          group=root ;;
-esac
-
 ret=0
 
 for x in "$@" ; do
 	if [[ -e ${x} ]] ; then
-		install -m0755 -o root -g ${group} "${x}" "${D}${DESTTREE}/bin"
+		install -m0755 -o 0 -g 0 "${x}" "${D}${DESTTREE}/bin"
 	else
 		echo "!!! ${0##*/}: ${x} does not exist" 1>&2
 		false
diff -Nur portage-2.1_pre5/bin/dosbin portage-2.1_pre5-r2/bin/dosbin
--- portage-2.1_pre5/bin/dosbin	2006-02-03 22:56:26.000000000 -0800
+++ portage-2.1_pre5-r2/bin/dosbin	2006-03-01 16:12:47.000000000 -0800
@@ -12,16 +12,11 @@
 	install -d "${D}${DESTTREE}/sbin" || exit 2
 fi
 
-case ${CHOST} in
-	*-freebsd*) group=wheel ;;
-	*)          group=root ;;
-esac
-
 ret=0
 
 for x in "$@" ; do
 	if [[ -e ${x} ]] ; then
-		install -m0755 -o root -g ${group} "${x}" "${D}${DESTTREE}/sbin"
+		install -m0755 -o 0 -g 0 "${x}" "${D}${DESTTREE}/sbin"
 	else
 		echo "!!! ${0##*/}: ${x} does not exist" 1>&2
 		false
diff -Nur portage-2.1_pre5/bin/ebuild.sh portage-2.1_pre5-r2/bin/ebuild.sh
--- portage-2.1_pre5/bin/ebuild.sh	2006-02-20 17:20:37.000000000 -0800
+++ portage-2.1_pre5-r2/bin/ebuild.sh	2006-03-01 19:26:00.000000000 -0800
@@ -727,6 +727,11 @@
 }
 
 dyn_clean() {
+	if [ -z "${PORTAGE_BUILDDIR}" ]; then
+		echo "Aborting clean phase because PORTAGE_BUILDDIR is unset!"
+		return 1
+	fi
+
 	if [ "$USERLAND" == "BSD" ] && type -p chflags &>/dev/null; then
 		chflags -R noschg,nouchg,nosappnd,nouappnd,nosunlnk,nouunlnk \
 			"${PORTAGE_BUILDDIR}"
diff -Nur portage-2.1_pre5/bin/emerge portage-2.1_pre5-r2/bin/emerge
--- portage-2.1_pre5/bin/emerge	2006-02-20 16:58:13.000000000 -0800
+++ portage-2.1_pre5-r2/bin/emerge	2006-02-26 03:39:28.000000000 -0800
@@ -1934,7 +1934,7 @@
 			y=portage.portdb.findname(x[pkgindex])
 			if not "--pretend" in myopts:
 				print ">>> Emerging ("+str(mergecount)+" of "+str(len(mymergelist))+")",x[pkgindex],"to",x[1]
-				emergelog(" >>> Emerging ("+str(mergecount)+" of "+str(len(mymergelist))+") "+x[pkgindex]+" to "+x[1])
+				emergelog(" >>> emerge ("+str(mergecount)+" of "+str(len(mymergelist))+") "+x[pkgindex]+" to "+x[1])
 
 			self.pkgsettings["EMERGE_FROM"] = x[0][:]
 			self.pkgsettings.backup_changes("EMERGE_FROM")
diff -Nur portage-2.1_pre5/pym/portage_locks.py portage-2.1_pre5-r2/pym/portage_locks.py
--- portage-2.1_pre5/pym/portage_locks.py	2006-02-15 10:36:48.000000000 -0800
+++ portage-2.1_pre5-r2/pym/portage_locks.py	2006-02-26 03:39:05.000000000 -0800
@@ -122,7 +122,8 @@
 			raise
 
 		
-	if type(lockfilename) == types.StringType and os.fstat(myfd).st_nlink != 1:
+	if type(lockfilename) == types.StringType and \
+		myfd != HARDLINK_FD and os.fstat(myfd).st_nlink != 1:
 		# The file was deleted on us... Keep trying to make one...
 		os.close(myfd)
 		portage_util.writemsg("lockfile recurse\n",1)
diff -Nur portage-2.1_pre5/pym/portage.py portage-2.1_pre5-r2/pym/portage.py
--- portage-2.1_pre5/pym/portage.py	2006-02-21 02:01:08.000000000 -0800
+++ portage-2.1_pre5-r2/pym/portage.py	2006-03-01 19:30:24.000000000 -0800
@@ -4,7 +4,7 @@
 # $Id: 2.1_pre5-r2.patch,v 1.1 2006/03/02 04:07:12 zmedico Exp $
 
 
-VERSION="2.1_pre5"
+VERSION="2.1_pre5-r2"
 
 # ===========================================================================
 # START OF IMPORTS -- START OF IMPORTS -- START OF IMPORTS -- START OF IMPORT
@@ -5334,6 +5334,8 @@
 		return 1
 
 	def update_ents(self, update_iter):
+		if len(update_iter) == 0:
+			return
 		if not self.populated:
 			self.populate()
 
