#! /sbin/runscript
# Copyright 1999-2004 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# $Header: /var/cvsroot/gentoo-x86/sys-apps/sal-client/files/sal-client-init,v 1.3 2004/07/15 00:50:53 agriffis Exp $

# NB: Config is in /etc/conf.d/auditd

depend() {
	use net
}

start() {
	ebegin "Starting auditd"
	
	# forcibly delete the temporary files if needed
  	if [ -e $TMP_DIR ]; then
		rm -rf $TMP_DIR/*
	fi

	start-stop-daemon --start --quiet --exec /usr/sbin/auditd -- ${AUDITD_OPTS} &
	/bin/pidof auditd > /var/run/auditd.pid
	eend $? "Failed to start auditd"
				
}

stop() {
	ebegin "Stopping auditd"
	/bin/killall -s9 auditd
	eend $? "Failed to stop auditd"
}
