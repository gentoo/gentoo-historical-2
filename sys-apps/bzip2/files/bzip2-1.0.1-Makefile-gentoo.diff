--- Makefile-libbz2_so.orig	Tue Feb 27 14:54:55 2001
+++ Makefile-libbz2_so	Tue Feb 27 14:55:42 2001
@@ -8,7 +8,7 @@
 SHELL=/bin/sh
 CC=gcc
 BIGFILES=-D_FILE_OFFSET_BITS=64
-CFLAGS=-fpic -fPIC -Wall -Winline -O2 -fomit-frame-pointer -fno-strength-reduce $(BIGFILES)
+CFLAGS+=-fpic -fPIC -Wall -Winline -fomit-frame-pointer -fno-strength-reduce $(BIGFILES)
 
 OBJS= blocksort.o  \
       huffman.o    \
@@ -24,6 +24,15 @@
 	rm -f libbz2.so.1.0
 	ln -s libbz2.so.1.0.1 libbz2.so.1.0
 
+PREFIX=/usr
+DESTDIR=
+
+install: all
+	if ( test ! -d $(DESTDIR)/$(PREFIX)/lib ) ; then install -d $(DESTDIR)/$(PREFIX)/lib ; fi
+	cp -f libbz2.so.1.0.1 $(DESTDIR)/$(PREFIX)/lib
+	ln -sf libbz2.so.1.0.1 $(DESTDIR)/$(PREFIX)/lib/libbz2.so.1.0
+	ln -sf libbz2.so.1.0.1 $(DESTDIR)/$(PREFIX)/lib/libbz2.so
+
 clean: 
 	rm -f $(OBJS) bzip2.o libbz2.so.1.0.1 libbz2.so.1.0 bzip2-shared
 
@@ -41,3 +50,5 @@
 	$(CC) $(CFLAGS) -c decompress.c
 bzlib.o: bzlib.c
 	$(CC) $(CFLAGS) -c bzlib.c
+
+
--- Makefile.orig	Tue Feb 27 14:54:55 2001
+++ Makefile	Tue Feb 27 14:54:55 2001
@@ -2,7 +2,7 @@
 SHELL=/bin/sh
 CC=gcc
 BIGFILES=-D_FILE_OFFSET_BITS=64
-CFLAGS=-Wall -Winline -O2 -fomit-frame-pointer -fno-strength-reduce $(BIGFILES)
+CFLAGS+=-Wall -Winline -fomit-frame-pointer -fno-strength-reduce $(BIGFILES)
 
 OBJS= blocksort.o  \
       huffman.o    \
@@ -46,27 +46,27 @@
 	@cat words3
 
 PREFIX=/usr
+DESTDIR=
 
 install: bzip2 bzip2recover
-	if ( test ! -d $(PREFIX)/bin ) ; then mkdir $(PREFIX)/bin ; fi
-	if ( test ! -d $(PREFIX)/lib ) ; then mkdir $(PREFIX)/lib ; fi
-	if ( test ! -d $(PREFIX)/man ) ; then mkdir $(PREFIX)/man ; fi
-	if ( test ! -d $(PREFIX)/man/man1 ) ; then mkdir $(PREFIX)/man/man1 ; fi
-	if ( test ! -d $(PREFIX)/include ) ; then mkdir $(PREFIX)/include ; fi
-	cp -f bzip2 $(PREFIX)/bin/bzip2
-	cp -f bzip2 $(PREFIX)/bin/bunzip2
-	cp -f bzip2 $(PREFIX)/bin/bzcat
-	cp -f bzip2recover $(PREFIX)/bin/bzip2recover
-	chmod a+x $(PREFIX)/bin/bzip2
-	chmod a+x $(PREFIX)/bin/bunzip2
-	chmod a+x $(PREFIX)/bin/bzcat
-	chmod a+x $(PREFIX)/bin/bzip2recover
-	cp -f bzip2.1 $(PREFIX)/man/man1
-	chmod a+r $(PREFIX)/man/man1/bzip2.1
-	cp -f bzlib.h $(PREFIX)/include
-	chmod a+r $(PREFIX)/include/bzlib.h
-	cp -f libbz2.a $(PREFIX)/lib
-	chmod a+r $(PREFIX)/lib/libbz2.a
+	if ( test ! -d $(DESTDIR)/$(PREFIX)/bin ) ; then install -d $(DESTDIR)/$(PREFIX)/bin ; fi
+	if ( test ! -d $(DESTDIR)/$(PREFIX)/lib ) ; then install -d $(DESTDIR)/$(PREFIX)/lib ; fi
+	if ( test ! -d $(DESTDIR)/$(PREFIX)/share/man/man1 ) ; then install -d $(DESTDIR)/$(PREFIX)/share/man/man1 ; fi
+	if ( test ! -d $(DESTDIR)/$(PREFIX)/include ) ; then install -d $(DESTDIR)/$(PREFIX)/include ; fi
+	cp -f bzip2 $(DESTDIR)/$(PREFIX)/bin/bzip2
+	cp -f bzip2 $(DESTDIR)/$(PREFIX)/bin/bunzip2
+	cp -f bzip2 $(DESTDIR)/$(PREFIX)/bin/bzcat
+	cp -f bzip2recover $(DESTDIR)/$(PREFIX)/bin/bzip2recover
+	chmod a+x $(DESTDIR)/$(PREFIX)/bin/bzip2
+	chmod a+x $(DESTDIR)/$(PREFIX)/bin/bunzip2
+	chmod a+x $(DESTDIR)/$(PREFIX)/bin/bzcat
+	chmod a+x $(DESTDIR)/$(PREFIX)/bin/bzip2recover
+	cp -f bzip2.1 $(DESTDIR)/$(PREFIX)/share/man/man1
+	chmod a+r $(DESTDIR)/$(PREFIX)/share/man/man1/bzip2.1
+	cp -f bzlib.h $(DESTDIR)/$(PREFIX)/include
+	chmod a+r $(DESTDIR)/$(PREFIX)/include/bzlib.h
+	cp -f libbz2.a $(DESTDIR)/$(PREFIX)/lib
+	chmod a+r $(DESTDIR)/$(PREFIX)/lib/libbz2.a
 
 clean: 
 	rm -f *.o libbz2.a bzip2 bzip2recover \
