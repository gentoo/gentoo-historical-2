diff -u ../../../lm_sensors-2.10.7.orig/prog/detect/sensors-detect ./sensors-detect
--- ../../../lm_sensors-2.10.7.orig/prog/detect/sensors-detect	2008-07-19 10:26:32.000000000 +0200
+++ ./sensors-detect	2008-07-19 11:01:16.000000000 +0200
@@ -27,6 +27,9 @@
 # each be put in a separate file, using modules and packages. That is beyond
 # me.
 
+# Gentoo specific modifications based on a patch from Rudo Thomas
+# <thomr9am@ss1000.ms.mff.cuni.cz>
+
 require 5.004;
 
 use strict;
@@ -5899,29 +5902,40 @@
       print MODPROBE_D $configfile;
       close(MODPROBE_D);
     } else {
+      print "\nIf you want to load the modules at startup, generate a config file\n",
+            "below and make sure lm_sensors gets started at boot time; e.g\n",
+            "\$ rc-update add lm_sensors default\n";
       print "To make the sensors modules behave correctly, add these lines to\n".
-            "$modules_conf:\n\n";
+            "/etc/modules.d/lm_sensors and run update-modules:\n\n";
       print "#----cut here----\n".
             $configfile.
             "#----cut here----\n\n";
     }
   }
 
-  my $have_sysconfig = -d '/etc/sysconfig';
-  printf "Do you want to \%s /etc/sysconfig/lm_sensors? (\%s): ",
-         (-e '/etc/sysconfig/lm_sensors' ? 'overwrite' : 'generate'),
+  print "To load everything that is needed, execute the commands below...";
+
+  print "\n\n#----cut here----\n";
+  print $modprobes;
+  print "# sleep 2 # optional\n",
+        "/usr/bin/sensors -s # recommended\n";
+  print "#----end cut here----\n";
+
+  my $have_sysconfig = -f '/etc/conf.d/lm_sensors';
+  printf "Do you want to \%s /etc/conf.d/lm_sensors? Enter s for other filename (\%s/s): ",
+         ($have_sysconfig ? 'overwrite' : 'generate'),
          ($have_sysconfig ? 'YES/no' : 'yes/NO');
   $_ = <STDIN>;
-  if (($have_sysconfig and not m/^\s*n/i) or m/^\s*y/i) {
-    unless ($have_sysconfig) {
-      mkdir '/etc/sysconfig', 0777
-        or die "Sorry, can't create /etc/sysconfig ($!)";
+  if (m/^\s*s/i or ($have_sysconfig and not m/^\s*n/i) or m/^\s*y/i) {
+    my $filename = '/etc/conf.d/lm_sensors';
+    if (m/^\s*s/i) {
+      print "Specify the file to store the configuration to: ";
+      $filename = <STDIN>;
     }
-    open(local *SYSCONFIG, ">/etc/sysconfig/lm_sensors")
-      or die "Sorry, can't create /etc/sysconfig/lm_sensors ($!)";
+    open(local *SYSCONFIG, ">$filename")
+      or die "Sorry, can't create $filename ($!)";
     print SYSCONFIG <<'EOT';
-#    /etc/sysconfig/lm_sensors - Defines modules loaded by
-#                                /etc/init.d/lm_sensors
+#    /etc/conf.d/sensors - Defines modules loaded by /etc/init.d/lm_sensors
 #    Copyright (c) 1998 - 2001  Frodo Looijaard <frodol@dds.nl>
 #
 #    This program is free software; you can redistribute it and/or modify
@@ -5950,12 +5964,21 @@
 # in order as normal variables with the special names:
 #    MODULE_0, MODULE_1, MODULE_2, etc.
 #
+# Please note that the numbers in MODULE_X must start at 0 and increase in
+# steps of 1. Any number that is missing will make the init script skip the
+# rest of the modules. Use MODULE_X_ARGS for arguments.
+#
 # List the modules that are to be loaded for your system
 #
 EOT
     print SYSCONFIG
       "# Generated by sensors-detect on " . scalar localtime() . "\n";
     my @modules = grep /^modprobe /, split "\n", $modprobes;
+    print SYSCONFIG
+         "# Load modules at startup\n".
+         "LOADMODULES=yes\n\n".
+         "# Initialize sensors at startup\n".
+         "INITSENSORS=yes\n\n";
     my $i = 0;
     my $sysconfig = "";
     foreach (@modules) {
@@ -5966,9 +5989,7 @@
     print SYSCONFIG $sysconfig;
     close(SYSCONFIG);
 
-    print "Copy prog/init/lm_sensors.init to /etc/init.d/lm_sensors\n".
-          "for initialization at boot time.\n"
-      unless -f "/etc/init.d/lm_sensors";
+    print "Done.\n";
 
     if (-x "/sbin/insserv" && -f "/etc/init.d/lm_sensors") {
       system("/sbin/insserv", "/etc/init.d/lm_sensors");
