diff -ur iproute2-2.6.7.orig/lib/ll_addr.c iproute2-2.6.7/lib/ll_addr.c
--- iproute2-2.6.7.orig/lib/ll_addr.c	2004-06-22 15:23:26.671351840 -0400
+++ iproute2-2.6.7/lib/ll_addr.c	2004-06-22 15:24:05.193495584 -0400
@@ -17,10 +17,10 @@
 #include <sys/ioctl.h>
 #include <sys/socket.h>
 #include <sys/ioctl.h>
+#include <netinet/in.h>
 #include <linux/netdevice.h>
 #include <linux/if_arp.h>
 #include <linux/sockios.h>
-#include <netinet/in.h>
 #include <arpa/inet.h>
 #include <string.h>
 
diff -ur iproute2-2.6.7.orig/lib/ll_proto.c iproute2-2.6.7/lib/ll_proto.c
--- iproute2-2.6.7.orig/lib/ll_proto.c	2004-06-22 15:23:26.671351840 -0400
+++ iproute2-2.6.7/lib/ll_proto.c	2004-06-22 15:23:55.268004488 -0400
@@ -17,10 +17,10 @@
 #include <sys/ioctl.h>
 #include <sys/socket.h>
 #include <sys/ioctl.h>
+#include <netinet/in.h>
 #include <linux/netdevice.h>
 #include <linux/if_arp.h>
 #include <linux/sockios.h>
-#include <netinet/in.h>
 #include <arpa/inet.h>
 #include <string.h>
 
diff -ur iproute2-2.6.7.orig/lib/ll_types.c iproute2-2.6.7/lib/ll_types.c
--- iproute2-2.6.7.orig/lib/ll_types.c	2004-06-22 15:23:26.671351840 -0400
+++ iproute2-2.6.7/lib/ll_types.c	2004-06-22 15:23:42.533940360 -0400
@@ -17,10 +17,10 @@
 #include <sys/ioctl.h>
 #include <sys/socket.h>
 #include <sys/ioctl.h>
+#include <netinet/in.h>
 #include <linux/netdevice.h>
 #include <linux/if_arp.h>
 #include <linux/sockios.h>
-#include <netinet/in.h>
 #include <arpa/inet.h>
 #include <string.h>
 
diff -ur iproute2-2.6.7.orig/ip/ipaddress.c iproute2-2.6.7/ip/ipaddress.c
--- iproute2-2.6.7.orig/ip/ipaddress.c	2004-06-22 15:26:00.353988528 -0400
+++ iproute2-2.6.7/ip/ipaddress.c	2004-06-22 15:26:11.743257096 -0400
@@ -20,10 +20,10 @@
 #include <sys/ioctl.h>
 #include <sys/socket.h>
 #include <sys/ioctl.h>
+#include <netinet/in.h>
 #include <linux/netdevice.h>
 #include <linux/if_arp.h>
 #include <linux/sockios.h>
-#include <netinet/in.h>
 #include <arpa/inet.h>
 #include <string.h>
 #include <fnmatch.h>
diff -ur iproute2-2.6.7.orig/misc/ss.c iproute2-2.6.7/misc/ss.c
--- iproute2-2.6.7.orig/misc/ss.c	2004-06-22 15:26:00.414979256 -0400
+++ iproute2-2.6.7/misc/ss.c	2004-06-22 15:26:30.166456344 -0400
@@ -35,6 +35,7 @@
 #include <asm/byteorder.h>
 #include <linux/tcp.h>
 #include <linux/tcp_diag.h>
+#include <linux/version.h>
 
 int resolve_hosts = 0;
 int resolve_services = 1;
@@ -1318,11 +1319,14 @@
 		if (info->tcpi_snd_ssthresh < 0xFFFF)
 			printf(" ssthresh:%d", info->tcpi_snd_ssthresh);
 		
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,6)
 		if (info->tcpi_rcv_rtt)
 			printf(" rcv_rtt:%g", (double) info->tcpi_rcv_rtt/1000);
 		if (info->tcpi_rcv_space)
 			printf(" rcv_space:%d", info->tcpi_rcv_space);
+#endif
 
+#ifdef TCPDIAG_VEGASINFO
 		if (tb[TCPDIAG_VEGASINFO]) {
 			const struct tcpvegas_info *vinfo
 				= RTA_DATA(tb[TCPDIAG_VEGASINFO]);
@@ -1340,6 +1341,7 @@
 				       8000000. / (double) vinfo->tcpv_rtt);
 			}
 		}
+#endif
 	}
 }
 
diff -ur iproute2-2.6.7.orig/ip/ipmaddr.c iproute2-2.6.7/ip/ipmaddr.c
--- iproute2-2.6.7.orig/ip/ipmaddr.c	2004-06-22 15:27:35.910461736 -0400
+++ iproute2-2.6.7/ip/ipmaddr.c	2004-06-22 15:28:30.871106448 -0400
@@ -17,11 +17,11 @@
 #include <fcntl.h>
 #include <sys/ioctl.h>
 #include <sys/socket.h>
+#include <netinet/in.h>
 #include <linux/netdevice.h>
 #include <linux/if.h>
 #include <linux/if_arp.h>
 #include <linux/sockios.h>
-#include <netinet/in.h>
 #include <arpa/inet.h>
 #include <string.h>
 
diff -ur iproute2-2.6.7.orig/ip/ipmroute.c iproute2-2.6.7/ip/ipmroute.c
--- iproute2-2.6.7.orig/ip/ipmroute.c	2004-06-22 15:27:35.912461432 -0400
+++ iproute2-2.6.7/ip/ipmroute.c	2004-06-22 15:28:55.027434128 -0400
@@ -17,11 +17,11 @@
 #include <fcntl.h>
 #include <sys/ioctl.h>
 #include <sys/socket.h>
+#include <netinet/in.h>
 #include <linux/netdevice.h>
 #include <linux/if.h>
 #include <linux/if_arp.h>
 #include <linux/sockios.h>
-#include <netinet/in.h>
 #include <arpa/inet.h>
 #include <string.h>
 
