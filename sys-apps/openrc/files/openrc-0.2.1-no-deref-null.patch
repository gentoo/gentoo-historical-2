From: DragonK <dragonk@gmail.com>
Date: Sun, 6 Apr 2008 13:21:42 +0000 (+0100)
Subject: p could be null here.
X-Git-Url: http://git.overlays.gentoo.org/gitweb/?p=proj%2Fopenrc.git;a=commitdiff_plain;h=f183081181319271bad39cb00ff2970dc4a4ae42

p could be null here.
---

diff --git a/src/rc/rc-applets.c b/src/rc/rc-applets.c
index 70f3a04..d434be4 100644
--- a/src/rc/rc-applets.c
+++ b/src/rc/rc-applets.c
@@ -110,7 +110,7 @@ static int do_e(int argc, char **argv)
 		} else if (strcmp(applet, "esyslog") == 0 ||
 			   strcmp(applet, "elog") == 0) {
 			p = strchr(argv[0], '.');
-			if ((level = syslog_decode(p + 1, prioritynames)) == -1)
+			if (!p || (level = syslog_decode(p + 1, prioritynames)) == -1)
 				eerrorx("%s: invalid log level `%s'", applet, argv[0]);
 
 			if (argc < 3)
