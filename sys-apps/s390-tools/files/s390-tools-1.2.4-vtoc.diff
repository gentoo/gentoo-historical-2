--- ./fdasd/Makefile.orig
+++ ./fdasd/Makefile
@@ -1,33 +1,19 @@
 # Include common definitions
 include ../common.mak
 
-CFLAGS        = -Wall
-LDFLAGS       = -L. -lvtoc
-
-SRCS          = fdasd.c
-LIBSRC        = vtoc.c
-LIBOBJ        = vtoc.o
+CFLAGS        = -Os -fomit-frame-pointer -Wall
 
 all: fdasd
 
-fdasd: libvtoc.so fdasd.c fdasd.h
-	$(CC) $(CFLAGS) $(LDFLAGS) -o fdasd $(SRCS)
-
-libvtoc.so: vtoc.c
-	$(CC) $(CFLAGS) -c -fpic $(LIBSRC) -o $(LIBOBJ)
-	$(CC) -Wall -shared $(LIBOBJ) -o libvtoc.so -W1,-soname=libvtoc.so.1
+fdasd: fdasd.c vtoc.o
+	$(CC) $(CFLAGS) -o fdasd $^
 
-install: libinstall
+install:
 	$(INSTALL) -d -m 755 $(BINDIR) $(MANDIR)/man8
 	$(STRIP) fdasd
 	$(INSTALL) -g $(GROUP) -o $(OWNER) -m 700 fdasd $(BINDIR)
 	$(INSTALL) -g $(GROUP) -o $(OWNER) -m 644 fdasd.8  $(MANDIR)/man8 
 
-libinstall:
-	$(INSTALL) -d -m 755 $(LIBDIR)
-	$(INSTALL) -g $(GROUP) -o $(OWNER) libvtoc.so $(LIBDIR)
-#	ldconfig
-
 clean:
 	rm -f *.o *.so *~ fdasd core
 
--- ./dasdfmt/Makefile.orig	2004-04-07 15:04:23.000000000 +0000
+++ ./dasdfmt/Makefile	2004-04-07 15:05:22.000000000 +0000
@@ -2,7 +2,6 @@
 include ../common.mak
 
 CFLAGS  = -O2 -Wall
-LDFLAGS = -lvtoc
 
 default: dasdfmt
 
@@ -17,5 +16,5 @@
 	$(INSTALL) -g $(GROUP) -o $(OWNER) -m 700 dasdfmt   $(BINDIR)
 	$(INSTALL) -g $(GROUP) -o $(OWNER) -m 644 dasdfmt.8 $(MANDIR)/man8 
 
-dasdfmt: dasdfmt.c dasdfmt.h vtoc.h
-	$(CC) $(CFLAGS) $(LDFLAGS) -o dasdfmt dasdfmt.c
+dasdfmt: dasdfmt.c dasdfmt.h vtoc.h ../fdasd/vtoc.o
+	$(CC) $(CFLAGS) -o dasdfmt dasdfmt.c ../fdasd/vtoc.o
--- ./dasdview/Makefile.orig	2004-04-07 15:05:02.000000000 +0000
+++ ./dasdview/Makefile	2004-04-07 15:05:44.000000000 +0000
@@ -2,7 +2,6 @@
 include ../common.mak
 
 CFLAGS  = -Wall -O2
-LDFLAGS = -lvtoc
 
 default: dasdview
 
@@ -17,5 +16,5 @@
 	$(INSTALL) -g $(GROUP) -o $(OWNER) -m 700 dasdview   $(BINDIR)
 	$(INSTALL) -g $(GROUP) -o $(OWNER) -m 644 dasdview.8 $(MANDIR)/man8 
 
-dasdview: dasdview.c
-	$(CC) $(CFLAGS) $(LDFLAGS) -o dasdview dasdview.c
+dasdview: dasdview.c ../fdasd/vtoc.o
+	$(CC) $(CFLAGS) -o dasdview dasdview.c ../fdasd/vtoc.o
