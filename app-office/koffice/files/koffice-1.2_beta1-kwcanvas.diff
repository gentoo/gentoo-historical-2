--- kwcanvas.cc	2002/04/17 11:30:35	1.336
+++ kwcanvas.cc	2002/04/22 19:19:12	1.337
@@ -1256,13 +1256,14 @@ void KWCanvas::mrCreateTable()
 KWTableFrameSet * KWCanvas::createTable() // uses m_insRect and m_table to create the table
 {
     KWTableFrameSet *table = new KWTableFrameSet( m_doc, QString::null /*automatic name*/ );
+    int pageNum = static_cast<int>(m_insRect.y() / m_doc->ptPaperHeight());

     // Create a set of cells with random-size frames.
     for ( unsigned int i = 0; i < m_table.rows; i++ ) {
         for ( unsigned int j = 0; j < m_table.cols; j++ ) {
             KWTableFrameSet::Cell *cell = new KWTableFrameSet::Cell( table, i, j, QString::null /*automatic name*/ );
             KWFrame *frame = new KWFrame(cell, 0, 0, 0, 0, KWFrame::RA_NO ); // pos and size will be set in setBoundingRect
-            // Wrong page! frame->setZOrder( m_doc->maxZOrder( frame->pageNum(m_doc) ) + 1 ); // make sure it's on top
+            frame->setZOrder( m_doc->maxZOrder( pageNum ) + 1 ); // make sure it's on top
             cell->addFrame( frame, false );
             frame->setFrameBehavior(KWFrame::AutoExtendFrame);
             frame->setNewFrameBehavior(KWFrame::NoFollowup);
