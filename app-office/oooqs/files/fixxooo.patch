diff -ru oooqs-2.0.3/src/oooqs.cpp oooqs-2.0.3-fixed/src/oooqs.cpp
--- oooqs-2.0.3/src/oooqs.cpp	2005-06-01 20:08:30.000000000 +0300
+++ oooqs-2.0.3-fixed/src/oooqs.cpp	2005-06-01 20:07:55.000000000 +0300
@@ -3,6 +3,7 @@
 */
 
 #include <qdir.h>
+#include <qfile.h>
 #include <qmap.h>
 
 #include <kaboutdata.h>
@@ -44,21 +45,36 @@
 	*/
 	KPopupMenu* menu = contextMenu();
 
-	( new KAction( i18n( "Textdocument" ),
-	               "ooo_writer", 0, this,
-	               SLOT( startWriter() ), this ) ) ->plug( menu );
-	( new KAction( i18n( "Spreadsheet" ),
-	               "ooo_calc", 0, this,
-	               SLOT( startCalc() ), this ) ) ->plug( menu );
-	( new KAction( i18n( "Presentation" ),
-	               "ooo_impress", 0, this,
-	               SLOT( startImpress() ), this ) ) ->plug( menu );
-	( new KAction( i18n( "Drawing" ),
-	               "ooo_draw", 0, this,
-	               SLOT( startDraw() ), this ) ) ->plug( menu );
-	( new KAction( i18n( "From Template" ),
-	               "wizard", 0, this,
-	               SLOT( startTemplate() ), this ) ) ->plug( menu );
+	if ( QFile::exists( QDir::homeDirPath() + QDir::separator() + ".xversionrc" ) ) {
+		( new KAction( i18n( "Textdocument" ),
+		               "ximian-openoffice-writer", 0, this,
+		               SLOT( startWriter() ), this ) ) ->plug( menu );
+		( new KAction( i18n( "Spreadsheet" ),
+		               "ximian-openoffice-calc", 0, this,
+		               SLOT( startCalc() ), this ) ) ->plug( menu );
+		( new KAction( i18n( "Presentation" ),
+		               "ximian-openoffice-impress", 0, this,
+		               SLOT( startImpress() ), this ) ) ->plug( menu );
+		( new KAction( i18n( "Drawing" ),
+		               "ximian-openoffice-draw", 0, this,
+		               SLOT( startDraw() ), this ) ) ->plug( menu );
+		} else {
+		( new KAction( i18n( "Textdocument" ),
+		               "ooo_writer", 0, this,
+		               SLOT( startWriter() ), this ) ) ->plug( menu );
+		( new KAction( i18n( "Spreadsheet" ),
+		               "ooo_calc", 0, this,
+		               SLOT( startCalc() ), this ) ) ->plug( menu );
+		( new KAction( i18n( "Presentation" ),
+		               "ooo_impress", 0, this,
+		               SLOT( startImpress() ), this ) ) ->plug( menu );
+		( new KAction( i18n( "Drawing" ),
+		               "ooo_draw", 0, this,
+		               SLOT( startDraw() ), this ) ) ->plug( menu );
+		}
+		( new KAction( i18n( "From Template" ),
+		               "wizard", 0, this,
+		               SLOT( startTemplate() ), this ) ) ->plug( menu );
 	menu->insertSeparator();
 	( new KAction( i18n( "Open Document" ),
 	               "fileopen", 0, this,
@@ -92,9 +108,15 @@
 	Try to autodetect settings if they aren't found in our own config.
 	*/
 	if ( _exec.length() < 2 ) {
-		oooConfig = new KSimpleConfig(
-		                QDir::homeDirPath() + QDir::separator()
-		                + ".sversionrc", true );
+		if ( QFile::exists( QDir::homeDirPath() + QDir::separator() + ".xversionrc" ) ) {
+			oooConfig = new KSimpleConfig(
+				QDir::homeDirPath() + QDir::separator()
+				+ ".xversionrc", true );
+			} else {
+			oooConfig = new KSimpleConfig(
+				QDir::homeDirPath() + QDir::separator()
+				+ ".sversionrc", true );
+		}
 		oooConfig->setGroup( "Versions" );
 		versions = oooConfig->entryMap( "Versions" );
 		/**
