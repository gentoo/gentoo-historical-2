--- nessus-core/nessus/prelude_output_orig.c	2003-07-21 09:16:58.000000000 +0800
+++ nessus-core/nessus/prelude_output.c	2003-07-23 00:07:29.000000000 +0800
@@ -612,7 +612,8 @@
                 class->origin = cve;
                 idmef_string_set(&class->name, ref_cve);
 
-                len += strlen(ref_cve) + 1;
+                /* len += strlen(ref_cve) + 1; */
+		len = strlen(ref_cve) + strlen(CVE_URL) + 1;
                 cve_url = malloc(len);
                 if ( ! cve_url ) {
                         if ( usage & OPT_KB_SRC )
@@ -621,7 +622,7 @@
                 }
 
                 sprintf(cve_url, "%s%s", CVE_URL, ref_cve);
-                cve_url[len] = '\0';
+                cve_url[len-1] = '\0';
 
                 idmef_string_set(&class->url, cve_url);
 
