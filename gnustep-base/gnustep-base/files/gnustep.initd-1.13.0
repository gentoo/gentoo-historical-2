#!/sbin/runscript
# Copyright 1999-2006 Gentoo Technologies, Inc.
# Distributed under the terms of the GNU General Public License, v2 or later
# $Header: /var/cvsroot/gentoo-x86/gnustep-base/gnustep-base/files/gnustep.initd-1.13.0,v 1.1 2006/12/05 19:51:34 grobian Exp $

if [ -e /etc/GNUstep/GNUstep.conf ] ; then
	. /etc/GNUstep/GNUstep.conf
else
	GNUSTEP_SYSTEM_ROOT="/usr/GNUstep/System"
fi

start() {
	ebegin "Starting GNUstep services"

	# Check for necessary files
	if [ -d ${GNUSTEP_SYSTEM_ROOT}/Library/Makefiles ] ; then
		# Source GNUstep makefile
		. ${GNUSTEP_SYSTEM_ROOT}/Library/Makefiles/GNUstep.sh
	else
		eend 1
		return 1
	fi

	if [ -z "$GNUSTEP_FLATTENED" ] ; then
		TDIR=${GNUSTEP_SYSTEM_ROOT}/Tools/${GNUSTEP_HOST_CPU}/${GNUSTEP_HOST_OS}
	else
		TDIR=${GNUSTEP_SYSTEM_ROOT}/Tools
	fi

	# Start services
	eindent

	if [ -x ${TDIR}/gdomap ] ; then
		ebegin "starting gdomap"
		${TDIR}/gdomap
		eend $?
	fi
	if [ -x ${TDIR}/$LIBRARY_COMBO/gdnc ] ; then
		ebegin "starting gdnc"
		${TDIR}/$LIBRARY_COMBO/gdnc
		eend $?
	fi

	eoutdent
}

stop() {
	ebegin "Killing GNUstep services"

	# Kill processes
	killall gdomap >& /dev/null
	killall gdnc >& /dev/null

	# always succeeds
	eend 0
}
