#!/bin/sh
#
# AppleTalk daemons. Make sure not to start atalkd in the background:
# its data structures must have time to stablize before running the
# other processes.
#RCUPDATE:3 4:75:

#
# SUNOS: UNCOMMENT THESE LINES TO LOAD THE KERNEL MODULE.  Note that
# modunload-ing netatalk may cause your machine to panic or hang.
#

  . /etc/rc.d/config/functions

SERVICE="Appletalk"
opts="start stop restart"

start () {

	ebegin "Starting $SERVICE daemons:"

	start-stop-daemon --start --quiet --exec /usr/sbin/atalkd 1>&2
	echo ' atalkd'

	/usr/bin/nbprgstr -p 4 `hostname|sed 's/\..*$//'`:Workstation
	/usr/bin/nbprgstr -p 4 `hostname|sed 's/\..*$//'`:netatalk
	echo ' nbprgstr'

	start-stop-daemon --start --quiet --exec /usr/sbin/papd 1>&2
	echo ' papd'

	start-stop-daemon --start --quiet --exec /usr/sbin/afpd 1>&2
	echo ' afpd'

	eend $? "Error starting $SERVICE daemons"

}


stop () {

	ebegin "Stopping $SERVICE daemons:"
	start-stop-daemon --stop --quiet --exec /usr/sbin/papd 1>&2
	echo " papd"
	start-stop-daemon --stop --quiet --exec /usr/sbin/afpd 1>&2
	echo " afpd"
	start-stop-daemon --stop --quiet --exec /usr/sbin/atalkd 1>&2
	echo " atalkd"
	eend $? "Error Stopping $SERVICE daemons:"
}

restart() {
	stop
	start
}

doservice ${@}


