# this is an idea for maintaining trivial config file stubs
config_install() {

for x in smbd nmbd
do
	dodir /var/lib/supervise/services/${x}/log
	chmod +t ${D}var/lib/supervise/services/${x}

# install svc-run stub - pretty lame eh
rm -f ${T}/config.config
cat > ${T}/config.config <<EOF
#!/bin/sh
mypid=\`pidof /usr/sbin/${x}\`
if [ -z "\$mypid" ] ; then
	/usr/sbin/${x} -l ./log/logfifo
	sleep 2
	mypid=\`pidof /usr/sbin/${x}\`
fi
exec /usr/bin/watchpid $mypid
EOF
	exeinto /var/lib/supervise/services/${x}
	newexe ${T}/config.config run


# install svc-log stub
rm -f ${T}/config.config
cat > ${T}/config.config <<EOF
#!/bin/sh
if [ ! -p logfifo ] ; then
	rm -f logfifo
	mknod logfifo p
fi
exec multilog t ./${x}-log < logfifo
EOF
	exeinto /var/lib/supervise/services/${x}/log
	newexe ${T}/config.config run


done
}
