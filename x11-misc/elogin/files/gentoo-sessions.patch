--- data/config/build_config.sh.orig	2003-01-21 13:28:48.000000000 -0500
+++ data/config/build_config.sh	2003-03-01 00:28:53.000000000 -0500
@@ -1,4 +1,4 @@
-#!/bin/sh -e
+#!/bin/bash
 DB="./elogin_config.db"
 rm $DB
 edb_ed $DB add /elogin/welcome/mess str "Enter Your Username"
@@ -38,22 +38,14 @@
 edb_ed $DB add /elogin/xinerama/screens/h int 1
 edb_ed $DB add /elogin/xinerama/on/w int 1
 edb_ed $DB add /elogin/xinerama/on/h int 1
-edb_ed $DB add /elogin/session/0/name str "E17"
-edb_ed $DB add /elogin/session/0/path str "/usr/local/e17/bin/enlightenment"
-edb_ed $DB add /elogin/session/1/name str "Enlightenment"
-edb_ed $DB add /elogin/session/1/path str "/usr/bin/enlightenment"
-edb_ed $DB add /elogin/session/2/name str "KDE"
-edb_ed $DB add /elogin/session/2/path str ""
-edb_ed $DB add /elogin/session/3/name str "GNOME"
-edb_ed $DB add /elogin/session/3/path str ""
-edb_ed $DB add /elogin/session/4/name str "Blackbox"
-edb_ed $DB add /elogin/session/4/path str ""
-edb_ed $DB add /elogin/session/5/name str "Sawfish"
-edb_ed $DB add /elogin/session/5/path str ""
-edb_ed $DB add /elogin/session/6/name str "XFce"
-edb_ed $DB add /elogin/session/6/path str ""
-edb_ed $DB add /elogin/session/7/name str "Failsafe"
-edb_ed $DB add /elogin/session/7/path str "failsafe"
-edb_ed $DB add /elogin/session/8/name str "Default"
-edb_ed $DB add /elogin/session/8/path str "~/.xinitrc"
-edb_ed $DB add /elogin/session/count int 9
+
+local count=-1
+for ses in /etc/X11/Sessions/* ; do
+	let "count++"
+	edb_ed $DB add /elogin/session/${count}/name str "`basename ${ses}`"
+	edb_ed $DB add /elogin/session/${count}/path str "${ses}"
+done
+let "count++"
+edb_ed $DB add /elogin/session/${count}/name str "Failsafe"
+edb_ed $DB add /elogin/session/${count}/path str "/etc/X11/Sessions/Xsession failsafe"
+edb_ed $DB add /elogin/session/count int ${count}
