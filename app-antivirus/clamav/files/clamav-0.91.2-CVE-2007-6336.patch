Thu Dec  6 15:15:45 CET 2007 (tk)
---------------------------------
  * libclamav/mspack.c: fix off-by-one error in LZX_READ_HUFFSYM() (bb#663)

     https://wwws.clamav.net/bugzilla/show_bug.cgi?id=663

     SVN r3374

Index: clamav-0.91.2/libclamav/mspack.c
===================================================================
--- clamav-0.91.2.orig/libclamav/mspack.c
+++ clamav-0.91.2/libclamav/mspack.c
@@ -734,7 +734,7 @@ void mszip_free(struct mszip_stream *zip
 
 #define LZX_ENSURE_BITS(nbits)                                              \
   while (bits_left < (nbits)) {                                         \
-    if (i_ptr >= i_end) {                                               \
+    if (i_ptr + 1 >= i_end) {                                               \
       if (lzx_read_input(lzx)) return lzx->error;                      \
       i_ptr = lzx->i_ptr;                                               \
       i_end = lzx->i_end;                                               \
