diff -bur clamav-0.82/libclamav/special.c clamav-0.82-fixed/libclamav/special.c
--- clamav-0.82/libclamav/special.c	2005-02-05 16:47:47.000000000 +0100
+++ clamav-0.82-fixed/libclamav/special.c	2005-02-13 18:40:08.923297848 +0100
@@ -224,6 +224,12 @@
 		return 0;
 	}
 
+	if (memcmp(&form_type, "ACON", 4) != 0) {
+		/* Only scan MS animated icon files */
+		/* There is a *lot* of broken software out there that produces bad RIFF files */
+		return 0;
+	}
+
 	chunk_size = riff_endian_convert_32(chunk_size, big_endian);
 
 	do {
@@ -234,6 +240,6 @@
 
 	if (offset < chunk_size) {
 		retval = 2;
-	};
+	}
 	return retval;
 }
