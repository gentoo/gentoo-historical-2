diff -rU2 linux-wlan-ng-0.2.7/src/prism2/driver/hfa384x.c linux-wlan-ng-0.2.7.new/src/prism2/driver/hfa384x.c
--- linux-wlan-ng-0.2.7/src/prism2/driver/hfa384x.c	2006-11-10 15:28:33.000000000 +0100
+++ linux-wlan-ng-0.2.7.new/src/prism2/driver/hfa384x.c	2007-04-30 12:47:05.000000000 +0200
@@ -353,7 +353,7 @@
 	skb_queue_head_init(&hw->authq);
 
-	INIT_WORK(&hw->link_bh, prism2sta_processing_defer, hw);
+	INIT_WORK2(&hw->link_bh, prism2sta_processing_defer);
 
-        INIT_WORK(&hw->commsqual_bh, prism2sta_commsqual_defer, hw);
+        INIT_WORK2(&hw->commsqual_bh, prism2sta_commsqual_defer);
 
 	init_timer(&hw->commsqual_timer);
diff -rU2 linux-wlan-ng-0.2.7/src/prism2/driver/hfa384x_usb.c linux-wlan-ng-0.2.7.new/src/prism2/driver/hfa384x_usb.c
--- linux-wlan-ng-0.2.7/src/prism2/driver/hfa384x_usb.c	2006-11-02 16:56:40.000000000 +0100
+++ linux-wlan-ng-0.2.7.new/src/prism2/driver/hfa384x_usb.c	2007-04-30 12:11:57.000000000 +0200
@@ -712,6 +712,6 @@
 	             hfa384x_usbctlx_completion_task,
 	             (unsigned long)hw);
-	INIT_WORK(&hw->link_bh, prism2sta_processing_defer, hw);
-	INIT_WORK(&hw->usb_work, hfa384x_usb_defer, hw);
+	INIT_WORK2(&hw->link_bh, prism2sta_processing_defer);
+	INIT_WORK2(&hw->usb_work, hfa384x_usb_defer);
 
 	init_timer(&hw->throttle);
@@ -734,5 +734,5 @@
 	hw->state = HFA384x_STATE_INIT;
 
-        INIT_WORK(&hw->commsqual_bh, prism2sta_commsqual_defer, hw);
+        INIT_WORK2(&hw->commsqual_bh, prism2sta_commsqual_defer);
 	init_timer(&hw->commsqual_timer);
 	hw->commsqual_timer.data = (unsigned long) hw;
diff -rU2 linux-wlan-ng-0.2.7/src/prism2/driver/prism2sta.c linux-wlan-ng-0.2.7.new/src/prism2/driver/prism2sta.c
--- linux-wlan-ng-0.2.7/src/prism2/driver/prism2sta.c	2006-11-02 16:56:40.000000000 +0100
+++ linux-wlan-ng-0.2.7.new/src/prism2/driver/prism2sta.c	2007-04-30 12:44:37.000000000 +0200
@@ -1439,7 +1439,7 @@
 }
 
-void prism2sta_processing_defer(void *data)
+void prism2sta_processing_defer(struct work_struct *data)
 {
-	hfa384x_t		*hw = (hfa384x_t *) data;
+	hfa384x_t               *hw = container_of(data, struct hfa384x, link_bh);
 	wlandevice_t            *wlandev = hw->wlandev;
 	hfa384x_bytestr32_t ssid;
@@ -1541,5 +1541,5 @@
 
 			/* Get the ball rolling on the comms quality stuff */
-			prism2sta_commsqual_defer(hw);
+			prism2sta_commsqual_defer(&hw->commsqual_bh);
 		}
 		break;
@@ -2414,5 +2414,5 @@
 #endif
 
-void prism2sta_commsqual_defer(void *data)
+void prism2sta_commsqual_defer(struct work_struct *data)
 {
         hfa384x_t               *hw = (hfa384x_t *) data;
diff -rU2 linux-wlan-ng-0.2.7/src/prism2/include/prism2/prism2mgmt.h linux-wlan-ng-0.2.7.new/src/prism2/include/prism2/prism2mgmt.h
--- linux-wlan-ng-0.2.7/src/prism2/include/prism2/prism2mgmt.h	2005-04-26 17:43:07.000000000 +0200
+++ linux-wlan-ng-0.2.7.new/src/prism2/include/prism2/prism2mgmt.h	2007-04-30 12:08:14.000000000 +0200
@@ -169,7 +169,7 @@
 int prism2mgmt_get_grpaddr_index( UINT32 did );
 
-void prism2sta_processing_defer(void *data);
+void prism2sta_processing_defer(struct work_struct *data);
 
-void prism2sta_commsqual_defer(void *data);
+void prism2sta_commsqual_defer(struct work_struct *data);
 void prism2sta_commsqual_timer(unsigned long data);
 
