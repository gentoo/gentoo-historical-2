Index: trunk/net80211/ieee80211_crypto_ccmp.c
===================================================================
--- trunk/net80211/ieee80211_crypto_ccmp.c (revision 1732)
+++ trunk/net80211/ieee80211_crypto_ccmp.c (revision 1745)
@@ -300,4 +300,8 @@
 rijndael_encrypt(struct crypto_tfm *tfm, const void *src, void *dst)
 {
+/* FIXME: check for Linux 2.6.19 or newer once it's released */
+#ifdef CRYPTO_ALG_ASYNC
+	crypto_cipher_encrypt_one(tfm, dst, src);
+#else
 	struct scatterlist sg_src;
 	struct scatterlist sg_dst;
@@ -311,4 +315,5 @@
 	sg_dst.length = AES_BLOCK_LEN;
 	crypto_cipher_encrypt(tfm, &sg_dst, &sg_src, AES_BLOCK_LEN);
+#endif
 }
 
