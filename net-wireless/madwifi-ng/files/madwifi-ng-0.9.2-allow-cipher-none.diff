*** net80211/ieee80211_wireless.c.orig	Sat Jan 13 07:14:39 2007
--- net80211/ieee80211_wireless.c	Sat Jan 13 07:15:19 2007
***************
*** 2079,2085 ****
  			retv = ENETRESET;
  		break;
  	case IEEE80211_PARAM_UCASTCIPHER:
! 		if ((rsn->rsn_ucastcipherset & cipher2cap(value)) == 0)
  			return -EINVAL;
  		rsn->rsn_ucastcipher = value;
  		break;
--- 2079,2086 ----
  			retv = ENETRESET;
  		break;
  	case IEEE80211_PARAM_UCASTCIPHER:
! 		if ((value != IEEE80211_CIPHER_NONE)
! 			&& ((rsn->rsn_ucastcipherset & cipher2cap(value)) == 0))
  			return -EINVAL;
  		rsn->rsn_ucastcipher = value;
  		break;
