From 0a065f6386b285e211dcc0444847469cba9071ef Mon Sep 17 00:00:00 2001
From: Doug Kehn <rdkehn@yahoo.com>
Date: Wed, 26 Jan 2011 14:30:11 -0800
Subject: [PATCH 18/20] L5Common: Big-endian support

Add byte swap calls where needed.

Signed-off-by: Doug Kehn <rdkehn@yahoo.com>
---
 .../Common/L5Common/IndicatorsSubscribers.c        |    5 +++--
 .../OSAgnostic/Product/PipeHandler/Makefile.am     |    7 +++++--
 .../OSAgnostic/Product/PipeHandler/Makefile.in     |    6 +++++-
 3 files changed, 13 insertions(+), 5 deletions(-)

diff --git a/InfraStack/OSAgnostic/Common/L5Common/IndicatorsSubscribers.c b/InfraStack/OSAgnostic/Common/L5Common/IndicatorsSubscribers.c
index 97e7b8e..f920509 100644
--- a/InfraStack/OSAgnostic/Common/L5Common/IndicatorsSubscribers.c
+++ b/InfraStack/OSAgnostic/Common/L5Common/IndicatorsSubscribers.c
@@ -30,6 +30,7 @@ POSSIBILITY OF SUCH DAMAGE.
 ***************************************************************************/
 #include <unistd.h>
 #include <stdlib.h>
+#include <wimaxll.h>
 #include "IndicatorsSubscribers.h"
 
 #include "CommonServices.h"
@@ -197,8 +198,8 @@ EXPORT void SendIndicationToSubscribers( UINT32 internalRequestID, void *_buffer
 		{
 			//in case we are working with remote DnD, we want to send the trace and monitor indications 
 			//only to the DnD agent
-			if(((L3_L4_OPCODE_REPORT_MONITOR_EVACUATE != *((UINT16 *)buffer->indication_buffer)) &&
-				(L3_L4_OPCODE_REPORT_TRACE_EVACUATE != *((UINT16 *)buffer->indication_buffer))) ||
+			if(((L3_L4_OPCODE_REPORT_MONITOR_EVACUATE != wimaxll_le16_to_cpu(*((UINT16 *)buffer->indication_buffer))) &&
+				(L3_L4_OPCODE_REPORT_TRACE_EVACUATE != wimaxll_le16_to_cpu(*((UINT16 *)buffer->indication_buffer)))) ||
 				(L5_TARGET_DND_AGENT == targetID))
 			{
 				TRACE(TR_MOD_WRAPPER_LOGS, TR_SEV_DEBUG,"SendIndicationToSubscribers - senderL5Conn=0x%x, targetID=%d, internalRequestID=%d",
diff --git a/InfraStack/OSAgnostic/Product/PipeHandler/Makefile.am b/InfraStack/OSAgnostic/Product/PipeHandler/Makefile.am
index ea69a28..5969a48 100644
--- a/InfraStack/OSAgnostic/Product/PipeHandler/Makefile.am
+++ b/InfraStack/OSAgnostic/Product/PipeHandler/Makefile.am
@@ -56,10 +56,13 @@ libPipeHandler_la_CFLAGS = 	-I "$(top_srcdir)/InfraStack/OSAgnostic/Common/Commo
 			  	-I "$(top_srcdir)/InfraStack/OSDependent/Linux/InfraStackModules/TraceModule/" \
 			  	-D _GNU_SOURCE \
 			  	-D "L5_USE_CLIENT_SOCKETS" -D "_USE_TRACE" \
+				@LIBWIMAX_CFLAGS@				\
 			  	-D "BMI_MACHINE_ENDIANNESS_LITTLE" -D "_LINUX"
 
-libPipeHandler_la_LIBADD = $(top_builddir)/InfraStack/OSDependent/Linux/InfraStackModules/IPCs/libSockets.la
+libPipeHandler_la_LIBADD = \
+	$(top_builddir)/InfraStack/OSDependent/Linux/InfraStackModules/IPCs/libSockets.la \
+	@LIBWIMAX_LIBS@
+
 
- 
 
 
diff --git a/InfraStack/OSAgnostic/Product/PipeHandler/Makefile.in b/InfraStack/OSAgnostic/Product/PipeHandler/Makefile.in
index c35402c..f3571a7 100644
--- a/InfraStack/OSAgnostic/Product/PipeHandler/Makefile.in
+++ b/InfraStack/OSAgnostic/Product/PipeHandler/Makefile.in
@@ -260,9 +260,13 @@ libPipeHandler_la_CFLAGS = -I "$(top_srcdir)/InfraStack/OSAgnostic/Common/Common
 			  	-I "$(top_srcdir)/InfraStack/OSDependent/Linux/InfraStackModules/TraceModule/" \
 			  	-D _GNU_SOURCE \
 			  	-D "L5_USE_CLIENT_SOCKETS" -D "_USE_TRACE" \
+				@LIBWIMAX_CFLAGS@				\
 			  	-D "BMI_MACHINE_ENDIANNESS_LITTLE" -D "_LINUX"
 
-libPipeHandler_la_LIBADD = $(top_builddir)/InfraStack/OSDependent/Linux/InfraStackModules/IPCs/libSockets.la
+libPipeHandler_la_LIBADD = \
+	$(top_builddir)/InfraStack/OSDependent/Linux/InfraStackModules/IPCs/libSockets.la \
+	@LIBWIMAX_LIBS@
+
 all: all-am
 
 .SUFFIXES:
-- 
1.7.4.1

