From befcae11af55ab8987548a01344ee994a83964e6 Mon Sep 17 00:00:00 2001
From: Inaky Perez-Gonzalez <inaky.perez-gonzalez@intel.com>
Date: Fri, 4 Feb 2011 14:27:34 -0800
Subject: [PATCH 20/20] endianess: use <endian.h> to determine endianess vs static Makefile definitions

Reported-by: Doug Kehn <rdkehn@yahoo.com>

Signed-off-by: Inaky Perez-Gonzalez <inaky.perez-gonzalez@intel.com>
---
 .../Common/L4Common/SourceControl/BitmanCommon.h   |    6 ++++--
 .../Instrumantation/MocMsgProxy/Makefile.am        |    2 +-
 .../Instrumantation/MocMsgProxy/Makefile.in        |    2 +-
 .../OSAgnostic/WiMax/Wrappers/iWmxSDK/Makefile.am  |    2 +-
 .../OSAgnostic/WiMax/Wrappers/iWmxSDK/Makefile.in  |    2 +-
 5 files changed, 8 insertions(+), 6 deletions(-)

diff --git a/InfraStack/OSAgnostic/Common/L4Common/SourceControl/BitmanCommon.h b/InfraStack/OSAgnostic/Common/L4Common/SourceControl/BitmanCommon.h
index 874df35..11ff75f 100644
--- a/InfraStack/OSAgnostic/Common/L4Common/SourceControl/BitmanCommon.h
+++ b/InfraStack/OSAgnostic/Common/L4Common/SourceControl/BitmanCommon.h
@@ -12,6 +12,8 @@
 #ifndef _BITMAN_COMMON_H_
 #define _BITMAN_COMMON_H_
 
+#include <endian.h>
+
 #if defined __ARMCC_VERSION
 	#ifndef __arm
 		#define __arm
@@ -29,9 +31,9 @@
 #define BMI_MACHINE_INTEL_LITTLE	(3)
 
 // New definitions for machine endianness
-#if defined BMI_MACHINE_ENDIANNESS_LITTLE
+#if BYTE_ORDER == LITTLE_ENDIAN
 #define BMI_ENDIANNESS_LITTLE
-#elif defined BMI_MACHINE_ENDIANNESS_BIG
+#elif BYTE_ORDER == BIG_ENDIAN
 #define BMI_ENDIANNESS_BIG
 #endif
 
diff --git a/InfraStack/OSAgnostic/Product/Instrumantation/MocMsgProxy/Makefile.am b/InfraStack/OSAgnostic/Product/Instrumantation/MocMsgProxy/Makefile.am
index ff557d1..02bbf28 100644
--- a/InfraStack/OSAgnostic/Product/Instrumantation/MocMsgProxy/Makefile.am
+++ b/InfraStack/OSAgnostic/Product/Instrumantation/MocMsgProxy/Makefile.am
@@ -24,6 +24,6 @@ libMocMsgProxy_la_CFLAGS = \
 			-I "$(top_srcdir)/InfraStack/OSAgnostic/Common/L4Common/SourceControl" \
 			-I "$(top_srcdir)/InfraStack/OSDependent/Linux/L4Generated" \
 			-I "$(top_srcdir)/InfraStack/OSAgnostic/OSInterface/InfraStackModules"  \
-			-D "_USE_TRACE" -D "BMI_ENDIANNESS_LITTLE" -D "_LINUX" -D "_OS_WIN32SIM" 
+			-D "_USE_TRACE" -D "_LINUX" -D "_OS_WIN32SIM" 
 
 
diff --git a/InfraStack/OSAgnostic/Product/Instrumantation/MocMsgProxy/Makefile.in b/InfraStack/OSAgnostic/Product/Instrumantation/MocMsgProxy/Makefile.in
index 287ebc6..0704a3d 100644
--- a/InfraStack/OSAgnostic/Product/Instrumantation/MocMsgProxy/Makefile.in
+++ b/InfraStack/OSAgnostic/Product/Instrumantation/MocMsgProxy/Makefile.in
@@ -218,7 +218,7 @@ libMocMsgProxy_la_CFLAGS = \
 			-I "$(top_srcdir)/InfraStack/OSAgnostic/Common/L4Common/SourceControl" \
 			-I "$(top_srcdir)/InfraStack/OSDependent/Linux/L4Generated" \
 			-I "$(top_srcdir)/InfraStack/OSAgnostic/OSInterface/InfraStackModules"  \
-			-D "_USE_TRACE" -D "BMI_ENDIANNESS_LITTLE" -D "_LINUX" -D "_OS_WIN32SIM" 
+			-D "_USE_TRACE" -D "_LINUX" -D "_OS_WIN32SIM" 
 
 all: all-am
 
diff --git a/InfraStack/OSAgnostic/WiMax/Wrappers/iWmxSDK/Makefile.am b/InfraStack/OSAgnostic/WiMax/Wrappers/iWmxSDK/Makefile.am
index 57c08c6..e66d576 100644
--- a/InfraStack/OSAgnostic/WiMax/Wrappers/iWmxSDK/Makefile.am
+++ b/InfraStack/OSAgnostic/WiMax/Wrappers/iWmxSDK/Makefile.am
@@ -98,7 +98,7 @@ libiWmxSdk_la_CFLAGS =  \
 			-I "$(srcdir)/../../Agents/NDnS/Source" \
 			-I "$(srcdir)/../../Agents/NDnS/APDO/" \
 			-I "$(srcdir)/../../Agents/Supplicant/Source/ds" \
-			-D "_USE_TRACE" -D "BMI_ENDIANNESS_LITTLE" \
+			-D "_USE_TRACE" \
 			-D "_OS_WIN32SIM" -D "OMADM_CLIENT_SIMULATOR" \
 			-D _GNU_SOURCE \
 			-D "_LINUX" -D "_WIMAX_SDK_" \
diff --git a/InfraStack/OSAgnostic/WiMax/Wrappers/iWmxSDK/Makefile.in b/InfraStack/OSAgnostic/WiMax/Wrappers/iWmxSDK/Makefile.in
index 893ec4c..743d355 100644
--- a/InfraStack/OSAgnostic/WiMax/Wrappers/iWmxSDK/Makefile.in
+++ b/InfraStack/OSAgnostic/WiMax/Wrappers/iWmxSDK/Makefile.in
@@ -333,7 +333,7 @@ libiWmxSdk_la_CFLAGS = \
 			-I "$(srcdir)/../../Agents/NDnS/Source" \
 			-I "$(srcdir)/../../Agents/NDnS/APDO/" \
 			-I "$(srcdir)/../../Agents/Supplicant/Source/ds" \
-			-D "_USE_TRACE" -D "BMI_ENDIANNESS_LITTLE" \
+			-D "_USE_TRACE" \
 			-D "_OS_WIN32SIM" -D "OMADM_CLIENT_SIMULATOR" \
 			-D _GNU_SOURCE \
 			-D "_LINUX" -D "_WIMAX_SDK_" \
-- 
1.7.4.1

