diff -urp ieee80211-1.1.13/Makefile ieee80211-1.1.13-cflags/Makefile
--- ieee80211-1.1.13/Makefile	2006-03-31 11:12:02.000000000 +0200
+++ ieee80211-1.1.13-cflags/Makefile	2006-04-04 17:24:20.000000000 +0200
@@ -73,17 +73,19 @@ ifneq ($(KERNELRELEASE),)
 # 
 
 ifeq ($(EXTERNAL_BUILD),y)
-ifdef CONFIG_IEEE80211_DEBUG
-EXTRA_CFLAGS += -DCONFIG_IEEE80211_DEBUG=$(CONFIG_IEEE80211_DEBUG)
+ifeq ($(CONFIG_IEEE80211_DEBUG),y)
+EXTRA_CFLAGS += -DCONFIG_IEEE80211_DEBUG
 endif
-ifdef CONFIG_IEEE80211_CRYPT_WEP
-EXTRA_CFLAGS += -DCONFIG_IEEE80211_CRYPT_WEP=$(CONFIG_IEEE80211_CRYPT_WEP)
+# Checking against 'y' doesn't make sense since this if for external
+# builds only
+ifeq ($(CONFIG_IEEE80211_CRYPT_WEP),m)
+EXTRA_CFLAGS += -DCONFIG_IEEE80211_CRYPT_WEP
 endif
-ifdef CONFIG_IEEE80211_CRYPT_TKIP
-EXTRA_CFLAGS += -DCONFIG_IEEE80211_CRYPT_TKIP=$(CONFIG_IEEE80211_CRYPT_TKIP)
+ifeq ($(CONFIG_IEEE80211_CRYPT_TKIP),m)
+EXTRA_CFLAGS += -DCONFIG_IEEE80211_CRYPT_TKIP
 endif
-ifdef CONFIG_IEEE80211_CRYPT_CCMP
-EXTRA_CFLAGS += -DCONFIG_IEEE80211_CRYPT_CCMP=$(CONFIG_IEEE80211_CRYPT_CCMP)
+ifeq ($(CONFIG_IEEE80211_CRYPT_CCMP),m)
+EXTRA_CFLAGS += -DCONFIG_IEEE80211_CRYPT_CCMP
 endif
 endif
 
