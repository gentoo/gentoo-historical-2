diff -urp ipw2100-1.1.4/ipw2100.c ipw2100-1.1.4-fix/ipw2100.c
--- ipw2100-1.1.4/ipw2100.c	2006-01-11 13:39:51.000000000 +0800
+++ ipw2100-1.1.4-fix/ipw2100.c	2006-01-11 13:39:47.000000000 +0800
@@ -296,16 +296,6 @@ static const char *command_types[] = {
 };
 #endif
 
-#if LINUX_VERSION_CODE < KERNEL_VERSION(2,6,14)
-static void *kzalloc(size_t size, gfp_t flags)
-{
-	void *ret = kmalloc(size, flags);
-	if (ret)
-		memset(ret, 0, size);
-	return ret;
-}
-#endif
-
 /* Pre-decl until we get the code solid and then we can clean it up */
 static void ipw2100_tx_send_commands(struct ipw2100_priv *priv);
 static void ipw2100_tx_send_data(struct ipw2100_priv *priv);
@@ -6440,8 +6430,12 @@ static struct net_device *ipw2100_alloc_
 	dev->ethtool_ops = &ipw2100_ethtool_ops;
 	dev->tx_timeout = ipw2100_tx_timeout;
 	dev->wireless_handlers = &ipw2100_wx_handler_def;
+#if IW_HANDLER_VERSION > 6
 	priv->wireless_data.ieee80211 = priv->ieee;
 	dev->wireless_data = &priv->wireless_data;
+#else
+	dev->get_wireless_stats = ipw2100_wx_wireless_stats;
+#endif
 	dev->set_mac_address = ipw2100_set_address;
 	dev->watchdog_timeo = 3 * HZ;
 	dev->irq = 0;
