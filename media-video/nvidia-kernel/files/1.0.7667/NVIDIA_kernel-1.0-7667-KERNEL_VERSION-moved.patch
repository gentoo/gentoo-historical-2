diff -urpN nv/conftest.sh nv.az/conftest.sh
--- nv/conftest.sh	2005-06-17 16:50:43.000000000 +0200
+++ nv.az/conftest.sh	2005-07-17 00:30:54.000000000 +0200
@@ -212,6 +212,9 @@ case "$4" in
             # Determine the kernel version using a compile check.
             #
             echo "#include \"linux/version.h\"
+	    #ifndef KERNEL_VERSION 
+	    # include <linux/utsname.h>
+	    #endif
             int main() {
               if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,0)) {
                 return 0;
@@ -290,6 +293,9 @@ case "$4" in
         #
 
         echo "#include \"linux/version.h\"
+        #ifndef KERNEL_VERSION 
+        # include <linux/utsname.h>
+        #endif
         int main() {
             printf(\"%s\n\", UTS_RELEASE);
             return 0;
@@ -369,6 +375,9 @@ case "$4" in
         
         echo "#include <linux/version.h>
         #include <linux/mm.h>
+        #ifndef KERNEL_VERSION 
+        # include <linux/utsname.h>
+        #endif
         #if LINUX_VERSION_CODE >= KERNEL_VERSION(2, 6, 0)
           #include <asm/cacheflush.h>
         #endif
@@ -460,6 +469,9 @@ case "$4" in
         VERBOSE=$5
 
         echo "#include <linux/version.h>
+        #ifndef KERNEL_VERSION 
+        # include <linux/utsname.h>
+        #endif
         #include <linux/autoconf.h>
         #if defined(CONFIG_X86_64) && \
             LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,0) && \
diff -urpN nv/nv-linux.h nv.az/nv-linux.h
--- nv/nv-linux.h	2005-06-17 16:50:42.000000000 +0200
+++ nv.az/nv-linux.h	2005-07-17 00:31:06.000000000 +0200
@@ -16,6 +16,9 @@
 
 #include <linux/config.h>
 #include <linux/version.h>
+#ifndef KERNEL_VERSION 
+# include <linux/utsname.h>
+#endif
 
 
 #if LINUX_VERSION_CODE < KERNEL_VERSION(2, 4, 0)
