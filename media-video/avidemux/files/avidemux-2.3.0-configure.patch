--- avidemux_2.3_preview2/configure.in.old	2006-10-26 21:18:36.453792624 +0200
+++ avidemux_2.3_preview2/configure.in	2006-10-26 22:41:06.403158349 +0200
@@ -196,7 +196,7 @@
 have_divx=yes
 have_little_endian=yes
 have_vorbis=yes
-have_ac3=yes
+have_ac3=no
 have_xx_xvid=yes
 have_xx_xvid_cvs=yes
 have_xvid4=yes
@@ -270,6 +270,16 @@
 
 dnl __________________divx______________
 dnl __________________x264 ______________
+AC_ARG_WITH([aften],
+	AC_HELP_STRING([--without-aften], [Force compilation without aften (default: test)]),
+	[with_aften=${withval}], [with_aften=test])
+
+AC_MSG_CHECKING([if aften support is requested])
+AC_MSG_RESULT($with_aften)
+
+have_aften=no
+
+if test "x$with_aften" != "xno"; then
 AC_MSG_CHECKING(for aften codec )
 AC_CHECK_HEADER(aften/aften.h,,have_aften=no)
 if test "x$have_aften" = "xyes"; then
@@ -277,22 +287,42 @@
 fi
 if test "x$have_aften" = "xyes"; then
 	AC_DEFINE(USE_AFTEN,1,[use aften ac3 encoder])
+	have_ac3=yes
+fi
 fi
-
 
 dnl __________________x264 ______________
+AC_ARG_WITH([x264],
+	AC_HELP_STRING([--without-x264], [Force compilation without x264 (default: test)]),
+	[with_x264=${withval}], [with_x264=test])
+
+AC_MSG_CHECKING([if x264 support is requested])
+AC_MSG_RESULT($with_x264)
+
+have_x264=no
+
+if test "x$with_x264" != "xno"; then
 AC_MSG_CHECKING(for x264 codec )
-AC_CHECK_HEADER(x264.h,,have_x264=no)
-if test "x$have_x264" = "xyes"; then
+AC_CHECK_HEADER(x264.h,have_x264=yes,have_x264=no)
    AC_CHECK_LIB(x264,x264_encoder_open,,have_x264=no,-lm )
-fi
 if test "x$have_x264" = "xyes"; then
 	AC_DEFINE(USE_X264,1,[use x264 encoder])
 fi
+fi
 
 dnl __________________xvid 0.9 ______________
+AC_ARG_WITH([xx-xvid],
+	AC_HELP_STRING([--without-xx-xvid], [Force compilation without xvid 0.9 (default: test)]),
+	[with_xx_xvid=${withval}], [with_xx_xvid=test])
+
+AC_MSG_CHECKING([if xvid 0.9 support is requested])
+AC_MSG_RESULT($with_xx_xvid)
+
+have_xx_xvid=no
+
+if test "x$with_xx_xvid" != "xno"; then
 AC_MSG_CHECKING(for xvid codec 0.9)
-AC_CHECK_HEADER(xvid.h,,have_xx_xvid=no)
+AC_CHECK_HEADER(xvid.h,have_xx_xvid=yes,have_xx_xvid=no)
 
 dnl -- check API version 2.1 and not 2.0--
 
@@ -318,16 +348,38 @@
  if test "x$have_xx_xvid" = "xyes"; then
  	AC_DEFINE(USE_XX_XVID,1,[use xvid api])
  fi
+ fi
 dnl __________________libpng  ______________
+AC_ARG_WITH([png],
+	AC_HELP_STRING([--without-png], [Force compilation without png support (default: test)]),
+	[with_png=${withval}], [with_png=test])
+
+AC_MSG_CHECKING([if PNG support is requested])
+AC_MSG_RESULT($with_png)
+
+have_png=no
+
+if test "x$with_png" != "xno"; then
 AC_MSG_CHECKING(for libpng )
-have_png=yes
-AC_CHECK_HEADER(png.h,,have_png=no)
+AC_CHECK_HEADER(png.h,have_png=yes,have_png=no)
 AC_CHECK_LIB(png,png_malloc,,have_png=no)
  
 if test "x$have_png" = "xyes"; then
 	AC_DEFINE(USE_PNG,1,[Png is available])
 fi
+fi
 dnl __________________xvid 1.0 ______________
+AC_ARG_WITH([xvid4],
+	AC_HELP_STRING([--without-xvid4], [Force compilation without xvid4 support (default: test)]),
+	[with_xvid4=${withval}], [with_xvid4=test])
+
+AC_MSG_CHECKING([if Xvid 4 support is requested])
+AC_MSG_RESULT($with_xvid4)
+
+have_xvid4=no
+
+if test "x$with_xvid4" != "xno"; then
+have_xvid4=yes
 AC_MSG_CHECKING(for xvid codec 1.0)
 AC_CHECK_HEADER(xvid.h,,have_xvid4=no)
 
@@ -353,6 +405,7 @@
 		AC_DEFINE(USE_XVID_4,1,[use xvid api 1.0 beta])
 	fi
  fi
+ fi
 
 dnl __________________FFMPEG______________
 
@@ -486,6 +539,17 @@
 fi
 
 dnl __________________ALSA______________
+AC_ARG_WITH([alsa],
+	AC_HELP_STRING([--without-alsa], [Force compilation without alsa (default: test)]),
+	[with_alsa=${withval}], [with_alsa=test])
+
+AC_MSG_CHECKING([if alsa support is requested])
+AC_MSG_RESULT($with_alsa)
+
+have_alsa=no
+
+if test "x$with_alsa" != "xno"; then
+have_alsa=yes
 AC_MSG_CHECKING(for ALSA audio support)
 AC_CHECK_HEADERS(alsa/asoundlib.h,,have_alsa=no)
 dnl check version 0.9.x
@@ -526,7 +590,7 @@
 if test "x$have_alsa_1" = "xyes"; then				
 	AC_DEFINE(ALSA_1_0_SUPPORT,1,"[Alsa is 1.0]")
 fi
-
+fi
 dnl __________________/ALSA______________
 
 
@@ -646,6 +710,16 @@
  
 
 dnl ____________ faac ?________________
+AC_ARG_WITH([faac],
+	AC_HELP_STRING([--without-faac], [Force compilation without faac (default: test)]),
+	[with_faac=${withval}], [with_faac=test])
+
+AC_MSG_CHECKING([if faac support is requested])
+AC_MSG_RESULT($with_faac)
+
+have_faac=no
+
+if test "x$with_faac" != "xno"; then
 have_faac=yes
  AC_CHECK_HEADERS(faac.h,,have_faac=no)
  
@@ -659,15 +733,35 @@
     fi     
  AC_MSG_CHECKING(faac library) 
  AC_MSG_RESULT($have_faac)
-  
+ fi
 dnl _______________/faac_______________
 dnl _________________ /freetype 2 _________________
 dnl __________________ac3______________
  dnl
  dnl a52dec decoding library
+AC_ARG_WITH([a52],
+	AC_HELP_STRING([--without-a52], [Force compilation without a52 (default: enabled)]),
+	[with_a52=${withval}], [with_a52=test])
+
+AC_MSG_CHECKING([if a52 support is requested])
+AC_MSG_RESULT($with_a52)
+
+if test "x$with_a52" != "xno"; then
 AC_DEFINE(USE_AC3,1,[liba52dec])
+have_ac3=yes
+fi
 dnl __________________/ac3______________
 dnl __________________VORBIS______________
+AC_ARG_WITH([vorbis],
+	AC_HELP_STRING([--without-vorbis], [Force compilation without vorbis (default: enabled)]),
+	[with_vorbis=${withval}], [with_vorbis=test])
+
+AC_MSG_CHECKING([if vorbis support is requested])
+AC_MSG_RESULT($with_vorbis)
+
+have_vorbis=no
+if test "x$with_vorbis" != "xno"; then
+have_vorbis=yes
 AC_CHECK_LIB(vorbis,vorbis_info_init,,have_vorbis=no, -lm)
 if test "x$have_vorbis" = "xyes"; then
 	AC_CHECK_LIB(vorbisenc,vorbis_encode_init,,have_vorbis=no, -lm)
@@ -678,6 +772,7 @@
 		fi
 	fi
 fi
+fi
 dnl __________________/VORBIS______________
 
 dnl __________________LAME______________
