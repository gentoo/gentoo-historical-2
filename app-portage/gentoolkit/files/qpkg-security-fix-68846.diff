--- src/qpkg/qpkg	1 Aug 2004 17:31:46 -0000	1.15
+++ src/qpkg/qpkg	31 Oct 2004 00:43:00 -0000	1.16
@@ -9,7 +9,9 @@
 ID='$Id: qpkg-security-fix-68846.diff,v 1.1 2004/10/31 01:08:35 genone Exp $'
 VERSION=0.`echo ${ID} | cut -d\  -f3`
 
-TMP="/tmp/qpkg-${$}/"
+umask 0077
+
+TMP="$(mktemp -d -t qpkg-XXXXXX)" || exit 1
 rm -rf ${TMP}
 mkdir -p ${TMP}
 
@@ -228,6 +230,7 @@
 			the older ones will have \"damaged\" files.
   ${PROG} -f /bin/ls	print package(s) that own /bin/ls
 "
+	rm -rf ${TMP}
 	exit
 fi
 
@@ -292,6 +295,7 @@
 					-e "s:-[0-9].*$::" \
 					-e "s:\(^[^/]*/\)\(.*\):${BR}\1${CY}\2${NO}:"|uniq
 	fi
+	rm -rf ${TMP}
 	exit
 fi
 
