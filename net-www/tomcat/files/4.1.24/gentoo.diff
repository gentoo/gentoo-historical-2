--- bin/setclasspath.sh.orig	2003-03-25 10:41:13.000000000 -0500
+++ bin/setclasspath.sh	2003-03-25 10:42:57.000000000 -0500
@@ -6,13 +6,15 @@
 
 # Make sure prerequisite environment variables are set
 if [ -z "$JAVA_HOME" ]; then
-  echo "The JAVA_HOME environment variable is not defined"
-  echo "This environment variable is needed to run this program"
+  echo "The JAVA_HOME environment variable is not defined!"
+  echo "This environment variable is needed to run this program."
+  echo "See the /etc/conf.d/tomcat file for details."
   exit 1
 fi
 if [ ! -r "$JAVA_HOME"/bin/java -o ! -r "$JAVA_HOME"/bin/jdb -o ! -r "$JAVA_HOME"/bin/javac ]; then
-  echo "The JAVA_HOME environment variable is not defined correctly"
-  echo "This environment variable is needed to run this program"
+  echo "The JAVA_HOME environment variable is not defined correctly!"
+  echo "This environment variable is needed to run this program."
+  echo "See the /etc/conf.d/tomcat file for details."
   exit 1
 fi
 if [ -z "$BASEDIR" ]; then
@@ -27,7 +29,7 @@
 fi
 
 # Set the default -Djava.endorsed.dirs argument
-JAVA_ENDORSED_DIRS="$BASEDIR"/common/endorsed
+JAVA_ENDORSED_DIRS="$TOMCAT_LIBDIR"
 
 # Set standard CLASSPATH
 CLASSPATH="$JAVA_HOME"/lib/tools.jar
--- bin/catalina.sh.orig	2003-03-25 10:50:50.000000000 -0500
+++ bin/catalina.sh	2003-03-25 10:55:13.000000000 -0500
@@ -40,9 +40,6 @@
 
 # OS specific support.  $var _must_ be set to either true or false.
 cygwin=false
-case "`uname`" in
-CYGWIN*) cygwin=true;;
-esac
 
 # resolve links - $0 may be a softlink
 PRG="$0"
@@ -63,15 +60,8 @@
 if [ -r "$CATALINA_HOME"/bin/setenv.sh ]; then
   . "$CATALINA_HOME"/bin/setenv.sh
 fi
+source /etc/conf.d/tomcat
 
-# For Cygwin, ensure paths are in UNIX format before anything is touched
-if $cygwin; then
-  [ -n "$JAVA_HOME" ] && JAVA_HOME=`cygpath --unix "$JAVA_HOME"`
-  [ -n "$CATALINA_HOME" ] && CATALINA_HOME=`cygpath --unix "$CATALINA_HOME"`
-  [ -n "$CATALINA_BASE" ] && CATALINA_BASE=`cygpath --unix "$CATALINA_BASE"`
-  [ -n "$CLASSPATH" ] && CLASSPATH=`cygpath --path --unix "$CLASSPATH"`
-  [ -n "$JSSE_HOME" ] && JSSE_HOME=`cygpath --path --unix "$JSSE_HOME"`
-fi
 
 # Get standard Java environment variables
 if [ -r "$CATALINA_HOME"/bin/setclasspath.sh ]; then
@@ -98,23 +88,7 @@
   CATALINA_TMPDIR="$CATALINA_BASE"/temp
 fi
 
-# For Cygwin, switch paths to Windows format before running java
-if $cygwin; then
-  JAVA_HOME=`cygpath --path --windows "$JAVA_HOME"`
-  CATALINA_HOME=`cygpath --path --windows "$CATALINA_HOME"`
-  CATALINA_BASE=`cygpath --path --windows "$CATALINA_BASE"`
-  CATALINA_TMPDIR=`cygpath --path --windows "$CATALINA_TMPDIR"`
-  CLASSPATH=`cygpath --path --windows "$CLASSPATH"`
-  JSSE_HOME=`cygpath --path --windows "$JSSE_HOME"`
-fi
-
 # ----- Execute The Requested Command -----------------------------------------
-
-echo "Using CATALINA_BASE:   $CATALINA_BASE"
-echo "Using CATALINA_HOME:   $CATALINA_HOME"
-echo "Using CATALINA_TMPDIR: $CATALINA_TMPDIR"
-echo "Using JAVA_HOME:       $JAVA_HOME"
-
 if [ "$1" = "jpda" ] ; then
   if [ -z "$JPDA_TRANSPORT" ]; then
     JPDA_TRANSPORT="dt_socket"
@@ -191,7 +165,7 @@
 elif [ "$1" = "start" ] ; then
 
   shift
-  touch "$CATALINA_BASE"/logs/catalina.out
+  touch "$CATALINA_OUT"
   if [ "$1" = "-security" ] ; then
     echo "Using Security Manager"
     shift
@@ -203,7 +177,7 @@
       -Dcatalina.home="$CATALINA_HOME" \
       -Djava.io.tmpdir="$CATALINA_TMPDIR" \
       org.apache.catalina.startup.Bootstrap "$@" start \
-      >> "$CATALINA_BASE"/logs/catalina.out 2>&1 &
+      >> "$CATALINA_OUT" 2>&1 &
 
       if [ ! -z "$CATALINA_PID" ]; then
         echo $! > $CATALINA_PID
@@ -215,7 +189,7 @@
       -Dcatalina.home="$CATALINA_HOME" \
       -Djava.io.tmpdir="$CATALINA_TMPDIR" \
       org.apache.catalina.startup.Bootstrap "$@" start \
-      >> "$CATALINA_BASE"/logs/catalina.out 2>&1 &
+      >> "$CATALINA_OUT" 2>&1 &
 
       if [ ! -z "$CATALINA_PID" ]; then
         echo $! > $CATALINA_PID
