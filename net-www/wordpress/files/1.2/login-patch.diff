diff -u --recursive wordpress/wp-admin/auth.php diary/wp-admin/auth.php
--- wordpress/wp-admin/auth.php	2004-05-19 08:05:40.000000000 +0100
+++ diary/wp-admin/auth.php	2004-07-20 21:32:39.048004629 +0100
@@ -15,9 +15,13 @@
 	}
 
 	if ('' == $user_login)
+	{
 		return false;
+	}
 	if (!$user_pass_md5)
+	{
 		return false;
+	}
 
 	$login = $wpdb->get_row("SELECT user_login, user_pass FROM $tableusers WHERE user_login = '$user_login'");
 
@@ -25,7 +29,7 @@
 		return false;
 
 	} else {
-		if ($login->user_login == $user_login && md5($login->user_pass) == $user_pass_md5) {
+		if ($login->user_login == $user_login && $login->user_pass == $user_pass_md5) {
 			return true;
 		} else {
 			return false;
@@ -46,4 +50,4 @@
 	exit();
 }
 
-?>
\ No newline at end of file
+?>
Only in /srv/stu.gnqs.org/www/htdocs/diary/: wp-config.php
diff -u --recursive wordpress/wp-login.php diary/wp-login.php
--- wordpress/wp-login.php	2004-05-18 02:29:29.000000000 +0100
+++ diary/wp-login.php	2004-07-20 22:10:53.836444653 +0100
@@ -74,8 +74,8 @@
 		global $wpdb, $log, $pwd, $error, $user_ID;
 		global $tableusers, $pass_is_md5;
 		$user_login = &$log;
-		$pwd = md5($pwd);
-		$password = &$pwd;
+		$password = md5($pwd);
+
 		if (!$user_login) {
 			$error = __('<strong>Error</strong>: the login field is empty.');
 			return false;
@@ -95,8 +95,9 @@
 			$pwd = '';
 			return false;
 		} else {
-		$user_ID = $login->ID;
-			if (($pass_is_md5 == 0 && $login->user_login == $user_login && $login->user_pass == $password) || ($pass_is_md5 == 1 && $login->user_login == $user_login && $login->user_pass == md5($password))) {
+			$user_ID = $login->ID;
+
+			if ($login->user_login == $user_login && $login->user_pass == $password) {
 				return true;
 			} else {
 				$error = __('<strong>Error</strong>: wrong login or password.');
@@ -242,7 +243,7 @@
 
 		$userdata = get_userdatabylogin($user_login);
 
-		if ($user_pass_md5 != md5($userdata->user_pass)) {
+		if (!$userdata || $user_pass_md5 != $userdata->user_pass) {
 			return false;
 		} else {
 			return true;
