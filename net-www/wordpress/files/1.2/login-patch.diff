diff -u --recursive wordpress/wp-admin/auth.php /srv/stu.gnqs.org/www/htdocs/diary/wp-admin/auth.php
--- wordpress/wp-admin/auth.php	2004-05-19 08:05:40.000000000 +0100
+++ /srv/stu.gnqs.org/www/htdocs/diary/wp-admin/auth.php	2004-07-11 23:22:25.125981755 +0100
@@ -15,9 +15,14 @@
 	}
 
 	if ('' == $user_login)
+	{
 		return false;
+	}
+
 	if (!$user_pass_md5)
+	{
 		return false;
+	}
 
 	$login = $wpdb->get_row("SELECT user_login, user_pass FROM $tableusers WHERE user_login = '$user_login'");
 
@@ -25,7 +30,7 @@
 		return false;
 
 	} else {
-		if ($login->user_login == $user_login && md5($login->user_pass) == $user_pass_md5) {
+		if ($login->user_login == $user_login && $login->user_pass == $user_pass_md5) {
 			return true;
 		} else {
 			return false;
@@ -46,4 +51,4 @@
 	exit();
 }
 
-?>
\ No newline at end of file
+?>
diff -u --recursive wordpress/wp-login.php /srv/stu.gnqs.org/www/htdocs/diary/wp-login.php
--- wordpress/wp-login.php	2004-05-18 02:29:29.000000000 +0100
+++ /srv/stu.gnqs.org/www/htdocs/diary/wp-login.php	2004-07-11 23:00:59.412276890 +0100
@@ -95,14 +95,8 @@
 			$pwd = '';
 			return false;
 		} else {
-		$user_ID = $login->ID;
-			if (($pass_is_md5 == 0 && $login->user_login == $user_login && $login->user_pass == $password) || ($pass_is_md5 == 1 && $login->user_login == $user_login && $login->user_pass == md5($password))) {
-				return true;
-			} else {
-				$error = __('<strong>Error</strong>: wrong login or password.');
-				$pwd = '';
-			return false;
-			}
+			$user_ID = $login->ID;
+			return true;
 		}
 	}
 
@@ -111,11 +105,11 @@
 		header('Last-Modified: ' . gmdate('D, d M Y H:i:s') . ' GMT');
 		header('Cache-Control: no-cache, must-revalidate');
 		header('Pragma: no-cache');
-	if ($is_IIS) {
-		header('Refresh: 0;url=wp-login.php');
-	} else {
-		header('Location: wp-login.php');
-	}
+		if ($is_IIS) {
+			header('Refresh: 0;url=wp-login.php');
+		} else {
+			header('Location: wp-login.php');
+		}
 		exit();
 	} else {
 		$user_login = $log;
