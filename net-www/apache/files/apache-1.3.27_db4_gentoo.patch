--- apache_1.3.29/src/modules/standard/mod_auth_db.module	2001-10-16 05:12:02.000000000 -0400
+++ apache_1.3.29-roninds/src/modules/standard/mod_auth_db.module	2004-04-23 10:50:09.000000000 -0400
@@ -2,7 +2,20 @@
 ConfigStart
     DB_VERSION=''
     DB_LIB=''
-    if ./helpers/TestCompile func db_create; then
+
+    if ./helpers/TestCompile lib db-4 db_create_4000; then
+       DB_VERSION='Berkeley-DB/4.x'
+       DB_LIB='-ldb-4'
+       CFLAGS="$CFLAGS -I/usr/include/db4"
+    elif ./helpers/TestCompile lib db-4.0 db_create_4000; then
+       DB_VERSION='Berkeley-DB/4.x'
+       DB_LIB='-ldb-4.0'
+       CFLAGS="$CFLAGS -I/usr/include/db4"
+    elif ./helpers/TestCompile lib db-4.1 db_create_4001; then
+       DB_VERSION='Berkeley-DB/4.1'
+       DB_LIB='-ldb-4.1'
+       CFLAGS="$CFLAGS -I/usr/include/db4.1"
+    elif ./helpers/TestCompile func db_create; then
         DB_VERSION='Berkeley-DB/3.x'
     elif ./helpers/TestCompile lib db db_create; then
         DB_VERSION='Berkeley-DB/3.x'
