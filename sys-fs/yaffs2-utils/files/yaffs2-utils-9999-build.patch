Index: Makefile
===================================================================
RCS file: /home/aleph1/cvs/yaffs2/utils/Makefile,v
retrieving revision 1.2
diff -u -p -r1.2 Makefile
--- Makefile	6 Dec 2005 02:43:01 -0000	1.2
+++ Makefile	30 Jul 2006 18:45:07 -0000
@@ -16,15 +16,13 @@
 
 #KERNELDIR = /usr/src/kernel-headers-2.4.18
 
-CFLAGS =   -I/usr/include -I.. -O2 -Wall -DCONFIG_YAFFS_UTIL
+CFLAGS+=   -I.. -Wall -DCONFIG_YAFFS_UTIL
 CFLAGS+=   -Wshadow -Wpointer-arith -Wwrite-strings -Wstrict-prototypes -Wmissing-declarations
 CFLAGS+=   -Wmissing-prototypes -Wredundant-decls -Wnested-externs -Winline
 
 ## Change if you are using a cross-compiler
 MAKETOOLS = 
 
-CC=$(MAKETOOLS)gcc
-
 COMMONLINKS = yaffs_ecc.c
 COMMONOBJS = $(COMMONLINKS:.c=.o)
 
@@ -44,10 +42,10 @@ $(COMMONOBJS) $(MKYAFFSIMAGEOBJS) $(MKYA
 	$(CC) -c $(CFLAGS) $< -o $@
 
 mkyaffsimage: $(COMMONOBJS) $(MKYAFFSIMAGEOBJS)
-	$(CC) -o $@ $(COMMONOBJS) $(MKYAFFSIMAGEOBJS)
+	$(CC) $(CFLAGS) -o $@ $(COMMONOBJS) $(MKYAFFSIMAGEOBJS) $(LDFLAGS)
 
 mkyaffs2image: $(COMMONOBJS) $(MKYAFFS2IMAGEOBJS)
-	$(CC) -o $@ $(COMMONOBJS) $(MKYAFFS2IMAGEOBJS)
+	$(CC) $(CFLAGS) -o $@ $(COMMONOBJS) $(MKYAFFS2IMAGEOBJS) $(LDFLAGS)
 
 
 clean:
