--- Makefile.old	2006-10-07 15:40:26.052127208 +0200
+++ Makefile	2006-10-07 19:06:55.504062239 +0200
@@ -42,6 +42,12 @@
 	$(CC) $(LDFLAGS) -o lib/liblualib.so.$V -shared -Wl,-soname,liblualib.so.$V src/lib/*.o -L$(LIB) -llua $(EXTRA_LIBS) $(DLLIB)
 	cd lib; ln -fs liblua.so.$V liblua.so; ln -fs liblualib.so.$V liblualib.so
 
+dylib:
+	$(CC) -dynamiclib -flat_namespace -undefined suppress -o lib/liblua.$V.dylib src/*.lo -install_name $(INSTALL_LIB)/liblua.$V.dylib -compatibility_version $V -current_version $V
+	$(CC) -dynamiclib -flat_namespace -undefined suppress -o lib/liblualib.$V.dylib src/lib/*.lo -install_name $(INSTALL_LIB)/liblualib.$V.dylib -compatibility_version $V -current_version $V
+	cd lib; ln -fs liblua.$V.dylib liblua.dylib; ln -fs liblualib.$V.dylib liblualib.dylib
+	cd lib; ln -fs liblua.$V.dylib liblua.$(V:%.0=%).dylib; ln -fs liblualib.$V.dylib liblualib.$(V:%.0=%).dylib
+
 # binaries using shared libraries
 sobin:
 	rm -f bin/*
@@ -53,6 +59,11 @@
 	$(INSTALL_EXEC) lib/*.so.* $(INSTALL_LIB)
 	cd $(INSTALL_LIB); ln -fs liblua.so.$V liblua.so; ln -fs liblualib.so.$V liblualib.so
 
+dylibinstall:
+	$(INSTALL_EXEC) lib/*.dylib $(DESTDIR)$(INSTALL_LIB)
+	cd $(DESTDIR)$(INSTALL_LIB); ln -fs liblua.$V.dylib liblua.dylib; ln -fs liblualib.$V.dylib liblualib.dylib
+	cd $(DESTDIR)$(INSTALL_LIB); ln -fs liblua.$V.dylib liblua.$(V:%.0=%).dylib; ln -fs liblualib.$V.dylib liblualib.$(V:%.0=%).dylib
+
 # clean shared libraries
 soclean:
 	rm -f lib/*.so* bin/*
