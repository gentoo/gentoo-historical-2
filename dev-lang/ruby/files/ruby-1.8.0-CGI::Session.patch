diff -urN ruby-1.8.0.orig/lib/cgi/session/pstore.rb ruby-1.8.0/lib/cgi/session/pstore.rb
--- ruby-1.8.0.orig/lib/cgi/session/pstore.rb	2003-07-15 14:38:05.000000000 +0900
+++ ruby-1.8.0/lib/cgi/session/pstore.rb	2004-08-19 22:00:06.000000000 +0900
@@ -32,6 +32,9 @@
 	  @hash = {}
 	end
 	@p = ::PStore.new path 
+	@p.transaction do |p|
+	  File.chmod(0600, p.path)
+	end
       end
 
       def restore
diff -urN ruby-1.8.0.orig/lib/cgi/session.rb ruby-1.8.0/lib/cgi/session.rb
--- ruby-1.8.0.orig/lib/cgi/session.rb	2003-07-24 01:44:55.000000000 +0900
+++ ruby-1.8.0/lib/cgi/session.rb	2004-08-19 21:57:23.000000000 +0900
@@ -124,7 +124,7 @@
 	begin
 	  @f = open(path, "r+")
 	rescue Errno::ENOENT
-	  @f = open(path, "w+")
+	  @f = File.open(path, File::CREAT|File::RDWR, 0600)
 	end
       end
 
