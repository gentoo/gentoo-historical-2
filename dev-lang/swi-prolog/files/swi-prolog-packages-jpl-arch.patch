--- pl-5.6.5.orig/packages/jpl/ac/ac_jni_include_dirs.m4	2006-02-04 04:38:49.000000000 +1300
+++ pl-5.6.5/packages/jpl/ac/ac_jni_include_dirs.m4	2006-02-19 15:01:33.000000000 +1300
@@ -54,19 +54,23 @@
 done
 
 case "$host_cpu" in
-	i?86)	_JNI_LIBDIRS="i386"
-		_JNI_LIBSUBDIR="client"
-		;;
-	x86_64)	_JNI_LIBDIRS="amd64"
-		_JNI_LIBSUBDIR="server"
+	i?86)		_JNI_LIBDIRS="lib/i386"
+			_JNI_LIBSUBDIR="client"
+			;;
+	x86_64)		_JNI_LIBDIRS="lib/amd64"
+			_JNI_LIBSUBDIR="server"
+			;;
+	powerpc)	_JNI_LIBDIRS="bin lib/ppc"
+			_JNI_LIBSUBDIR="classic"
 		;;
 	*)	_JNI_LIBDIRS=""
 esac
 
 for d in $_JNI_LIBDIRS; do
-	echo "Trying $_JTOPDIR/jre/lib/$d/$_JNI_LIBSUBDIR"
-	if test -d $_JTOPDIR/jre/lib/$d/$_JNI_LIBSUBDIR; then
-		JNI_CLIENT_DIRS="$JNI_CLIENT_DIRS $_JTOPDIR/jre/lib/$d/$_JNI_LIBSUBDIR $_JTOPDIR/jre/lib/$d"
+	echo "Trying $_JTOPDIR/jre/$d/$_JNI_LIBSUBDIR"
+	if test -d $_JTOPDIR/jre/$d/$_JNI_LIBSUBDIR; then
+		JNI_CLIENT_DIRS="$JNI_CLIENT_DIRS $_JTOPDIR/jre/$d/$_JNI_LIBSUBDIR $_JTOPDIR/jre/$d"
+		JNI_LD_PATH="$_JTOPDIR/jre/$d"
  	fi
 done
 
--- pl-5.6.4.orig/packages/jpl/configure.in	2005-01-31 23:47:37.000000000 +1300
+++ pl-5.6.4/packages/jpl/configure.in	2006-02-13 23:18:33.000000000 +1300
@@ -18,6 +18,7 @@
 AC_SUBST(LDSOFLAGS)
 AC_SUBST(JAVA_HOME)
 AC_SUBST(JAVALIBS)
+AC_SUBST(JAVALDPATH)
 
 AC_ARG_ENABLE(mt, [  --enable-mt		  Enable Multi-threading],
 	      [case "$enableval" in
@@ -89,13 +89,16 @@
 	;;
 esac
 
+AC_CANONICAL_HOST			dnl needed to get $host_os
+
+if test "$host_cpu" = powerpc; then
+	JAVALIBS=`echo $JAVALIBS | sed 's/-lverify//'`
+fi
 
 dnl ================================================================
 dnl Java stuff
 dnl ================================================================
 
-AC_CANONICAL_HOST			dnl needed to get $host_os
-
 m4_include([ac/ac_prog_javac.m4])
 m4_include([ac/ac_prog_javac_works.m4])
 m4_include([ac/ac_jni_include_dirs.m4])
@@ -126,6 +129,8 @@
   CIFLAGS="$CIFLAGS -I$d"
 done
 
+JAVALDPATH=$JNI_LD_PATH
+
 for d in $JNI_CLIENT_DIRS; do
   LDSOFLAGS="$LDSOFLAGS -L$d"
 done
--- pl-5.6.4.orig/packages/jpl/Makefile.in	2006-02-04 04:38:49.000000000 +1300
+++ pl-5.6.4/packages/jpl/Makefile.in	2006-02-13 23:20:13.000000000 +1300
@@ -34,6 +34,7 @@
 JAVA_HOME=@JAVA_HOME@
 JAVAC=@JAVAC@
 JAVALIBS=@JAVALIBS@
+JAVALDPATH=@JAVALDPATH@
 
 DOCTOTEX=$(PCEHOME)/bin/doc2tex
 PLTOTEX=$(PCEHOME)/bin/pl2tex
@@ -68,7 +69,7 @@
 ################################################################
 
 check::		TestJPL.class
-		$(PL) -q -f check.pl -g test,halt -t 'halt(1)'
+		LD_LIBRARY_PATH=$(JAVALDPATH) $(PL) -q -f check.pl -g test,halt -t 'halt(1)'
 
 TestJPL.class:	TestJPL.java
 		$(JAVAC) -classpath jpl.jar TestJPL.java
