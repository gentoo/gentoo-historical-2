Index: xpdf-3.02/splash/SplashBitmap.cc
===================================================================
--- kpdf/xpdf/splash/SplashBitmap.cc
+++ kpdf/xpdf/splash/SplashBitmap.cc
@@ -44,7 +44,7 @@ SplashBitmap::SplashBitmap(int widthA, i
   }
   rowSize += rowPad - 1;
   rowSize -= rowSize % rowPad;
-  data = (SplashColorPtr)gmalloc(rowSize * height);
+  data = (SplashColorPtr)gmallocn(rowSize, height);
   if (!topDown) {
     data += (height - 1) * rowSize;
     rowSize = -rowSize;
