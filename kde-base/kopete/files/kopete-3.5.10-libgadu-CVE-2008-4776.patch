------------------------------------------------------------------------
r638 | wojtekka | 2008-10-23 23:50:29 +0200 (Thu, 23 Oct 2008) | 2 lines

Poprawka błędu analizowania pakietów GG_NOTIFY_REPLY* znalezionego przez Jakuba Zawadzkiego. Odpowiednio spreparowany pakiet wysłany przez serwer może spowodować naruszenie ochrony pamięci.

------------------------------------------------------------------------
Index: kopete-3.5.9/kopete/protocols/gadu/libgadu/events.c
===================================================================
--- kopete-3.5.9.orig/kopete/protocols/gadu/libgadu/events.c
+++ kopete-3.5.9/kopete/protocols/gadu/libgadu/events.c
@@ -598,7 +598,7 @@ static int gg_watch_fd_connected(struct 
 				if (GG_S_D(n->status)) {
 					unsigned char descr_len = *((char*) n + sizeof(struct gg_notify_reply60));
 
-					if (descr_len < length) {
+					if (sizeof(struct gg_notify_reply60) + descr_len <= length) {
 						if (!(e->event.notify60[i].descr = malloc(descr_len + 1))) {
 							gg_debug(GG_DEBUG_MISC, "// gg_watch_fd_connected() not enough memory for notify data\n");
 							goto fail;
