diff -Nur kdemultimedia-3.4.2.orig/juk/configure.in.bot kdemultimedia-3.4.2/juk/configure.in.bot
--- kdemultimedia-3.4.2.orig/juk/configure.in.bot	2005-05-23 14:07:04.000000000 +0200
+++ kdemultimedia-3.4.2/juk/configure.in.bot	2005-07-26 13:46:44.000000000 +0200
@@ -7,7 +7,7 @@
 	echo "**************************************************"
 fi
 
-if test "x$have_gst" = "xno"; then
+if test "x$with_gstreamer" = xcheck && test "x$have_gst" = xno; then
 	echo "**************************************************"
 	echo "*"
 	echo "* You do not seem to have GStreamer >= 0.8 installed."
@@ -19,7 +19,7 @@
 	echo "**************************************************"
 fi
 
-if test "x$have_musicbrainz" = "xfalse"; then
+if test "x$with_musicbrainz" = xcheck && test "x$have_musicbrainz" = xno; then
 	echo "**************************************************"
 	echo "*"
 	echo "* You do not seem to have libmusicbrainz and"
diff -Nur kdemultimedia-3.4.2.orig/juk/configure.in.in kdemultimedia-3.4.2/juk/configure.in.in
--- kdemultimedia-3.4.2.orig/juk/configure.in.in	2005-05-23 14:07:04.000000000 +0200
+++ kdemultimedia-3.4.2/juk/configure.in.in	2005-07-26 13:47:29.000000000 +0200
@@ -20,39 +20,60 @@
 AC_SUBST(LIB_ARTS)
 AC_SUBST(ARTS_CFLAGS)
 
-KDE_CHECK_HEADER(tunepimp/tp_c.h,
-[
-	AC_DEFINE(HAVE_MUSICBRAINZ, 1, [have MusicBrainz])
-	have_musicbrainz=true
-], [
-	AC_DEFINE(HAVE_MUSICBRAINZ, 0, [have MusicBrainz])
-	have_musicbrainz=false
-])
-
-AM_CONDITIONAL(link_lib_MB, test x$have_musicbrainz = xtrue)
-
-# pkg-config seems to have a bug where it masks needed -L entries when it
-# shouldn't, so disable that.
-
-PKG_CONFIG_ALLOW_SYSTEM_LIBS=1
-export PKG_CONFIG_ALLOW_SYSTEM_LIBS
-
-dnl start with 0.8
-GST_MAJORMINOR=0.8
-GST_REQ=0.8.0
-
-PKG_CHECK_MODULES(GST, \
-	gstreamer-$GST_MAJORMINOR >= $GST_REQ \
-	gstreamer-control-$GST_MAJORMINOR >= $GST_REQ \
-	gstreamer-libs-$GST_MAJORMINOR >= $GST_REQ,
-	have_gst=yes, have_gst=no)
+AC_ARG_WITH(musicbrainz,
+  [AC_HELP_STRING(--with-musicbrainz,
+    [enable support for MusicBrainz @<:@default=check@:>@])],
+  [], with_musicbrainz=check)
+
+have_musicbrainz=no
+if test "x$with_musicbrainz" != xno; then
+  KDE_CHECK_HEADER(tunepimp/tp_c.h, have_musicbrainz=yes)
+
+  if test "x$with_musicbrainz" != xcheck && test "x$have_musicbrainz" != xyes; then
+    AC_MSG_ERROR([--with-musicbrainz was given, but test for MusicBrainz failed])
+  fi
+fi
+
+if test "x$have_musicbrainz" = xyes; then
+  AC_DEFINE(HAVE_MUSICBRAINZ, 1, [have MusicBrainz])
+else
+  AC_DEFINE(HAVE_MUSICBRAINZ, 0, [have MusicBrainz])
+fi
+
+AM_CONDITIONAL(link_lib_MB, test "x$have_musicbrainz" = xyes)
+
+AC_ARG_WITH(gstreamer,
+  [AC_HELP_STRING(--with-gstreamer,
+    [enable support for GStreamer @<:@default=check@:>@])],
+  [], with_gstreamer=check)
+
+have_gst=no
+if test "x$with_gstreamer" != xno; then
+  # pkg-config seems to have a bug where it masks needed -L entries when it
+  # shouldn't, so disable that.
+
+  PKG_CONFIG_ALLOW_SYSTEM_LIBS=1
+  export PKG_CONFIG_ALLOW_SYSTEM_LIBS
+
+  dnl start with 0.8
+  GST_MAJORMINOR=0.8
+  GST_REQ=0.8.0
+
+  PKG_CHECK_MODULES(GST, \
+    gstreamer-$GST_MAJORMINOR >= $GST_REQ \
+    gstreamer-control-$GST_MAJORMINOR >= $GST_REQ \
+    gstreamer-libs-$GST_MAJORMINOR >= $GST_REQ,
+    have_gst=yes, have_gst=no)
+
+  if test "x$with_gstreamer" != xcheck && test "x$have_gst" != xyes; then
+    AC_MSG_ERROR([--with-gstreamer was given, but test for GStreamer failed])
+  fi
+fi
 
-dnl Give error if we don't have gstreamer
 if test "x$have_gst" = "xno"; then
 	GST_CFLAGS=""
 	LDADD_GST=""
 	LDFLAGS_GST=""
-	AC_MSG_WARN([GStreamer version >= $GST_REQ required.])
 	AC_DEFINE(HAVE_GSTREAMER, 0, [have GStreamer])
 else
 	LDADD_GST=`$PKG_CONFIG --libs-only-l gstreamer-$GST_MAJORMINOR`
@@ -63,13 +84,14 @@
 	LIBDIRS_GST=`$PKG_CONFIG --libs-only-L gstreamer-$GST_MAJORMINOR`
 	LDADD_GST="$LDADD_GST $LIBDIRS_GST"
 
-	AC_SUBST(GST_CFLAGS)
-	AC_SUBST(LDADD_GST)
-	AC_SUBST(LDFLAGS_GST)
 	AC_MSG_NOTICE([GStreamer version >= $GST_REQ found.])
 	AC_DEFINE(HAVE_GSTREAMER, 1, [have GStreamer])
 fi
 
+AC_SUBST(GST_CFLAGS)
+AC_SUBST(LDADD_GST)
+AC_SUBST(LDFLAGS_GST)
+
 if test "x$have_taglib" = "xfalse" || ( test "x$build_arts" = "xno" && test "x$have_gst" = "xno" ) ; then
 	DO_NOT_COMPILE="$DO_NOT_COMPILE juk"
 fi
diff -Nur kdemultimedia-3.4.2.orig/xine_artsplugin/configure.in.in kdemultimedia-3.4.2/xine_artsplugin/configure.in.in
--- kdemultimedia-3.4.2.orig/xine_artsplugin/configure.in.in	2005-05-23 14:07:11.000000000 +0200
+++ kdemultimedia-3.4.2/xine_artsplugin/configure.in.in	2005-07-26 13:44:34.000000000 +0200
@@ -238,8 +238,20 @@
 ])
 AC_CHECK_FUNC([ao_new_port])
 
-dnl Check for xine libs (1.0.0 or higher)
-AC_PATH_XINE(1.0.0,,
-[
+AC_ARG_WITH([xine],
+  [AC_HELP_STRING([--with-xine],
+    [Enable support for Xine @<:@default=check@:>@])],
+  [], with_xine=check)
+
+have_xine=no
+if test "x$with_xine" != xno; then
+  AC_PATH_XINE(1.0.0, have_xine=yes)
+
+  if test "x$with_xine" != xcheck && test "x$have_xine" != xyes; then
+    AC_MSG_ERROR([--with-xine was given, but test for Xine failed])
+  fi
+fi
+
+if test "x$have_xine" != xyes; then
   DO_NOT_COMPILE="$DO_NOT_COMPILE xine_artsplugin"
-])
+fi
