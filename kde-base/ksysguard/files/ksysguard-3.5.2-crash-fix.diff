--- branches/KDE/3.5/kdebase/ksysguard/gui/ksgrd/SensorShellAgent.cc	2005/09/29 13:24:25	465343
+++ branches/KDE/3.5/kdebase/ksysguard/gui/ksgrd/SensorShellAgent.cc	2006/03/27 09:04:59	523046
@@ -41,7 +41,7 @@
   if ( mDaemon ) {
     mDaemon->writeStdin( "quit\n", strlen( "quit\n" ) );
     delete (KShellProcess*)mDaemon;
-		mDaemon = 0;
+    mDaemon = 0;
   }
 }
 	
@@ -50,9 +50,9 @@
 {
   mDaemon = new KShellProcess;
 
-	setHostName( host );
-	mShell = shell;
-	mCommand = command;
+  setHostName( host );
+  mShell = shell;
+  mCommand = command;
 
   connect( mDaemon, SIGNAL( processExited( KProcess* ) ),
            SLOT( daemonExited( KProcess* ) ) );
@@ -84,7 +84,7 @@
 {
   shell = mShell;
   command = mCommand;
-	port = -1;
+  port = -1;
 }
 
 void SensorShellAgent::msgSent( KProcess* )
@@ -122,7 +122,8 @@
   sensorManager()->hostLost( this );
   sensorManager()->disengage( this );
 
-  process->deleteLater();
+  if ( mDaemon )
+    mDaemon->deleteLater();
 }
 
 bool SensorShellAgent::writeMsg( const char *msg, int len )
