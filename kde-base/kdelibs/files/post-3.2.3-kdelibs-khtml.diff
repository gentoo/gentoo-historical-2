--- khtml/khtml_ext.cpp	3 Aug 2004 14:38:41 -0000	1.85.2.3
+++ khtml/khtml_ext.cpp	8 Dec 2004 02:09:29 -0000
@@ -442,40 +442,44 @@ void KHTMLPopupGUIClient::slotSaveImageA
   saveURL( d->m_khtml->widget(), i18n( "Save Image As" ), d->m_imageURL, metaData );
 }
 
 void KHTMLPopupGUIClient::slotCopyLinkLocation()
 {
+  KURL safeURL(d->m_url);
+  safeURL.setPass(QString::null);
 #ifndef QT_NO_MIMECLIPBOARD
   // Set it in both the mouse selection and in the clipboard
   KURL::List lst;
-  lst.append( d->m_url );
+  lst.append( safeURL );
   QApplication::clipboard()->setSelectionMode(true);
   QApplication::clipboard()->setData( new KURLDrag( lst ) );
   QApplication::clipboard()->setSelectionMode(false);
   QApplication::clipboard()->setData( new KURLDrag( lst ) );
 #else
-  QApplication::clipboard()->setText( d->m_url.url() ); //FIXME(E): Handle multiple entries
+  QApplication::clipboard()->setText( safeURL.url() ); //FIXME(E): Handle multiple entries
 #endif
 }
 
 void KHTMLPopupGUIClient::slotStopAnimations()
 {
   d->m_khtml->stopAnimations();
 }
 
 void KHTMLPopupGUIClient::slotCopyImageLocation()
 {
+  KURL safeURL(d->m_imageURL);
+  safeURL.setPass(QString::null);
 #ifndef QT_NO_MIMECLIPBOARD
   // Set it in both the mouse selection and in the clipboard
   KURL::List lst;
-  lst.append( d->m_imageURL);
+  lst.append( safeURL );
   QApplication::clipboard()->setSelectionMode(true);
   QApplication::clipboard()->setData( new KURLDrag( lst ) );
   QApplication::clipboard()->setSelectionMode(false);
   QApplication::clipboard()->setData( new KURLDrag( lst ) );
 #else
-  QApplication::clipboard()->setText(d->m_imageURL.url()); //FIXME(E): Handle multiple entries
+  QApplication::clipboard()->setText( safeURL.url() ); //FIXME(E): Handle multiple entries
 #endif
 }
 
 void KHTMLPopupGUIClient::slotViewImage()
 {
--- khtml/khtml_part.cpp	8 Aug 2004 11:10:55 -0000	1.959.2.23
+++ khtml/khtml_part.cpp	8 Dec 2004 02:09:32 -0000
@@ -5465,10 +5465,12 @@ void KHTMLPart::khtmlMouseMoveEvent( kht
       // Text or image link...
       u = completeURL( d->m_strSelectedURL );
       pix = KMimeType::pixmapForURL(u, 0, KIcon::Desktop, KIcon::SizeMedium);
     }
 
+    u.setPass(QString::null);
+
     KURLDrag* urlDrag = new KURLDrag( u, img ? 0 : d->m_view->viewport() );
     if ( !d->m_referrer.isEmpty() )
       urlDrag->metaData()["referrer"] = d->m_referrer;
 
     if( img ) {

