--- branches/KDE/3.5/kdebase/kioslave/media/mediamanager/halbackend.cpp	2006/06/21 08:56:19	553501
+++ branches/KDE/3.5/kdebase/kioslave/media/mediamanager/halbackend.cpp	2006/07/26 08:18:37	566466
@@ -112,6 +112,14 @@
     DBusError error;
     dbus_error_init(&error);
     dbus_connection = dbus_connection_open_private(DBUS_SYSTEM_BUS, &error);
+
+    if (!dbus_connection || dbus_error_is_set(&error)) {
+        dbus_error_free(&error);
+        libhal_ctx_free(m_halContext);
+        m_halContext = NULL;
+        return false;
+    }
+
     dbus_bus_register(dbus_connection, &error);
 
     if (dbus_error_is_set(&error)) {
