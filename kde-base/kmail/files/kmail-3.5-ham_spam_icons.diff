diff -urN kdepim-3.5.0.old/kmail/kmail-3.5-filter-icons.pl kdepim-3.5.0/kmail/kmail-3.5-filter-icons.pl
--- kdepim-3.5.0.old/kmail/kmail-3.5-filter-icons.pl	1970-01-01 01:00:00.000000000 +0100
+++ kdepim-3.5.0/kmail/kmail-3.5-filter-icons.pl	2005-12-19 21:47:43.000000000 +0100
@@ -0,0 +1,22 @@
+#!/usr/bin/perl -w
+
+use strict;
+
+# This script updates some configuration keys
+
+# read the whole config file
+my $currentGroup = "";
+my %configFile;
+while ( <> ) {
+  chomp; # eat the trailing '\n'
+  next if ( /^$/ ); # skip empty lines
+  next if ( /^\#/ ); # skip comments
+  if ( /^\[/ ) { # group begin
+    $currentGroup = $_;
+    next;
+  } elsif ( $currentGroup =~ /^\[Filter #[0-9]+\]$/ && /^Icon=/ ) {
+    my ($key,$value) = split /=/;
+    print "# DELETE $currentGroup$key\n${currentGroup}\nIcon=mail_spam\n" if $value eq "mark_as_spam";
+    print "# DELETE $currentGroup$key\n${currentGroup}\nIcon=mail_ham\n" if $value eq "mark_as_ham";
+  }
+}
diff -urN kdepim-3.5.0.old/kmail/kmail.upd kdepim-3.5.0/kmail/kmail.upd
--- kdepim-3.5.0.old/kmail/kmail.upd	2005-09-10 10:24:01.000000000 +0200
+++ kdepim-3.5.0/kmail/kmail.upd	2005-12-19 21:31:18.000000000 +0100
@@ -158,6 +158,10 @@
 Id=3.4.1
 File=kmailrc
 Script=kmail-3.4.1-update-status-filters.pl,perl
+# Update icon names for spam/ham filters
+Id=3.5-filter-icons
+File=kmailrc
+Script=kmail-3.5-filter-icons.pl,perl
 #
 # Important notice:
 # If you add updates here, keep this text below them.
diff -urN kdepim-3.5.0.old/kmail/kmstartup.cpp kdepim-3.5.0/kmail/kmstartup.cpp
--- kdepim-3.5.0.old/kmail/kmstartup.cpp	2005-11-08 23:33:29.000000000 +0100
+++ kdepim-3.5.0/kmail/kmstartup.cpp	2005-12-19 21:21:00.000000000 +0100
@@ -113,7 +113,8 @@
     "3.4-misc",
     "3.4a",
     "3.4b",
-    "3.4.1"
+    "3.4.1",
+    "3.5-filter-icons"
   };
   static const int numUpdates = sizeof updates / sizeof *updates;
   // Warning: do not remove entries in the above array, or the update-level check below will break
diff -urN kdepim-3.5.0.old/kmail/Makefile.am kdepim-3.5.0/kmail/Makefile.am
--- kdepim-3.5.0.old/kmail/Makefile.am	2005-12-19 21:04:14.000000000 +0100
+++ kdepim-3.5.0/kmail/Makefile.am	2005-12-19 21:54:08.000000000 +0100
@@ -175,7 +175,8 @@
                 kmail-3.3-misc.pl \
                 kmail-3.3b1-misc.pl \
                 kmail-3.4-misc.pl \
-                kmail-3.4.1-update-status-filters.pl
+                kmail-3.4.1-update-status-filters.pl \
+		kmail-3.5-filter-icons.pl
 
 confdir = $(kde_confdir)
 conf_DATA = kmail.antispamrc kmail.antivirusrc
