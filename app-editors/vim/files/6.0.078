To: vim-dev@vim.org
Subject: Patch 6.0.078
Fcc: outbox
From: Bram Moolenaar <Bram@moolenaar.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
------------

Patch 6.0.078
Problem:    Using "daw" at the end of a line on a single-character word didn't
            include the white space before it.  At the end of the file it
            didn't work at all.  (Gavin Sinclair)
Solution:   Include the white space before the word.
Files:      src/search.c


*** ../vim60.77/src/search.c	Thu Nov  1 21:26:45 2001
--- src/search.c	Mon Nov  5 12:48:43 2001
***************
*** 2703,2718 ****
  	     * If the start is not on white space, and white space should be
  	     * included ("word	 "), or start is on white space and white
  	     * space should not be included ("	 "), find start of word.
  	     */
! 	    if (fwd_word(1L, bigword, TRUE) == FAIL)
! 		return FAIL;
! 	    /*
! 	     * If end is just past a new-line, we don't want to include the
! 	     * first character on the line
! 	     */
! 	    if (oneleft() == FAIL)	/* put cursor on last char of area */
! 		inclusive = FALSE;
! 	    else if (include)
  	    {
  		/*
  		 * If we don't include white space at the end, move the start
--- 2703,2718 ----
  	     * If the start is not on white space, and white space should be
  	     * included ("word	 "), or start is on white space and white
  	     * space should not be included ("	 "), find start of word.
+ 	     * If we end up in the first column of the next line (single char
+ 	     * word) back up to end of the line.
  	     */
! 	    fwd_word(1L, bigword, TRUE);
! 	    if (curwin->w_cursor.col == 0)
! 		decl(&curwin->w_cursor);
! 	    else
! 		oneleft();
! 
! 	    if (include)
  	    {
  		/*
  		 * If we don't include white space at the end, move the start
*** ../vim60.77/src/version.c	Mon Nov  5 12:51:06 2001
--- src/version.c	Mon Nov  5 13:11:50 2001
***************
*** 608,609 ****
--- 608,611 ----
  {   /* Add new patch number below this line */
+ /**/
+     78,
  /**/

-- 
The process for understanding customers primarily involves sitting around with
other marketing people and talking about what you would to if you were dumb
enough to be a customer.
				(Scott Adams - The Dilbert principle)

 ///  Bram Moolenaar -- Bram@moolenaar.net -- http://www.moolenaar.net  \\\
(((   Creator of Vim -- http://vim.sf.net -- ftp://ftp.vim.org/pub/vim   )))
 \\\  Help me helping AIDS orphans in Uganda - http://iccf-holland.org  ///
