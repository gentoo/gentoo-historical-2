To: vim-dev@vim.org
Subject: Patch 6.0.191
Fcc: outbox
From: Bram Moolenaar <Bram@moolenaar.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
------------

Patch 6.0.191
Problem:    When no servers are available serverlist() gives an error instead
	    of returning an empty string. (Hari Krishna)
Solution:   Don't give an error message.
Files:	    src/eval.c


*** ../vim60.190/src/eval.c	Mon Feb  4 22:45:19 2002
--- src/eval.c	Wed Feb  6 11:38:30 2002
***************
*** 5533,5539 ****
  # ifdef WIN32
      r = serverGetVimNames();
  # else
!     if (check_connection() == OK)
  	r = serverGetVimNames(X_DISPLAY);
  # endif
  #endif
--- 5533,5539 ----
  # ifdef WIN32
      r = serverGetVimNames();
  # else
!     if (X_DISPLAY != NULL)
  	r = serverGetVimNames(X_DISPLAY);
  # endif
  #endif
***************
*** 5564,5570 ****
      }
  # else
      retvar->var_val.var_number = 0;
!     if (!check_connection())
  	return;
  
      retvar->var_val.var_number = serverPeekReply(X_DISPLAY,
--- 5564,5570 ----
      }
  # else
      retvar->var_val.var_number = 0;
!     if (check_connection() == FAIL)
  	return;
  
      retvar->var_val.var_number = serverPeekReply(X_DISPLAY,
***************
*** 5623,5629 ****
  
      retvar->var_val.var_number = -1;
  # ifndef WIN32
!     if (!check_connection())
  	return;
  # endif
  
--- 5623,5629 ----
  
      retvar->var_val.var_number = -1;
  # ifndef WIN32
!     if (check_connection() == FAIL)
  	return;
  # endif
  
***************
*** 5658,5664 ****
  # endif
  
  # ifdef FEAT_X11
!     if (!check_connection())
  	return;
  # endif
  
--- 5658,5664 ----
  # endif
  
  # ifdef FEAT_X11
!     if (check_connection() == FAIL)
  	return;
  # endif
  
*** ../vim60.190/src/version.c	Wed Feb  6 10:54:18 2002
--- src/version.c	Wed Feb  6 11:44:19 2002
***************
*** 608,609 ****
--- 608,611 ----
  {   /* Add new patch number below this line */
+ /**/
+     191,
  /**/

-- 
hundred-and-one symptoms of being an internet addict:
243. You unsuccessfully try to download a pizza from www.dominos.com.

 ///  Bram Moolenaar -- Bram@moolenaar.net -- http://www.moolenaar.net  \\\
(((   Creator of Vim -- http://vim.sf.net -- ftp://ftp.vim.org/pub/vim   )))
 \\\  Help me helping AIDS orphans in Uganda - http://iccf-holland.org  ///
