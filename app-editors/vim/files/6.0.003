To: vim-dev@vim.org
Subject: Patch 6.0.003
Fcc: outbox
From: Bram Moolenaar <Bram@moolenaar.net>
------------

Patch 6.0.003
Problem:    The configure check for ACLs on AIX doesn't work.
Solution:   Fix the test program so that it compiles. (Tomas Ogren)
Files:	    src/configure.in, src/auto/configure


*** ../vim60.1/src/configure.in	Mon Sep 10 11:39:13 2001
--- src/configure.in	Thu Sep 27 22:19:52 2001
***************
*** 1760,1771 ****
  # include <sys/access.h>
  #endif
  #define _ALL_SOURCE
! #ifdef HAVE_SYS_STAT_H
! # include <sys/stat.h>
! #endif
  int aclsize;
  struct acl *aclent;], [aclsize = sizeof(struct acl);
! 	aclent = malloc(aclsize);
  	statacl("foo", STX_NORMAL, aclent, aclsize);
  	],
  	AC_MSG_RESULT(yes); AC_DEFINE(HAVE_AIX_ACL),
--- 1760,1771 ----
  # include <sys/access.h>
  #endif
  #define _ALL_SOURCE
! 
! #include <sys/stat.h>
! 
  int aclsize;
  struct acl *aclent;], [aclsize = sizeof(struct acl);
! 	aclent = (void *)malloc(aclsize);
  	statacl("foo", STX_NORMAL, aclent, aclsize);
  	],
  	AC_MSG_RESULT(yes); AC_DEFINE(HAVE_AIX_ACL),
*** ../vim60.1/src/auto/configure	Mon Sep 10 11:39:17 2001
--- src/auto/configure	Thu Sep 27 22:20:19 2001
***************
*** 6085,6098 ****
  # include <sys/access.h>
  #endif
  #define _ALL_SOURCE
! #ifdef HAVE_SYS_STAT_H
! # include <sys/stat.h>
! #endif
  int aclsize;
  struct acl *aclent;
  int main() {
  aclsize = sizeof(struct acl);
! 	aclent = malloc(aclsize);
  	statacl("foo", STX_NORMAL, aclent, aclsize);
  	
  ; return 0; }
--- 6085,6098 ----
  # include <sys/access.h>
  #endif
  #define _ALL_SOURCE
! 
! #include <sys/stat.h>
! 
  int aclsize;
  struct acl *aclent;
  int main() {
  aclsize = sizeof(struct acl);
! 	aclent = (void *)malloc(aclsize);
  	statacl("foo", STX_NORMAL, aclent, aclsize);
  	
  ; return 0; }
*** ../vim60.1/src/version.c	Thu Sep 27 22:16:49 2001
--- src/version.c	Thu Sep 27 22:17:59 2001
***************
*** 608,609 ****
--- 608,611 ----
  {   /* Add new patch number below this line */
+ /**/
+     3,
  /**/

-- 
Tips for aliens in New York: Land anywhere.  Central Park, anywhere.
No one will care or indeed even notice.
		-- Douglas Adams, "The Hitchhiker's Guide to the Galaxy"

 ///  Bram Moolenaar -- Bram@moolenaar.net -- http://www.moolenaar.net  \\\
(((   Creator of Vim -- http://vim.sf.net -- ftp://ftp.vim.org/pub/vim   )))
 \\\  Help me helping AIDS orphans in Uganda - http://iccf-holland.org  ///
