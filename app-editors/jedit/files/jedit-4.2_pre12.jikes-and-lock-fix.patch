diff -ur jEdit/jars/QuickNotepad/QuickNotepad.java /home/slava/jEdit/jars/QuickNotepad/QuickNotepad.java
--- jEdit/jars/QuickNotepad/QuickNotepad.java	Mon Apr 19 00:24:49 2004
+++ /home/slava/jEdit/jars/QuickNotepad/QuickNotepad.java	Fri Apr 30 16:23:08 2004
@@ -18,7 +18,7 @@
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
  *
- * $Id: jedit-4.2_pre12.jikes-and-lock-fix.patch,v 1.1 2004/05/03 03:06:05 anti Exp $
+ * $Id: jedit-4.2_pre12.jikes-and-lock-fix.patch,v 1.1 2004/05/03 03:06:05 anti Exp $
  */
 
 // from Java:
@@ -167,8 +167,8 @@
 		try
 		{
 			FileWriter out = new FileWriter(filename);
-			dos.write(textArea.getText());
-			dos.close();
+			out.write(textArea.getText());
+			out.close();
 		}
 		catch (IOException ioe)
 		{
diff -ur jEdit/modes/progress.xml /home/slava/jEdit/modes/progress.xml
--- jEdit/modes/progress.xml	Fri Feb  6 11:22:08 2004
+++ /home/slava/jEdit/modes/progress.xml	Thu Apr 29 11:03:22 2004
@@ -24,6 +24,8 @@
 <!-- 2004-01-26 PT Generated using Progress program for Progress 9.1D       -->
 <!-- 2004-02-04 PT Generated using Progress program for Open Edge 10.0A     -->
 <!-- 2004-02-06 PT Corrected due to validating errors against xmode.dtd     -->
+<!-- 2004-02-16 PT Fixed 'or choose of' being reported as invalid.          -->
+<!-- 2004-04-29 PT Added some appbuilder constants                          -->
 <!-- ====================================================================== -->
 <!-- Special thanks to Gerben and Stephen for their support.                -->
 <!-- ====================================================================== -->
@@ -877,7 +879,7 @@
       <MARK_FOLLOWING TYPE="INVALID">:REPOSITION-PARENT-RELATION</MARK_FOLLOWING>
 
     <!-- NON INVALID: Correction for non-invalid keywords -->
-      <SEQ_REGEXP TYPE="KEYWORD3" HASH_CHAR="o" AT_WORD_START="TRUE">on\s+choose</SEQ_REGEXP>
+      <SEQ_REGEXP TYPE="KEYWORD3" HASH_CHAR="c" AT_WORD_START="TRUE">choose\s+of</SEQ_REGEXP>
 
     <KEYWORDS>
       <!-- Keep the following sections in the specified order since -->
@@ -2624,6 +2626,7 @@
         <KEYWORD1>field-group</KEYWORD1>
         <KEYWORD1>file-info</KEYWORD1>
         <KEYWORD1>form</KEYWORD1>
+        <KEYWORD1>forward</KEYWORD1>
         <KEYWORD1>funct</KEYWORD1>
         <KEYWORD1>int</KEYWORD1>
         <KEYWORD1>info</KEYWORD1>
@@ -3658,62 +3661,80 @@
 
 
       <!-- COMMENT2   : Preprocessor statements -->
-        <COMMENT2>&amp;GLOB</COMMENT2>
-        <COMMENT2>&amp;GLOBAL-DEFINE</COMMENT2>
-        <COMMENT2>&amp;SCOP</COMMENT2>
-        <COMMENT2>&amp;SCOPED-DEFINE</COMMENT2>
-        <COMMENT2>&amp;UNDEFINE</COMMENT2>
-        <COMMENT2>&amp;ANALYZE-SUSPEND</COMMENT2>
-        <COMMENT2>&amp;ANALYZE-RESUME</COMMENT2>
-        <COMMENT2>&amp;IF</COMMENT2>
-        <COMMENT2>&amp;THEN</COMMENT2>
-        <COMMENT2>&amp;ELSE</COMMENT2>
-        <COMMENT2>&amp;ELSEIF</COMMENT2>
-        <COMMENT2>&amp;ENDIF</COMMENT2>
-        <COMMENT2>&amp;INCLUDE</COMMENT2>
-        <COMMENT2>&amp;MESSAGE</COMMENT2>
-        <COMMENT2>DEFINED</COMMENT2>
-        <COMMENT2>&amp;BATCH-MODE</COMMENT2>
-        <COMMENT2>&amp;FILE-NAME</COMMENT2>
-        <COMMENT2>&amp;LINE-NUMBER</COMMENT2>
-        <COMMENT2>&amp;OPSYS</COMMENT2>
-        <COMMENT2>&amp;SEQUENCE</COMMENT2>
-        <COMMENT2>&amp;WINDOW-SYSTEM</COMMENT2>
-        <COMMENT2>&amp;LIST-1</COMMENT2>
-        <COMMENT2>&amp;LIST-2</COMMENT2>
-        <COMMENT2>&amp;LIST-3</COMMENT2>
-        <COMMENT2>&amp;LIST-4</COMMENT2>
-        <COMMENT2>&amp;LIST-5</COMMENT2>
-        <COMMENT2>&amp;LIST-6</COMMENT2>
         <COMMENT2>&amp;ADM-CONTAINER</COMMENT2>
         <COMMENT2>&amp;ADM-SUPPORTED-LINKS</COMMENT2>
+        <COMMENT2>&amp;ANALYZE-RESUME</COMMENT2>
+        <COMMENT2>&amp;ANALYZE-SUSPEND</COMMENT2>
+        <COMMENT2>&amp;BATCH-MODE</COMMENT2>
         <COMMENT2>&amp;BROWSE-NAME</COMMENT2>
         <COMMENT2>&amp;DEFINED</COMMENT2>
         <COMMENT2>&amp;DISPLAYED-FIELDS</COMMENT2>
         <COMMENT2>&amp;DISPLAYED-OBJECTS</COMMENT2>
-        <COMMENT2>&amp;ENABLED-FIELDS</COMMENT2>
+        <COMMENT2>&amp;ELSE</COMMENT2>
+        <COMMENT2>&amp;ELSEIF</COMMENT2>
         <COMMENT2>&amp;ENABLED-FIELDS-IN-QUERY</COMMENT2>
+        <COMMENT2>&amp;ENABLED-FIELDS</COMMENT2>
         <COMMENT2>&amp;ENABLED-OBJECTS</COMMENT2>
-        <COMMENT2>&amp;ENABLED-TABLES</COMMENT2>
         <COMMENT2>&amp;ENABLED-TABLES-IN-QUERY</COMMENT2>
+        <COMMENT2>&amp;ENABLED-TABLES</COMMENT2>
+        <COMMENT2>&amp;ENDIF</COMMENT2>
         <COMMENT2>&amp;EXTERNAL-TABLES</COMMENT2>
-        <COMMENT2>&amp;FIELD-PAIRS</COMMENT2>
         <COMMENT2>&amp;FIELD-PAIRS-IN-QUERY</COMMENT2>
+        <COMMENT2>&amp;FIELD-PAIRS</COMMENT2>
         <COMMENT2>&amp;FIELDS-IN-QUERY</COMMENT2>
+        <COMMENT2>&amp;FILE-NAME</COMMENT2>
         <COMMENT2>&amp;FIRST-EXTERNAL-TABLE</COMMENT2>
         <COMMENT2>&amp;FIRST-TABLE-IN-QUERY</COMMENT2>
         <COMMENT2>&amp;FRAME-NAME</COMMENT2>
+        <COMMENT2>&amp;GLOB</COMMENT2>
+        <COMMENT2>&amp;GLOBAL-DEFINE</COMMENT2>
+        <COMMENT2>&amp;IF</COMMENT2>
+        <COMMENT2>&amp;INCLUDE</COMMENT2>
         <COMMENT2>&amp;INTERNAL-TABLES</COMMENT2>
         <COMMENT2>&amp;LAYOUT-VARIABLE</COMMENT2>
+        <COMMENT2>&amp;LINE-NUMBER</COMMENT2>
+        <COMMENT2>&amp;LIST-1</COMMENT2>
+        <COMMENT2>&amp;LIST-2</COMMENT2>
+        <COMMENT2>&amp;LIST-3</COMMENT2>
+        <COMMENT2>&amp;LIST-4</COMMENT2>
+        <COMMENT2>&amp;LIST-5</COMMENT2>
+        <COMMENT2>&amp;LIST-6</COMMENT2>
+        <COMMENT2>&amp;MESSAGE</COMMENT2>
         <COMMENT2>&amp;NEW</COMMENT2>
         <COMMENT2>&amp;OPEN-BROWSERS-IN-QUERY</COMMENT2>
         <COMMENT2>&amp;OPEN-QUERY</COMMENT2>
+        <COMMENT2>&amp;OPSYS</COMMENT2>
         <COMMENT2>&amp;PROCEDURE-TYPE</COMMENT2>
         <COMMENT2>&amp;QUERY-NAME</COMMENT2>
+        <COMMENT2>&amp;SCOP</COMMENT2>
+        <COMMENT2>&amp;SCOPED-DEFINE</COMMENT2>
         <COMMENT2>&amp;SELF-NAME</COMMENT2>
+        <COMMENT2>&amp;SEQUENCE</COMMENT2>
         <COMMENT2>&amp;TABLES-IN-QUERY</COMMENT2>
+        <COMMENT2>&amp;THEN</COMMENT2>
         <COMMENT2>&amp;UIB_is_Running</COMMENT2>
+        <COMMENT2>&amp;UNDEFINE</COMMENT2>
         <COMMENT2>&amp;WINDOW-NAME</COMMENT2>
+        <COMMENT2>&amp;WINDOW-SYSTEM</COMMENT2>
+        <COMMENT2>DEFINED</COMMENT2>
+        <COMMENT2>PROCEDURE-TYPE</COMMENT2>
+        <COMMENT2>_CREATE-WINDOW</COMMENT2>
+        <COMMENT2>_CUSTOM _DEFINITIONS</COMMENT2>
+        <COMMENT2>_CUSTOM _MAIN-BLOCK</COMMENT2>
+        <COMMENT2>_CUSTOM</COMMENT2>
+        <COMMENT2>_DEFINITIONS</COMMENT2>
+        <COMMENT2>_END-PROCEDURE-SETTINGS</COMMENT2>
+        <COMMENT2>_FUNCTION-FORWARD</COMMENT2>
+        <COMMENT2>_FUNCTION</COMMENT2>
+        <COMMENT2>_INCLUDED-LIB</COMMENT2>
+        <COMMENT2>_INLINE</COMMENT2>
+        <COMMENT2>_MAIN-BLOCK</COMMENT2>
+        <COMMENT2>_PROCEDURE-SETTINGS</COMMENT2>
+        <COMMENT2>_PROCEDURE</COMMENT2>
+        <COMMENT2>_UIB-CODE-BLOCK</COMMENT2>
+        <COMMENT2>_UIB-PREPROCESSOR-BLOCK</COMMENT2>
+        <COMMENT2>_VERSION-NUMBER</COMMENT2>
+        <COMMENT2>_XFTR</COMMENT2>
 
     </KEYWORDS>
   </RULES>
diff -ur jEdit/org/gjt/sp/jedit/buffer/KillRing.java /home/slava/jEdit/org/gjt/sp/jedit/buffer/KillRing.java
--- jEdit/org/gjt/sp/jedit/buffer/KillRing.java	Tue Apr 20 21:03:33 2004
+++ /home/slava/jEdit/org/gjt/sp/jedit/buffer/KillRing.java	Fri Apr 30 15:54:37 2004
@@ -166,7 +166,7 @@
 			{
 				out.write("<ENTRY>");
 				out.write(MiscUtilities.charsToEntities(
-					(String)model.getElementAt(i)));
+					model.getElementAt(i).toString()));
 				out.write("</ENTRY>");
 				out.write(lineSep);
 			}
@@ -338,7 +338,7 @@
 			else
 				rem = ring[count - index - 1];
 
-			return rem.str;
+			return rem;
 		}
 
 		public int getSize()
diff -ur jEdit/org/gjt/sp/jedit/buffer/UndoManager.java /home/slava/jEdit/org/gjt/sp/jedit/buffer/UndoManager.java
--- jEdit/org/gjt/sp/jedit/buffer/UndoManager.java	Wed Jul 23 02:08:54 2003
+++ /home/slava/jEdit/org/gjt/sp/jedit/buffer/UndoManager.java	Fri Apr 30 15:55:28 2004
@@ -35,7 +35,7 @@
  * called through, implements such protection.
  *
  * @author Slava Pestov
- * @version $Id: jedit-4.2_pre12.jikes-and-lock-fix.patch,v 1.1 2004/05/03 03:06:05 anti Exp $
+ * @version $Id: jedit-4.2_pre12.jikes-and-lock-fix.patch,v 1.1 2004/05/03 03:06:05 anti Exp $
  * @since jEdit 4.0pre1
  */
 public class UndoManager
@@ -373,6 +373,12 @@
 			if(mgr.redoClearDirty == this)
 				mgr.buffer.setDirty(false);
 			return offset;
+		} //}}}
+
+		//{{{ toString() method
+		public String toString()
+		{
+			return str;
 		} //}}}
 
 		UndoManager mgr;
diff -ur jEdit/org/gjt/sp/jedit/gui/PasteFromListDialog.java /home/slava/jEdit/org/gjt/sp/jedit/gui/PasteFromListDialog.java
--- jEdit/org/gjt/sp/jedit/gui/PasteFromListDialog.java	Fri Jun 20 21:15:05 2003
+++ /home/slava/jEdit/org/gjt/sp/jedit/gui/PasteFromListDialog.java	Fri Apr 30 15:53:24 2004
@@ -205,7 +205,7 @@
 			super.getListCellRendererComponent(list,value,index,
 				isSelected,cellHasFocus);
 
-			setText(shorten((String)value));
+			setText(shorten(value.toString()));
 
 			return this;
 		}
diff -ur jEdit/org/gjt/sp/jedit/pluginmgr/InstallPanel.java /home/slava/jEdit/org/gjt/sp/jedit/pluginmgr/InstallPanel.java
--- jEdit/org/gjt/sp/jedit/pluginmgr/InstallPanel.java	Fri Mar 26 12:16:18 2004
+++ /home/slava/jEdit/org/gjt/sp/jedit/pluginmgr/InstallPanel.java	Sat May  1 16:09:57 2004
@@ -638,8 +638,8 @@
 
 		public int compare(Object o1, Object o2)
 		{
-			Entry e1 = (Entry)o1;
-			Entry e2 = (Entry)o2;
+			InstallPanel.Entry e1 = (InstallPanel.Entry)o1;
+			InstallPanel.Entry e2 = (InstallPanel.Entry)o2;
 
 			if (type == NAME)
 				return e1.name.compareToIgnoreCase(e2.name);
@@ -653,7 +653,7 @@
 		}
 	} //}}}
 
-	//{{{ HeaderMouseHandler()
+	//{{{ HeaderMouseHandler class
 	class HeaderMouseHandler extends MouseAdapter
 	{
 		public void mouseClicked(MouseEvent evt)
diff -ur jEdit/org/gjt/sp/jedit/pluginmgr/ManagePanel.java /home/slava/jEdit/org/gjt/sp/jedit/pluginmgr/ManagePanel.java
--- jEdit/org/gjt/sp/jedit/pluginmgr/ManagePanel.java	Sat Nov 15 14:48:16 2003
+++ /home/slava/jEdit/org/gjt/sp/jedit/pluginmgr/ManagePanel.java	Sat May  1 16:08:17 2004
@@ -627,8 +627,8 @@
 
 		public int compare(Object o1, Object o2)
 		{
-			Entry e1 = (Entry)o1;
-			Entry e2 = (Entry)o2;
+			ManagePanel.Entry e1 = (ManagePanel.Entry)o1;
+			ManagePanel.Entry e2 = (ManagePanel.Entry)o2;
 
 			if (type == NAME)
 				return compareNames(e1,e2);
@@ -641,7 +641,7 @@
 			}
 		}
 
-		private int compareNames(Entry e1, Entry e2)
+		private int compareNames(ManagePanel.Entry e1, ManagePanel.Entry e2)
 		{
 			String s1, s2;
 			if(e1.name == null)
