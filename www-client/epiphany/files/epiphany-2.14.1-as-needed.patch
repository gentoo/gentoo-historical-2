--- m4/gecko.m4.orig	2006-05-02 21:06:28.000000000 +0200
+++ m4/gecko.m4	2006-05-02 21:06:42.000000000 +0200
@@ -319,9 +319,11 @@
 _SAVE_CPPFLAGS="$CPPFLAGS"
 _SAVE_CXXFLAGS="$CXXFLAGS"
 _SAVE_LDFLAGS="$LDFLAGS"
+_SAVE_LIBS="$LIBS"
 CPPFLAGS="$CPPFLAGS $_GECKO_EXTRA_CPPFLAGS -I$_GECKO_INCLUDE_ROOT $($PKG_CONFIG --cflags-only-I ${gecko_cv_gecko}-xpcom)"
 CXXFLAGS="$CXXFLAGS $_GECKO_EXTRA_CXXFLAGS $($PKG_CONFIG --cflags-only-other ${gecko_cv_gecko}-xpcom)"
-LDFLAGS="$LDFLAGS $_GECKO_EXTRA_LDFLAGS $($PKG_CONFIG --libs ${gecko_cv_gecko}-xpcom) -Wl,--rpath=$_GECKO_HOME"
+LDFLAGS="$LDFLAGS $_GECKO_EXTRA_LDFLAGS -Wl,--rpath=$_GECKO_HOME"
+LIBS="$LIBS $($PKG_CONFIG --libs ${gecko_cv_gecko}-xpcom)"
 
 _GECKO_DISPATCH_INCLUDEDIRS="$2"
 
@@ -340,6 +342,7 @@
 CPPFLAGS="$_SAVE_CPPFLAGS"
 CXXFLAGS="$_SAVE_CXXFLAGS"
 LDFLAGS="$_SAVE_LDFLAGS"
+LIBS="$_SAVE_LIBS"
 
 AC_LANG_POP([C++])
 
