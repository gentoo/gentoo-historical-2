diff -Nru squid-3.1.0.13.orig/src/HttpHeaderTools.cc squid-3.1.0.13/src/HttpHeaderTools.cc
--- squid-3.1.0.13.orig/src/HttpHeaderTools.cc	2009-08-04 15:32:12.000000000 +0200
+++ squid-3.1.0.13/src/HttpHeaderTools.cc	2009-08-22 11:59:17.000000000 +0200
@@ -229,6 +229,10 @@
 strListGetItem(const String * str, char del, const char **item, int *ilen, const char **pos)
 {
     size_t len;
+    /* ',' is always enabled as field delimiter as this is required for
+     * processing merged header values properly, even if Cookie normally
+     * uses ';' as delimiter.
+    */
     static char delim[3][8] = {
         "\"?,",
         "\"\\",
@@ -256,19 +260,16 @@
     do {
         *pos += strcspn(*pos, delim[quoted]);
 
-        if (**pos == del)
-            break;
-
         if (**pos == '"') {
             quoted = !quoted;
             *pos += 1;
-        }
-
-        if (quoted && **pos == '\\') {
+        } else if (quoted && **pos == '\\') {
             *pos += 1;
 
             if (**pos)
                 *pos += 1;
+        } else {
+            break;		/* Delimiter found, marking the end of this value */
         }
     } while (**pos);
 
