--- src/kernel/qapplication_x11.cpp.sav	2004-08-12 14:40:36.000000000 +0200
+++ src/kernel/qapplication_x11.cpp	2004-10-07 15:38:05.576444791 +0200
@@ -1345,7 +1345,7 @@ void qt_get_net_supported()
 			       False, XA_ATOM, &type, &format, &nitems, &after, &data);
 
 	    if (type == XA_ATOM && format == 32) {
-		ts.writeBlock((const char *) data, nitems * 4);
+		ts.writeBlock((const char *) data, nitems * sizeof(long));
 		offset += nitems;
 	    } else
 		after = 0;
@@ -4574,7 +4574,8 @@ bool QETWidget::translatePropertyEvent(c
 	if (max && !isMaximized()) {
 	    setWState(WState_Maximized);
 	    send_event = TRUE;
-	} else if (!max && isMaximized()) {
+	} else if (!max && isMaximized()
+            && (qt_net_supports(qt_net_wm_state_max_v) || qt_net_supports(qt_net_wm_state_max_h))) {
 	    clearWState(WState_Maximized);
 	    send_event = TRUE;
 	}
@@ -4582,7 +4583,7 @@ bool QETWidget::translatePropertyEvent(c
 	if (full && !isFullScreen()) {
 	    setWState(WState_FullScreen);
 	    send_event = TRUE;
-	} else if (!full && isFullScreen()) {
+	} else if (!full && isFullScreen() && qt_net_supports(qt_net_wm_state_fullscreen)) {
 	    clearWState(WState_FullScreen);
 	    send_event = TRUE;
 	}
