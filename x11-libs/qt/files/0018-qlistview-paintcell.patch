qt-bugs@ issue : 21865
applied: no
author: Pascal LÃ©tourneau <pletourn@globetrotter.net>

Sometimes, the last letter of a cell is not shown completely.

Index: src/widgets/qlistview.cpp
===================================================================
RCS file: /home/kde/qt-copy/src/widgets/qlistview.cpp,v
retrieving revision 1.60
diff -u -3 -p -r1.60 qlistview.cpp
--- src/widgets/qlistview.cpp	23 Jun 2003 11:48:55 -0000	1.60
+++ src/widgets/qlistview.cpp	1 Jul 2003 17:18:22 -0000
@@ -2011,7 +2011,7 @@ void QListViewItem::paintCell( QPainter 
 	    ci->truncated = FALSE;
 	    // if we have to do the ellipsis thingy calc the truncated text
 	    int pw = pixmap( column ) ? pixmap( column )->width() + lv->itemMargin() : lv->itemMargin();
-	    if ( !mlenabled && fm.width( t ) + pw > width ) {
+	    if ( !mlenabled && this->width( fm, lv, column ) > width ) {
 		// take care of arabic shaping in width calculation (lars)
 		ci->truncated = TRUE;
 		ci->tmpText = "...";
@@ -2023,7 +2023,7 @@ void QListViewItem::paintCell( QPainter 
 		if ( ci->tmpText.isEmpty() )
 		    ci->tmpText = t.left( 1 );
 		ci->tmpText += "...";
-	    } else if ( mlenabled && fm.width( t ) + pw > width ) {
+	    } else if ( mlenabled && this->width( fm, lv, column ) > width ) {
 #ifndef QT_NO_STRINGLIST
 		QStringList list = QStringList::split( QChar('\n'), t, TRUE );
 		for ( QStringList::Iterator it = list.begin(); it != list.end(); ++it ) {
