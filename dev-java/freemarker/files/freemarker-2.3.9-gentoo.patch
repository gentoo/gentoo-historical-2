diff -Nru freemarker-2.3.9.vanilla/build.xml freemarker-2.3.9/build.xml
--- freemarker-2.3.9.vanilla/build.xml	2007-03-09 15:38:44.000000000 +0100
+++ freemarker-2.3.9/build.xml	2007-03-17 15:21:33.000000000 +0100
@@ -60,11 +60,13 @@
     <path id="compile.classpath">
         <path refid="compile.nojsp.classpath"/>
         <pathelement path="${lib.servlet23}"/>
+        <fileset dir="lib/" includes="**/*.jar"/>
     </path>
 
     <path id="compile.jsp2.classpath">
         <path refid="compile.nojsp.classpath"/>
         <pathelement path="${lib.servlet24}"/>
+        <fileset dir="lib/" includes="**/*.jar"/>
     </path>
 
     <path id="compile.classpath.testcases">
@@ -72,6 +74,7 @@
         <pathelement path="${lib.jython}"/>
         <pathelement path="${lib.jdom}"/>
         <pathelement path="${lib.servlet23}"/>
+        <fileset dir="lib/" includes="**/*.jar"/>
     </path>
 
     <path id="compile.classpath.javadoc">
@@ -89,12 +92,14 @@
         <pathelement path="${src.dir}"/>
         <pathelement path="${build.javacc.dir}"/>
         <pathelement path="${java.class.path}"/>
+        <fileset dir="lib/" includes="**/*.jar"/>
     </path>
 
     <path id="compile.classpath.examples">
         <pathelement path="${lib.servlet23}"/>
         <pathelement path="${lib.dir}/freemarker.jar"/>
         <pathelement path="${lib.struts}"/>
+        <fileset dir="lib/" includes="**/*.jar"/>
     </path>
     
     <path id="full.classpath">
@@ -110,6 +115,7 @@
         <pathelement path="${lib.logkit}"/>
         <pathelement path="${lib.log4j}"/>
         <pathelement path="${java.class.path}"/>
+        <fileset dir="lib/" includes="**/*.jar"/>
     </path>
     
     
diff -Nru freemarker-2.3.9.vanilla/src/freemarker/ext/rhino/RhinoFunctionModel.java freemarker-2.3.9/src/freemarker/ext/rhino/RhinoFunctionModel.java
--- freemarker-2.3.9.vanilla/src/freemarker/ext/rhino/RhinoFunctionModel.java	2007-03-09 15:38:42.000000000 +0100
+++ freemarker-2.3.9/src/freemarker/ext/rhino/RhinoFunctionModel.java	2007-03-09 15:39:25.000000000 +0100
@@ -37,7 +37,11 @@
         for (int i = 0; i < args.length; i++) {
             args[i] = wrapper.unwrap((TemplateModel)args[i]);
         }
+        try {
         return wrapper.wrap(((Function)getScriptable()).call(cx, 
                 ScriptableObject.getTopLevelScope(fnThis), fnThis, args));
+        } catch (Exception e) {
+            throw new TemplateModelException(e);
+        }
     }
 }
