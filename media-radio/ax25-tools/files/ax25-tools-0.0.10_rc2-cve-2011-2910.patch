diff -Nur ax25-tools-0.0.10-rc2/ax25/ax25d.c ax25-tools/ax25/ax25d.c
--- ax25-tools-0.0.10-rc2/ax25/ax25d.c	2009-06-21 20:01:55.000000000 +0200
+++ ax25-tools/ax25/ax25d.c	2011-08-18 11:51:08.000000000 +0200
@@ -1,5 +1,5 @@
 /*
- * $Id: ax25-tools-0.0.10_rc2-cve-2011-2910.patch,v 1.1 2011/08/30 16:59:58 tomjbe Exp $
+ * $Id: ax25-tools-0.0.10_rc2-cve-2011-2910.patch,v 1.1 2011/08/30 16:59:58 tomjbe Exp $
  *
  *  This is my version of axl.c, written for the LBBS code to make it
  *    compatable with the kernel AX25 driver.  It appears to work, with
@@ -577,7 +577,7 @@
 							/* close link */
 							/* setproctitle("ax25d [%s]: disconnecting", User); */
 							close(new);
-							return 0;
+							exit(0);
 						}
 login:
 						/* setproctitle("ax25d [%s]: login", User); */
@@ -614,11 +614,15 @@
 							closelog();
 
 						/* Make root secure, before we exec() */
-						setgroups(0, grps);	/* Strip any supplementary gid's */
-						setgid(raxl->gid);
-						setuid(raxl->uid);
+						/* Strip any supplementary gid's */
+						if (setgroups(0, grps) == -1)
+							exit(1);
+						if (setgid(raxl->gid) == -1)
+							exit(1);
+						if (setuid(raxl->uid) == -1)
+							exit(1);
 						execve(raxl->exec, argv, NULL);
-						return 1;
+						exit(1);
 
 					default:
 						close(new);
diff -Nur ax25-tools-0.0.10-rc2/ax25/axspawn.c ax25-tools/ax25/axspawn.c
--- ax25-tools-0.0.10-rc2/ax25/axspawn.c	2009-06-21 20:01:55.000000000 +0200
+++ ax25-tools/ax25/axspawn.c	2011-08-18 12:43:49.000000000 +0200
@@ -1,10 +1,10 @@
 /*
  *
- * $Id: ax25-tools-0.0.10_rc2-cve-2011-2910.patch,v 1.1 2011/08/30 16:59:58 tomjbe Exp $
+ * $Id: ax25-tools-0.0.10_rc2-cve-2011-2910.patch,v 1.1 2011/08/30 16:59:58 tomjbe Exp $
  *
  * axspawn.c - run a program from ax25d.
  *
- * Copyright (c) 1996 Jörg Reuter DL1BKE (jreuter@poboxes.com)
+ * Copyright (c) 1996 Joerg Reuter DL1BKE (jreuter@poboxes.com)
  *
  * This program is a hack.
  * 
@@ -1693,7 +1693,11 @@
                 pututline(&ut_line);
                 endutent();
 
-		setsid();
+		/* become process group leader, if we not already are */
+		if (getpid() != getsid(0)) {
+			if (setsid() == -1)
+				exit(1);
+		}
 
                 chargc = 0;
                 envc = 0;
