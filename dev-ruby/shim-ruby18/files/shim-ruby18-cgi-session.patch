diff -urN shim.orig/ruby16/lib/cgi/session/pstore.rb shim/ruby16/lib/cgi/session/pstore.rb
--- shim.orig/ruby16/lib/cgi/session/pstore.rb	2003-11-01 01:38:20.000000000 +0900
+++ shim/ruby16/lib/cgi/session/pstore.rb	2004-08-20 02:16:59.000000000 +0900
@@ -70,6 +70,9 @@
 	  @hash = {}
 	end
 	@p = ::PStore.new(path)
+	@p.transaction do |p|
+	  File.chmod(0600, p.path)
+	end
       end
 
       # Restore session state from the session's PStore file.
diff -urN shim.orig/ruby16/lib/cgi/session.rb shim/ruby16/lib/cgi/session.rb
--- shim.orig/ruby16/lib/cgi/session.rb	2003-11-01 01:38:20.000000000 +0900
+++ shim/ruby16/lib/cgi/session.rb	2004-08-20 02:15:46.000000000 +0900
@@ -372,7 +372,7 @@
 	begin
 	  @f = open(path, "r+")
 	rescue Errno::ENOENT
-	  @f = open(path, "w+")
+	  @f = File.open(path, File::CREAT|File::RDWR, 0600)
 	end
       end
 
