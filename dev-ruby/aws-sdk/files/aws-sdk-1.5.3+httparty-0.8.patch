From 40d0d8c581026ad07bf94897b974b05d6b0542ef Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Diego=20Elio=20Petten=C3=B2?= <flameeyes@flameeyes.eu>
Date: Fri, 15 Jun 2012 06:21:04 -0700
Subject: [PATCH] httparty_handler: do not dereference a nil object.
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This might be required to support httparty 0.8 (which is in the
dependencies as it is).

Signed-off-by: Diego Elio Petten√≤ <flameeyes@flameeyes.eu>
---
 lib/aws/core/http/httparty_handler.rb |    9 +++++----
 1 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/lib/aws/core/http/httparty_handler.rb b/lib/aws/core/http/httparty_handler.rb
index 46b3c9c..f2fea30 100644
--- a/lib/aws/core/http/httparty_handler.rb
+++ b/lib/aws/core/http/httparty_handler.rb
@@ -92,12 +92,13 @@ module AWS
   
           begin
             http_response = self.class.send(method, url, opts)
+            unless http_response.nil?
+              response.body = http_response.body
+              response.status = http_response.code.to_i
+              response.headers = http_response.to_hash
+            end
           rescue Timeout::Error, Errno::ETIMEDOUT => e
             response.timeout = true
-          else
-            response.body = http_response.body
-            response.status = http_response.code.to_i
-            response.headers = http_response.to_hash
           end
         end
       end
-- 
1.7.8.6

