Index: xdr_array.c
===================================================================
RCS file: /cvs/krbdev/krb5/src/lib/rpc/xdr_array.c,v
retrieving revision 1.5
diff -c -r1.5 xdr_array.c
*** xdr_array.c	1998/02/14 02:27:23	1.5
--- xdr_array.c	2002/08/02 17:25:05
***************
*** 75,81 ****
  		return (FALSE);
  	}
  	c = *sizep;
! 	if ((c > maxsize) && (xdrs->x_op != XDR_FREE)) {
  		return (FALSE);
  	}
  	nodesize = c * elsize;
--- 75,82 ----
  		return (FALSE);
  	}
  	c = *sizep;
! 	if ((c > maxsize || c > LASTUNSIGNED / elsize)
! 	    && (xdrs->x_op != XDR_FREE)) {
  		return (FALSE);
  	}
  	nodesize = c * elsize;
