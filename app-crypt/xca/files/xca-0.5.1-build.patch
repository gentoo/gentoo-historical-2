diff -urNp xca-0.5.1.org/configure xca-0.5.1/configure
--- xca-0.5.1.org/configure	2004-04-23 11:22:57.000000000 +0300
+++ xca-0.5.1/configure	2006-10-26 22:23:56.000000000 +0200
@@ -66,9 +66,11 @@ add_lib() {
 search_includes() {
   for dir in ${DIRS};  do
     for dbn in "" ${subdirs}; do
-      if test -r ${dir}/include${dbn}/$1; then
-          add_include ${dir}/include${dbn}
-          echo Found:  $1 at ${dir}/include${dbn}
+      for inc_path in `ls -dr "${dir}"/include${dbn} 2> /dev/null`; do
+          if test -r "${inc_path}/$1"; then
+              add_include "${inc_path}"
+              echo "Found:  $1 at ${inc_path}"
-          return 0
+              return 0
+          fi
+      done
-      fi
     done
@@ -81,9 +81,9 @@ search_lib() {
   for dir in ${DIRS};  do
     for dbn in $@; do
       for suffix in so dylib obj; do
-        if test -r ${dir}/lib/lib${dbn}.${suffix}; then
-          add_lib ${dir}/lib ${dbn};
-	  echo Found: lib${dbn}.${suffix} at ${dir}/lib
+        if test -r "${dir}/lib/lib${dbn}.${suffix}"; then
+          add_lib "${dir}/lib" "${dbn}";
+	  echo "Found: lib${dbn}.${suffix} at ${dir}/lib"
           return 0
 	fi
       done
@@ -94,7 +94,7 @@ search_lib() {
  
 
 ######################## DB
-subdirs="/db /db4 /db3"
+subdirs="/db4.?"
 search_includes db_cxx.h || err "The Berkeley DB header files were not found"
 search_lib db_cxx db4_cxx db_cxx-4 db3_cxx db_cxx-3 || err "The Berkeley DB library was not found. Try installing db-dev" 
 ## The fun of NPTL... (Thx Enrico Scholz)
@@ -144,11 +144,11 @@ fi
 
 
 
-if test -x $QTDIR/bin/moc; then
+if test -x "$QTDIR/bin/moc"; then
   MOC="$QTDIR/bin/moc"
 fi
 
-if test -x $QTDIR/bin/uic; then
+if test -x "$QTDIR/bin/uic"; then
   UIC="$QTDIR/bin/uic"
 fi
 
@@ -160,22 +160,22 @@ echo "CFLAGS    :${CFLAGS:=-Wall}"

 for dirs in /bin /usr/bin /usr/local/bin /sw/bin; do
   for make in gmake make; do
-    if ${dirs}/${make} -v 2>/dev/null | grep GNU; then
-      mak=${dirs}/${make}
+    if "${dirs}/${make}" -v 2>/dev/null | grep GNU; then
+      mak="${dirs}/${make}"
     fi
   done  
 done
 
 echo
 if test ! -z "${mak}"; then
-  echo A usable "make" executable was found in ${mak}
+  echo "A usable "make" executable was found in ${mak}"
 else
-  echo No usable "make" executable found.
+  echo "No usable "make" executable found."
 fi
 echo
 
 if test "x${err_occ}" = "xY"; then
   echo
-  echo An error occured. Please edit 'Local.mak' manually if compiling fails.
+  echo "An error occured. Please edit 'Local.mak' manually if compiling fails."
 fi
 
diff -urNp xca-0.5.1.org/Rules.mak xca-0.5.1/Rules.mak
--- xca-0.5.1.org/Rules.mak	2004-04-15 02:36:54.000000000 +0300
+++ xca-0.5.1/Rules.mak	2006-10-26 22:20:04.000000000 +0200
@@ -2,8 +2,8 @@ include $(TOPDIR)/Local.mak
 
 all: target.obj
 
-ifneq ($(prefix),)
-  CFLAGS+= -DPREFIX=\"$(prefix)\"
+ifneq ($(inst_prefix),)
+  CFLAGS+= -DPREFIX=\"$(inst_prefix)\"
 endif
 
 ifneq ($(basedir),)
