--- openssl_tpm_engine-0.3/configure.in	2005-12-03 06:03:27.000000000 +1100
+++ /tmp/configure.in	2006-05-07 13:17:55.000000000 +1000
@@ -21,7 +21,12 @@
 	fi
 fi
 
-OPENSSL_LIB_DIR="/usr/local/ssl/lib"
+if test "${OPENSSL_LIB_DIR+set}" != set; then
+	OPENSSL_LIB_DIR="/usr/local/ssl/lib"
+fi
+if test "${OPENSSL_INCLUDE_DIR+set}" != set; then
+	OPENSSL_INCLUDE_DIR="/usr/local/ssl/include"
+fi
 
 # Non-standard OpenSSL
 AC_MSG_CHECKING([Non-standard OpenSSL])
@@ -36,8 +41,8 @@
 		CFLAGS="$CFLAGS -L$OPENSSL_LIB_DIR -I$OPENSSL_INCLUDE_DIR"
 	 fi],
 	[AC_MSG_RESULT([no])
-	 AC_SUBST([OPENSSL_LIB_DIR], [/usr/local/ssl/lib])
-	 AC_SUBST([OPENSSL_INCLUDE_DIR], [/usr/local/ssl/include]) ] )
+	 AC_SUBST(OPENSSL_LIB_DIR)
+	 AC_SUBST(OPENSSL_INCLUDE_DIR)])
 
 # for the correct install target
 libdir="$OPENSSL_LIB_DIR/engines"
--- openssl_tpm_engine-0.3/Makefile.am.orig	2006-05-07 13:49:41.000000000 +1000
+++ openssl_tpm_engine-0.3/Makefile.am	2006-05-07 13:58:10.000000000 +1000
@@ -1,10 +1,11 @@
+EXTRA_DIST = README  openssl.cnf.sample
+
 lib_LTLIBRARIES=libtpm.la
-noinst_PROGRAMS=create_tpm_key
+bin_PROGRAMS=create_tpm_key
 
-libtpm_la_LIBADD=@OPENSSL_LIB_DIR@/libcrypto.a
-libtpm_la_LDFLAGS=-lc
+libtpm_la_LIBADD=-lcrypto -lc
 libtpm_la_CFLAGS=-I@OPENSSL_INCLUDE_DIR@
 libtpm_la_SOURCES=e_tpm.c e_tpm.h e_tpm_err.c
 
 create_tpm_key_SOURCES=create_tpm_key.c
-create_tpm_key_LDFLAGS=-ltspi
+create_tpm_key_LDADD=-ltspi
