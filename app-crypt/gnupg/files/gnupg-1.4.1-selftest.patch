--- gnupg-1.4.1/g10/openfile.c.orig	2004-10-14 17:11:56.000000000 +1000
+++ gnupg-1.4.1/g10/openfile.c	2005-06-28 22:27:52.611861217 +1000
@@ -392,8 +392,10 @@
      * To cope with HOME, we do compare only the suffix if we see that
      * the default homedir does start with a tilde.
      */
+#ifndef ENABLE_SELINUX_HACKS
     if( opt.dry_run || opt.no_homedir_creation )
 	return;
+#endif
 
     if ( ( *defhome == '~'
            && ( strlen(fname) >= strlen (defhome+1)
--- gnupg-1.4.1/checks/Makefile.in.orig	2005-03-16 01:52:20.000000000 +1000
+++ gnupg-1.4.1/checks/Makefile.in	2005-06-29 00:04:24.613682330 +1000
@@ -516,9 +516,11 @@
 
 ./gpg_dearmor:
 	echo '#!/bin/sh' >./gpg_dearmor
-	echo "../g10/gpg --no-options --no-greeting \
+	echo "../g10/gpg --no-options --no-greeting --homedir . \
              --no-secmem-warning --batch --dearmor" >>./gpg_dearmor
 	chmod 755 ./gpg_dearmor
+	if test ! -f ./pubring.gpg; then touch -t 197001020000 ./pubring.gpg; fi
+	if test ! -f ./secring.gpg; then touch -t 197001020000 ./secring.gpg; fi
 
 ./pubring.gpg: $(srcdir)/pubring.asc $(srcdir)/pubdemo.asc ./gpg_dearmor
 	./gpg_dearmor > ./pubring.gpg < $(srcdir)/pubring.asc
