--- gnupg-1.4.7-ecc0.1.8.diff	2007-12-20 21:24:04.000000000 +0200
+++ gnupg-1.4.8-ecc0.1.8.diff	2007-12-20 21:23:30.000000000 +0200
@@ -1914,48 +1914,48 @@ diff -Nru gnupg-1.4.7/cipher/Makefile.am
  
  if USE_RNDLINUX
  libcipher_a_SOURCES+=rndlinux.c
-diff -Nru gnupg-1.4.7/cipher/Makefile.in gnupg-1.4.7-ecc/cipher/Makefile.in
---- gnupg-1.4.7/cipher/Makefile.in	2007-03-05 10:44:42.000000000 +0100
-+++ gnupg-1.4.7-ecc/cipher/Makefile.in	2007-11-08 22:24:55.000000000 +0100
-@@ -96,7 +96,7 @@
- 	elgamal.c elgamal.h rsa.c rsa.h primegen.c random.h random.c \
- 	rand-internal.h rmd.h dsa.h dsa.c smallprime.c algorithms.h \
- 	md5.c rmd160.c sha1.c sha256.c rndlinux.c rndunix.c rndegd.c \
--	rndw32.c sha512.c
-+	rndw32.c sha512.c ecc.c
+diff -urNp gnupg-1.4.8/cipher/Makefile.in gnupg-1.4.8.ecc/cipher/Makefile.in
+--- gnupg-1.4.8/cipher/Makefile.in	2007-12-20 09:54:08.000000000 +0200
++++ gnupg-1.4.8.ecc/cipher/Makefile.in	2007-12-20 21:16:08.000000000 +0200
+@@ -93,7 +93,7 @@ am__libcipher_a_SOURCES_DIST = cipher.c 
+ 	camellia.c camellia.h camellia-glue.c elgamal.c elgamal.h \
+ 	rsa.c rsa.h primegen.c random.h random.c rand-internal.h rmd.h \
+ 	dsa.h dsa.c smallprime.c algorithms.h md5.c rmd160.c sha1.c \
+-	sha256.c rndlinux.c rndunix.c rndegd.c rndw32.c sha512.c
++	sha256.c rndlinux.c rndunix.c rndegd.c rndw32.c sha512.c ecc.c
  @USE_RNDLINUX_TRUE@am__objects_1 = rndlinux.$(OBJEXT)
  @USE_RNDUNIX_TRUE@am__objects_2 = rndunix.$(OBJEXT)
  @USE_RNDEGD_TRUE@am__objects_3 = rndegd.$(OBJEXT)
-@@ -107,7 +107,7 @@
- 	blowfish.$(OBJEXT) cast5.$(OBJEXT) rijndael.$(OBJEXT) \
- 	elgamal.$(OBJEXT) rsa.$(OBJEXT) primegen.$(OBJEXT) \
- 	random.$(OBJEXT) dsa.$(OBJEXT) smallprime.$(OBJEXT) \
--	md5.$(OBJEXT) rmd160.$(OBJEXT) sha1.$(OBJEXT) sha256.$(OBJEXT) \
-+	md5.$(OBJEXT) rmd160.$(OBJEXT) sha1.$(OBJEXT) sha256.$(OBJEXT) ecc.$(OBJEXT) \
+@@ -105,7 +105,7 @@ am_libcipher_a_OBJECTS = cipher.$(OBJEXT
+ 	camellia.$(OBJEXT) camellia-glue.$(OBJEXT) elgamal.$(OBJEXT) \
+ 	rsa.$(OBJEXT) primegen.$(OBJEXT) random.$(OBJEXT) \
+ 	dsa.$(OBJEXT) smallprime.$(OBJEXT) md5.$(OBJEXT) \
+-	rmd160.$(OBJEXT) sha1.$(OBJEXT) sha256.$(OBJEXT) \
++	rmd160.$(OBJEXT) sha1.$(OBJEXT) sha256.$(OBJEXT) ecc.$(OBJEXT) \
  	$(am__objects_1) $(am__objects_2) $(am__objects_3) \
  	$(am__objects_4) $(am__objects_5)
  libcipher_a_OBJECTS = $(am_libcipher_a_OBJECTS)
-@@ -325,7 +325,7 @@
- 	twofish.c blowfish.c cast5.c rijndael.c elgamal.c elgamal.h \
- 	rsa.c rsa.h primegen.c random.h random.c rand-internal.h rmd.h \
- 	dsa.h dsa.c smallprime.c algorithms.h md5.c rmd160.c sha1.c \
--	sha256.c $(am__append_2) $(am__append_3) $(am__append_4) \
-+	sha256.c ecc.c $(am__append_2) $(am__append_3) $(am__append_4) \
+@@ -302,7 +302,7 @@ libcipher_a_SOURCES = cipher.c pubkey.c 
+ 	twofish.c blowfish.c cast5.c rijndael.c camellia.c camellia.h \
+ 	camellia-glue.c elgamal.c elgamal.h rsa.c rsa.h primegen.c \
+ 	random.h random.c rand-internal.h rmd.h dsa.h dsa.c \
+-	smallprime.c algorithms.h md5.c rmd160.c sha1.c sha256.c \
++	smallprime.c algorithms.h md5.c rmd160.c sha1.c sha256.c ecc.c \
+ 	$(am__append_2) $(am__append_3) $(am__append_4) \
  	$(am__append_5) $(am__append_6)
  EXTRA_libcipher_a_SOURCES = idea-stub.c
- libcipher_a_DEPENDENCIES = @IDEA_O@
-@@ -402,6 +402,7 @@
+@@ -382,6 +382,7 @@ distclean-compile:
  @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/sha512.Po@am__quote@
  @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/smallprime.Po@am__quote@
  @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/twofish.Po@am__quote@
 +@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/ecc.Po@am__quote@
  
  .c.o:
- @am__fastdepCC_TRUE@	if $(COMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
-diff -Nru gnupg-1.4.7/cipher/pubkey.c gnupg-1.4.7-ecc/cipher/pubkey.c
---- gnupg-1.4.7/cipher/pubkey.c	2005-07-27 19:02:55.000000000 +0200
-+++ gnupg-1.4.7-ecc/cipher/pubkey.c	2007-11-08 22:24:55.000000000 +0100
-@@ -33,6 +33,9 @@
+ @am__fastdepCC_TRUE@	$(COMPILE) -MT $@ -MD -MP -MF $(DEPDIR)/$*.Tpo -c -o $@ $<
+diff -urNp gnupg-1.4.8/cipher/pubkey.c gnupg-1.4.8.ecc/cipher/pubkey.c
+--- gnupg-1.4.8/cipher/pubkey.c	2007-12-12 20:06:55.000000000 +0200
++++ gnupg-1.4.8.ecc/cipher/pubkey.c	2007-12-20 21:13:31.000000000 +0200
+@@ -31,6 +31,9 @@
  #include "elgamal.h"
  #include "dsa.h"
  #include "rsa.h"
@@ -2311,25 +2311,23 @@ diff -Nru gnupg-1.4.7/g10/keyid.c gnupg-
        default: return '?';
      }
  }
-diff -Nru gnupg-1.4.7/g10/mainproc.c gnupg-1.4.7-ecc/g10/mainproc.c
---- gnupg-1.4.7/g10/mainproc.c	2007-03-05 10:08:41.000000000 +0100
-+++ gnupg-1.4.7-ecc/g10/mainproc.c	2007-11-08 22:24:55.000000000 +0100
-@@ -399,7 +399,10 @@
-     }
+diff -urNp gnupg-1.4.8/g10/mainproc.c gnupg-1.4.8.ecc/g10/mainproc.c
+--- gnupg-1.4.8/g10/mainproc.c	2007-12-12 19:44:49.000000000 +0200
++++ gnupg-1.4.8.ecc/g10/mainproc.c	2007-12-20 21:17:33.000000000 +0200
+@@ -404,6 +404,9 @@ proc_pubkey_enc( CTX c, PACKET *pkt )
      else if( is_ELGAMAL(enc->pubkey_algo)
- 	|| enc->pubkey_algo == PUBKEY_ALGO_DSA
--	|| is_RSA(enc->pubkey_algo)  ) {
-+	|| is_RSA(enc->pubkey_algo)
-+/*begin ECC mod*/
-+        || is_ECC(enc->pubkey_algo) ) {
-+/*end ECC mod*/
-       /* FIXME:  strore this all in a list and process it later */
- 
- 	if ( !c->dek && ((!enc->keyid[0] && !enc->keyid[1])
-diff -Nru gnupg-1.4.7/g10/misc.c gnupg-1.4.7-ecc/g10/misc.c
---- gnupg-1.4.7/g10/misc.c	2006-06-30 11:01:49.000000000 +0200
-+++ gnupg-1.4.7-ecc/g10/misc.c	2007-11-08 22:24:55.000000000 +0100
-@@ -421,6 +421,11 @@
+              || enc->pubkey_algo == PUBKEY_ALGO_DSA
+              || is_RSA(enc->pubkey_algo)  
++/*begin ECC mod*/
++             || is_ECC(enc->pubkey_algo)
++/*end ECC mod*/
+              || (RFC2440 && enc->pubkey_algo == PUBKEY_ALGO_ELGAMAL)) {
+       /* Note that we also allow type 20 Elgamal keys for decryption.
+          There are still a couple of those keys in active use as a
+diff -urNp gnupg-1.4.8/g10/misc.c gnupg-1.4.8.ecc/g10/misc.c
+--- gnupg-1.4.8/g10/misc.c	2007-12-12 19:35:18.000000000 +0200
++++ gnupg-1.4.8.ecc/g10/misc.c	2007-12-20 21:13:31.000000000 +0200
+@@ -433,6 +433,11 @@ openpgp_pk_algo_usage ( int algo )
        case PUBKEY_ALGO_DSA:  
            use = PUBKEY_USAGE_CERT | PUBKEY_USAGE_SIG | PUBKEY_USAGE_AUTH;
            break;
