diff -urN gentoo-bashcomp-20050117.orig/gentoo gentoo-bashcomp-20050117/gentoo
--- gentoo-bashcomp-20050117.orig/gentoo	2005-01-31 03:41:52.876228512 -0500
+++ gentoo-bashcomp-20050117/gentoo	2005-01-31 04:07:55.467678504 -0500
@@ -750,7 +750,8 @@
 	for i in "${COMP_WORDS[@]}"; do
 		if [ $j -lt $COMP_CWORD ]; then
 			j=$((j + 1))
-			case $i in @(belongs|ch@(anges|eck)|dep@(ends|graph)|files|glsa|list|s@(ize|tats)|uses|which|hasuse))
+			case $i in
+                            @(belongs|ch@(anges|eck)|dep@(ends|graph)|files|glsa|list|s@(ize|tats)|uses|which|hasuse|b|c|k|d|g|f|a|h|l|s|t|u|w))
 				mode=$i
 				;;
 			esac
@@ -769,11 +770,11 @@
 					;;
 			esac
 			;;
-		changes|glsa|stats)
+		c?(hanges)|a|glsa|t|stats)
 			# These commands have not been implemented in 'equery' yet ...
 			echo -n "# Not implemented! "
 			;;
-		files)
+		f?(iles))
 			# Only complete if the previous entry on the command line is not
 			# a package name.
 			if [[ ${prev} == ${mode} || ${prev:0:1} == "-" ]]; then
@@ -788,7 +789,7 @@
 				esac
 			fi
 			;;
-		list)
+		l?(ist))
 			# Only complete if the previous entry on the command line is not
 			# a package name.
 			if [[ ${prev} == ${mode} || ${prev:0:1} == "-" ]]; then
@@ -803,7 +804,7 @@
 				esac
 			fi
 			;;
-		belongs)
+		b?(elongs))
 			# Only complete if the previous entry on the command line is not
 			# a file name.
 			if \
@@ -823,8 +824,8 @@
 						COMPREPLY=($(compgen -W "-c --category -e --earlyout" -- $cur))
 						;;
 					*)
-						# Complete filenames. Function defined in /etc/bash_completion.
-						_filedir
+                                                COMPREPLY=($(compgen -f -- $cur) \
+                                                    $(compgen -d -S '/' -- $cur))
 						;;
 				esac
 			# Are we completing a category?
@@ -832,7 +833,7 @@
 				COMPREPLY=($(cd ${portdir}/metadata/cache; compgen -W "$(compgen -G '*')" -- $cur))
 			fi
 			;;
-		uses|which)
+		@(u?(ses)|w?(hich)))
 			# Only complete if the previous entry on the command line is not
 			# a package name.
 			if [[ ${prev} == ${mode} ]]; then
@@ -840,7 +841,7 @@
 				_pkgname -A $cur
 			fi
 			;;
-		depgraph)
+		g|depgraph)
 			# Only complete if the previous entry on the command line is not
 			# a package name.
 			if [[ ${prev} == ${mode} || ${prev:0:1} == "-" ]]; then
@@ -855,7 +856,7 @@
 				esac
 			fi
 			;;
-		depends)
+		d?(epends))
 			# Only complete if the previous entry on the command line is not
 			# a package name.
 			if [[ ${prev} == ${mode} || ${prev:0:1} == "-" ]]; then
@@ -878,7 +879,7 @@
 				esac
 			fi
 			;;
-		check)
+		k|check)
 			# Only complete if the previous entry on the command line is not
 			# a package name.
 			if [[ ${prev} == ${mode} ]]; then
@@ -886,7 +887,7 @@
 				_pkgname -I $cur
 			fi
 			;;
-		size)
+		s?(ize))
 			# Only complete if the previous entry on the command line is not
 			# a package name.
 			if [[ ${prev} == ${mode} || ${prev:0:1} == "-" ]]; then
@@ -901,7 +902,7 @@
 				esac
 			fi
 			;;
-		hasuse)
+		h?(asuse))
 		   	# Only complete if the previous entry on the command line is not
 			# a package name.
 			if [[ ${prev} == ${mode} || ${prev:0:1} == "-" ]]; then
@@ -921,7 +922,7 @@
 	esac
 	return 0
 }
-complete -F _equery -o filenames equery
+complete -F _equery equery
 }
 
 #
