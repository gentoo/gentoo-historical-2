diff -Naur linux-ftpd-0.17/ftpd/Makefile linux-ftpd-0.17-patched/ftpd/Makefile
--- linux-ftpd-0.17/ftpd/Makefile	1999-12-12 19:04:58.000000000 +0100
+++ linux-ftpd-0.17-patched/ftpd/Makefile	2003-04-06 11:52:17.000000000 +0200
@@ -19,7 +19,11 @@
 all: ftpd
 
 %.o: %.c
+ ifdef USE_SHADOW
+	$(CC) $(CFLAGS) -DUSE_SHADOW -DHASSETPROCTITLE $< -c
+ else
 	$(CC) $(CFLAGS) -DHASSETPROCTITLE $< -c
+ endif
 
 ftpcmd.c: %.c: %.y
 	$(YACC) $<
diff -Naur linux-ftpd-0.17/support/Makefile linux-ftpd-0.17-patched/support/Makefile
--- linux-ftpd-0.17/support/Makefile	1999-08-01 00:05:52.000000000 +0200
+++ linux-ftpd-0.17-patched/support/Makefile	2003-04-06 11:54:50.000000000 +0200
@@ -5,7 +5,11 @@
 all: libsupport.a
 
 %.o: %.c
+ ifdef USE_SHADOW
+	$(CC) $(CFLAGS) -DUSE_SHADOW -DHASSETPROCTITLE $< -c
+ else
 	$(CC) $(CFLAGS) -DHASSETPROCTITLE $< -c
+ endif
 
 libsupport.a: $(OBJS)
 	ar -cruv $@ $^
