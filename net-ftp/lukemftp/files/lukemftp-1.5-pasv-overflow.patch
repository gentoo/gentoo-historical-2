--- src/ftp.c
+++ src/ftp.c
@@ -454,9 +454,10 @@
 			if (dig > 4 && pflag == 1 && isdigit(c))
 				pflag = 2;
 			if (pflag == 2) {
-				if (c != '\r' && c != ')')
-					*pt++ = c;
-				else {
+			  if (c != '\r' && c != ')') {
+			          if (pt < &pasv[sizeof(pasv) - 1])
+			                   *pt++ = c;
+			          } else {
 					*pt = '\0';
 					pflag = 3;
 				}
