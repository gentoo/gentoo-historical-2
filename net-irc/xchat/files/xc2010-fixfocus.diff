# Fixes rare crash on window focus (only on some obscure WindowManagers)
--- xchat-2.0.10/src/fe-gtk/maingui.c	2004-06-29 15:27:24.000000000 +1000
+++ xchat-2.0.10p1/src/fe-gtk/maingui.c	2004-07-13 01:11:02.000000000 +1000
@@ -2131,8 +2142,11 @@
 mg_tabwin_focus_cb (GtkWindow * win, GdkEventFocus *event, gpointer userdata)
 {
 	current_sess = current_tab;
-	gtk_xtext_check_marker_visibility(GTK_XTEXT (current_sess->gui->xtext));
-	plugin_emit_dummy_print (current_sess, "Focus Window");
+	if (current_sess)
+	{
+		gtk_xtext_check_marker_visibility (GTK_XTEXT (current_sess->gui->xtext));
+		plugin_emit_dummy_print (current_sess, "Focus Window");
+	}
 	return FALSE;
 }
 
