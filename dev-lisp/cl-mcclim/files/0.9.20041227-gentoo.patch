diff -ur cl-mcclim-0.9+cvs.2004.12.27.orig.orig/Backends/CLX/system.lisp cl-mcclim-0.9+cvs.2004.12.27.orig/Backends/CLX/system.lisp
--- cl-mcclim-0.9+cvs.2004.12.27.orig.orig/Backends/CLX/system.lisp	2004-12-27 03:44:13.000000000 -0600
+++ cl-mcclim-0.9+cvs.2004.12.27.orig/Backends/CLX/system.lisp	2005-01-04 20:11:44.472818141 -0600
@@ -15,12 +15,13 @@
 ;;; Free Software Foundation, Inc., 59 Temple Place - Suite 330, 
 ;;; Boston, MA  02111-1307  USA.
 
-(in-package :common-lisp-user)
+(in-package #:clim-system)
 
 #+:excl(require :clx)
 #+:excl(require :loop)
 
-(clim-defsystem (:clim-clx :depends-on (:clim #+(and sbcl asdf) :clx))
+#+(and (or sbcl cmu) asdf common-lisp-controller)
+(clim-defsystem (:clim-clx :depends-on (:clim :clx))
   "Backends/CLX/package"
   "Backends/CLX/keysyms-common"
   "Backends/CLX/keysyms"
diff -ur cl-mcclim-0.9+cvs.2004.12.27.orig.orig/debian/mcclim.asd cl-mcclim-0.9+cvs.2004.12.27.orig/debian/mcclim.asd
--- cl-mcclim-0.9+cvs.2004.12.27.orig.orig/debian/mcclim.asd	2005-01-04 10:57:04.000000000 -0600
+++ cl-mcclim-0.9+cvs.2004.12.27.orig/debian/mcclim.asd	2005-01-04 20:09:28.446124914 -0600
@@ -22,64 +22,37 @@
 ;;; Modified in 2004 by Milan Zamazal <pdm@debian.org> for Debian installation.
 ;;; Make diff against ../system.lisp to get the detailed modification report.
 
-(in-package :common-lisp-user)
+(defpackage #:clim-system
+  (:use #:asdf
+	#:common-lisp))
+
+(in-package #:clim-system)
 
 (defparameter *clim-directory* (directory-namestring *load-truename*))
 
-#+cmu
-(progn
-  (unless (fboundp 'ext:stream-read-char)
-    (asdf:operate 'asdf:load-op :cmucl-graystream)
-    #+nil
-    (unless (ignore-errors (ext:search-list "gray-streams:"))
-      (setf (ext:search-list "gray-streams:")
-	'("target:pcl/" "library:subsystems/")))
-    #+nil
-    (if (fboundp 'without-package-locks)
-	(without-package-locks
-	 (load "gray-streams:gray-streams-library"))
-      (load "gray-streams:gray-streams-library")))
-  #-clx
-  (asdf:operate 'asdf:load-op :cmucl-clx)
-  #-(or mk-defsystem asdf)
-  (load "library:subsystems/defsystem")
-  #+mp (when (eq mp::*initial-process* mp::*current-process*)
-	 (format t "~%~%You need to run (mp::startup-idle-and-top-level-loops) to start up the multiprocessing support.~%~%")))
+;; #+(and cmu mp)
+;; (progn
+;;   (when (eq mp::*initial-process* mp::*current-process*)
+;;     (format t "~%~%You need to run (mp::startup-idle-and-top-level-loops) to start up the multiprocessing support.~%~%")))
 
 (pushnew :clim *features*)
 (pushnew :mcclim *features*)
 
-#+mk-defsystem (use-package "MK")
-
 (defmacro clim-defsystem ((module &key depends-on) &rest components)
   `(progn
-     #+mk-defsystem
-     (defsystem ,module
-       :source-pathname *clim-directory*
-       :source-extension "lisp"
-       ,@(and depends-on `(:depends-on ,depends-on))
-        :components
-	(:serial
-	 ,@components))
-     #+asdf
      (asdf:defsystem ,module
-	 ,@(and depends-on
-		`(:depends-on ,depends-on))
-	 :serial t
-	 :components
-	 (,@(loop for c in components
-		  for p = (merge-pathnames
-			   (parse-namestring c)
-			   (make-pathname :type "lisp"
-					  :defaults *clim-directory*))
-		  collect `(:file ,(pathname-name p) :pathname ,p))))
-     #-(or mk-defsystem asdf)
-     (defsystem ,module ()
-       (:serial
-	,@depends-on
-	,@components))))
+       ,@(and depends-on
+	      `(:depends-on ,depends-on))
+       :serial t
+       :components
+       (,@(loop for c in components
+	     for p = (merge-pathnames
+		      (parse-namestring c)
+		      (make-pathname :type "lisp"
+				     :defaults *clim-directory*))
+	     collect `(:file ,(pathname-name p) :pathname ,p))))))
 
-(clim-defsystem (:clim-lisp)
+(clim-defsystem (:clim-lisp :depends-on (#+cmu :cmucl-graystream))
   ;; First possible patches
   "patch"
   #+cmu       "Lisp-Dep/fix-cmu"
@@ -92,18 +65,16 @@
 
 (clim-defsystem (:clim-core :depends-on (:clim-lisp))
    "decls"
-
-   #.(or
-      #+(and :cmu :mp (not :pthread))  "Lisp-Dep/mp-cmu"
-
-      ;; Rumor is that SB-THREAD is a feature test for the presence of
-      ;; multithreading in SBCL.
-
-      #+sb-thread               "Lisp-Dep/mp-sbcl"
-      #+excl                    "Lisp-Dep/mp-acl"
-      #+openmcl                 "Lisp-Dep/mp-openmcl"
-      #+lispworks               "Lisp-Dep/mp-lw"
-      #| fall back |#           "Lisp-Dep/mp-nil")
+   #+(and :cmu :mp (not :pthread))  "Lisp-Dep/mp-cmu"
+   #+sb-thread               "Lisp-Dep/mp-sbcl"
+   #+excl                    "Lisp-Dep/mp-acl"
+   #+openmcl                 "Lisp-Dep/mp-openmcl"
+   #+lispworks               "Lisp-Dep/mp-lw"
+   #-(or (and :cmu :mp (not :pthread))
+	 sb-thread
+	 excl
+	 openmcl
+	 lispworks)          "Lisp-Dep/mp-nil"
    "utils"
    "defresource"
    "setf-star"
